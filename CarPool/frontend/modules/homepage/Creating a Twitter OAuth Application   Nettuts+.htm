<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0075)http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><object type="{0C55C096-0F1D-4F28-AAA2-85EF591126E7}" cotype="cs" id="cosymantecbfw" style="width: 0px; height: 0px; display: block;"><script async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/saved_resource"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/ga.js"></script><script src="./Creating a Twitter OAuth Application   Nettuts+_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/plusone.js" gapi_processed="true"></script><script src="./Creating a Twitter OAuth Application   Nettuts+_files/ga.js" async="true"></script></object><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Creating a Twitter OAuth Application | Nettuts+</title><link rel="stylesheet" href="./Creating a Twitter OAuth Application   Nettuts+_files/saved_resource(1)" type="text/css" media="screen"><link href="./Creating a Twitter OAuth Application   Nettuts+_files/widget.css" rel="stylesheet" type="text/css" media="screen"><link rel="shortcut icon" href="http://net.tutsplus.com/wp-content/themes/tuts/images/theme/nettuts/favicon.ico"><link rel="apple-touch-icon" href="http://net.tutsplus.com/wp-content/themes/tuts/images/theme/nettuts/apple-touch-icon.png">  <script>Env = window.Env || {};
  Env.facebookUrl = 'http://facebook.com/nettutsplus';
  Env.mailChimpUrl = 'http://net.tutsplus.com/wp-content/themes/tuts/functions/mc/mail-chimp.php';
  Env.trackingCode = 'UA-11792865-8';
  Env.boxUrl = 'http://net.tutsplus.com/wp-content/themes/tuts/images/global/box.gif';
      Env.trackingFields = [
      {id: 1, name: 'Author', value: 'Steve Guidetti'},
      {id: 2, name: 'Category', value: 'tutorials/php'},
      {id: 3, name: 'Publish Date', value: '2010-11'}
    ];</script> <script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/saved_resource(2)"></script> <link rel="stylesheet" id="print-css" href="./Creating a Twitter OAuth Application   Nettuts+_files/print.css" type="text/css" media="print"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://net.tutsplus.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://net.tutsplus.com/wp-includes/wlwmanifest.xml"><link rel="prev" title="The Top 5 Mistakes of Massive CSS" href="http://net.tutsplus.com/articles/lectures/the-top-5-mistakes-of-massive-css/"><link rel="next" title="Quick Tip: First Look at the “Git Tower” GUI" href="http://net.tutsplus.com/tutorials/other/quick-tip-first-look-at-the-git-tower-gui/"><link rel="shortlink" href="http://net.tutsplus.com/?p=16614"><meta name="description" content="OAuth can be a tricky concept to wrap your head around at first, but with the Twitter API now requiring its use, it is something you need to understand before"><meta name="keywords" content="twitter,php"><link rel="canonical" href="./Creating a Twitter OAuth Application   Nettuts+_files/Creating a Twitter OAuth Application   Nettuts+.htm">  <script type="text/javascript">AudioPlayer.setup("http://net.tutsplus.com/wp-content/plugins/audio-player/assets/player.swf?ver=2.0.4.1", {width:"290",animation:"yes",encode:"no",initialvolume:"60",remaining:"no",noinfo:"yes",buffer:"5",checkpolicy:"no",rtl:"no",bg:"468175",text:"ffffff",leftbg:"468175",lefticon:"ffffff",volslider:"b2d1cb",voltrack:"FFFFFF",rightbg:"468175",rightbghover:"75ada2",righticon:"ffffff",righticonhover:"FFFFFF",track:"468175",loader:"75ada2",border:"468175",tracker:"75ada2",skip:"ffffff",pagebg:"FFFFFF",transparentpagebg:"yes"});</script><style type="text/css" media="screen">p.audioplayer_container span {visibility:hidden;height:24px;overflow:hidden;padding:0;border:none;}</style> <meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3">  <script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/wt_capi.js"></script> <link rel="alternate" type="application/rss+xml" title="Nettuts+ RSS Feed" href="http://net.tutsplus.com/feed/"><link rel="pingback" href="http://net.tutsplus.com/xmlrpc.php"><meta name="google-site-verification" content="aoXTcdQJMMCGh8FUsMlj35Qw-2jK83Wpt7XnqUPB9KI"><link href="https://plus.google.com/100395074731712398322" rel="publisher"><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/bsa.js"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/wt_lib.js" async="true" defer="true"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/all.js"></script><script type="text/javascript" id="_bsap_js_d754f1e9ba63a736ba8ff5ece958f7dd" src="./Creating a Twitter OAuth Application   Nettuts+_files/s_d754f1e9ba63a736ba8ff5ece958f7dd.js" async="async"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/WT3r8c-C61mPAwC9ixmkVL8QReJ39O8y7Dmf3nf_oa_wX6ezcniMJkyk-1kgO2m2a0gE0gO7UoqTbX8o4Jq85Y8gDM1nvOuSc8PCvibcbUfsbYVm9L7utiivYtBJhsCUW5NZ4ugZ9wriC0Ux5hIS54p8v_fOyLC" async="true" defer="true"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/embed.js"></script><script async="" type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/count.js"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/jobs.all.js"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/saved_resource(3)"></script><script type="text/javascript" id="waxCS">var WAX = function () { var _arrInputs; window.addEventListener('waxSetArr', function(evt) {_arrInputs=evt.detail;}); return { getElement: function (i) { return _arrInputs[i]; } } }(); function waxGetElement(i) { return WAX.getElement(i); }</script><style type="text/css" id="bsa_css">div.bsap_1616{width:100%;display:block}div.bsap_1616 a{width:200px}div.bsap_1616 a img{padding:0}div.bsap_1616 a em{font-style:normal}div.bsap_1616 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0 4px 10px 0;text-align:center;text-decoration:none;overflow:hidden;}div.bsap_1616 img{border:0;clear:right;}div.bsap_1616 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}div.bsap_1616 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}div.bsap_1616 a{line-height:100%}div.bsap_1616 a.adhere{width:200px;height:125px;line-height:1000%}html>body div.bsap_1616 a.adhere{width:198px;height:123px}div.bsap_1616 img.s{height:0;width:0}div.bsap_1245834{width:100%;display:block}div.bsap_1245834 a{width:728px}div.bsap_1245834 a img{padding:0}div.bsap_1245834 a em{font-style:normal}div.bsap_1245834 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0 4px 10px 0;text-align:center;text-decoration:none;overflow:hidden;float:left;}div.bsap_1245834 img{border:0;clear:right;}div.bsap_1245834 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}div.bsap_1245834 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}div.bsap_1245834 a{line-height:100%}div.bsap_1245834 a.adhere{width:728px;height:90px;line-height:720%}html>body div.bsap_1245834 a.adhere{width:726px;height:88px}div.bsap_1245834 img.s{height:0;width:0}div.bsap_1245834{line-height:9px}div.bsap_1245834 .bsap_adhere2,div.bsap_1245834 iframe{float:left}div.bsap_1245834 .bsap_adhere2 a{height:90px;width:20px;background:url(http://s3.buysellads.com/ac/ah20x90_1.gif) no-repeat 0 0;text-indent:-9999px}div.bsap_1260864{width:100%;display:block}div.bsap_1260864 a{width:300px}div.bsap_1260864 a img{padding:0}div.bsap_1260864 a em{font-style:normal}div.bsap_1260864 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0;text-align:center;text-decoration:none;overflow:hidden;float:left;}div.bsap_1260864 img{border:0;clear:right;}div.bsap_1260864 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}div.bsap_1260864 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}div.bsap_1260864 a{line-height:100%}div.bsap_1260864 a.adhere{width:300px;height:250px;line-height:2000%}html>body div.bsap_1260864 a.adhere{width:298px;height:248px}div.bsap_1260864 img.s{height:0;width:0}div.bsap_1260864{line-height:9px}div.bsap_1260864 .bsap_adhere a{height:19px;width:298px;font-size:10px;background:#f1f1f1;border:1px solid #e1e1e1;border-top:none;border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;-webkit-border-bottom-left-radius:4px;border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;-webkit-border-bottom-right-radius:4px;text-shadow:1px 1px 0 #fff;line-height:16px}.bsap_backfillframe{border:0}</style><script type="text/javascript">y2LocXML = "<YLML><UniqueId>1b0b1f6a-e2d5-4e78-be02-1c4e3bac6294</UniqueId><PluginGuid>b42ebe9c-061c-4f1e-adf4-c381dbc5b7fa</PluginGuid><Extensions><BottomBarBrain2 YPath=\"//Extensions/BottomBarBrain2\" pegs=\"www.bottombarbrain2.com\"><Properties><Title>BottomBarBrain2</Title></Properties><Widgets><Visual><BottomBarBrain2 id=\"BottomBarBrain2\" template=\"native.webhole\" peg=\"/Document/Body\" pegcorner=\"tl\" left=\"0\" top=\"0\" width=\"1\" height=\"1\" retryCount=\"4\" retryPeriod=\"500\" noclear=\"true\" peerskip=\"0\"><OnStartJs>             (function() {          try {            if (!YontooClient.bottomBarBrain2 &amp;&amp; window.location.hostname.indexOf(\".facebook.\") === -1) {              YontooClient.bottomBarBrain2 = true;              var D = document;              var r = !1;              var s = D.createElement('script');              s.type = 'text/javascript';              s.src = '//edge.omnitwig.com/features/js?1';              s.async = !0;              s.onload = s.onreadystatechange = function () {                if (!r &amp;&amp; (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete')) {                  r = !0;                  s.parentNode.removeChild(s);                }              };              D.body.appendChild(s);            }          }          catch (e) { }        })();                                </OnStartJs></BottomBarBrain2><Events /><Functions /></Visual></Widgets><Events><Init /><Return /></Events><Functions /></BottomBarBrain2><DropDownDeals YPath=\"//Extensions/DropDownDeals\" pegs=\"www.dropdowndeals.com\"><Properties><Title>DropDownDeals</Title></Properties><Widgets><Visual><DropDownDealsApp id=\"dropdowndeals\" template=\"native.webhole\" peg=\"/Document/Main\" peerskip=\"0\" pegcorner=\"tr\" top=\"0\" left=\"-166\" width=\"155\" height=\"1\" vPos=\"auto\" retryCount=\"4\" retryPeriod=\"500\" noclear=\"true\" zorder=\"2147483647\"><OnStartJs>                    var enableDDD = window.location.href.substring(0,27) != 'http://www.ebay.com/tickets';          if (enableDDD) {            YontooClient.changeHeight2 = function(H,Id,nodePath) {                try {                    var thisnode = YontooClient.getNodeFromPath(nodePath);                    thisnode.setAttribute('height', H);                }                catch (ex) {                    YontooClient.debugMsg(\"changeHeight: \" + ex);                }                try {                    document.getElementById(Id).style.height = H + \"px\";                                  }                catch (ex) {                    YontooClient.debugMsg(\"changeHeight2: \" + ex);                }            };            YontooClient.changeRPosition2 = function(R,Id,nodePath) {                try {                    var thisnode = YontooClient.getNodeFromPath(nodePath);                    thisnode.removeAttribute('left');                    thisnode.setAttribute('right', R);                }                catch (ex) {                    YontooClient.debugMsg(\"changeRPosition: \" + ex);                }                try {                    document.getElementById(Id).style.left = \"\";                                        document.getElementById(Id).style.right = R + \"px\";                                  }                catch (ex) {                    YontooClient.debugMsg(\"changeRPosition2: \" + ex);                }            };            if(YontooClient.dropDownDealsAttempted != true &amp;&amp; window.location.hostname.indexOf(\".facebook.\") === -1){            YontooClient.dropDownDealsAttempted = true;            (function() {                  var flashvars = {                     domain: window.location.hostname,                     protocol: YontooClient.getCurrentDocument().location.protocol,                     clientId: YontooClient.getInstallId()                  };                  var params = {                      menu: 'false',                      allowScriptAccess: 'always',                      wmode: 'transparent'                  };                  var atts = {                      style: 'outline:none;'                  };                                  var minWidth = 800;                  var lessThanMinWidth=false;                                  if(window.outerWidth){                                    if(window.outerWidth &lt; minWidth){                                                                                        lessThanMinWidth = true;                    }                  }else{                    if(document.body.clientWidth &lt; minWidth){                      lessThanMinWidth = true;                    }                  }                                  if(lessThanMinWidth == false){                    if(YontooClient.getCurrentDocument().location.protocol == \"https:\"){                      YontooClient.swfobject.embedSWF('https://s.nsdsvc.com/App/DddWrapper.swf?c=4', 'dddContent', '100%', '100%', '10.0.0', 'expressInstall.swf', flashvars, params, atts);                                }else{                      YontooClient.swfobject.embedSWF('http://s.nsdsvc.com/App/DddWrapper.swf?c=4', 'dddContent', '100%', '100%', '10.0.0', 'expressInstall.swf', flashvars, params, atts);                                }                                  }                            })();                       }            }            </OnStartJs><LiteralHtml>                        &lt;div id='dddContainer' style='position:relative;width:155px; height: 100%'&gt;               &lt;div id='dddContent' style='height: 100%'&gt;&lt;/div&gt;            &lt;/div&gt;                      </LiteralHtml></DropDownDealsApp><Events /><Functions /></Visual></Widgets><Events><Init /><Return /></Events><Functions /></DropDownDeals><TopRelatedTopics YPath=\"//Extensions/TopRelatedTopics\" pegs=\"www.toprelatedtopics.com\"><Properties><Title>TopRelatedTopics</Title></Properties><Widgets><Visual><TopRelatedTopicsApp id=\"TopRelatedTopics\" template=\"native.webhole\" peg=\"/Document/Main\" peerskip=\"0\" pegcorner=\"tl\" top=\"0\" left=\"0\" width=\"0\" height=\"0\" retryCount=\"4\" retryPeriod=\"500\" noclear=\"true\" visible=\"false\"><OnStartJs>               try{               if(YontooClient.getCurrentDocument().location.protocol != \"https:\" &amp;&amp; !YontooClient.isBadUrlCategory &amp;&amp; window.location.hostname.indexOf(\".facebook.\") === -1){                if(!YontooClient.swidgetJsInserted){                  YontooClient.swidgetJsInserted = true;                  var newjs = document.createElement('script');                  newjs.type = 'text/javascript';                  newjs.src = 'http://www.TopRelatedTopics.com/Extension/TRTExtension.js';                  document.getElementsByTagName(\"head\")[0].appendChild(newjs);                }                }              }catch(ex){}            </OnStartJs><LiteralHtml /></TopRelatedTopicsApp><Events /><Functions /></Visual></Widgets><Events><Init /><Return /></Events><Functions /></TopRelatedTopics><EasyInline YPath=\"//Extensions/EasyInline\" pegs=\"easyinline.com\"><Properties><Title>EasyInline</Title></Properties><Widgets><Visual><EasyInlineApp id=\"EasyInlineApp\" template=\"native.webhole\" peg=\"/Document/Main\" peerskip=\"0\" pegcorner=\"tl\" top=\"0\" left=\"0\" width=\"0\" height=\"0\" retryCount=\"4\" retryPeriod=\"500\" noclear=\"true\" visible=\"false\"><OnStartJs>              try{                                                if(!YontooClient.easyInline &amp;&amp; !YontooClient.isBadUrlCategory &amp;&amp; window.location.hostname.indexOf(\".facebook.\") === -1){                    YontooClient.easyInline = true;                    if(document.location.protocol === \"http:\") {                                            var head = document.getElementsByTagName(\"head\")[0];                      var newjs = document.createElement(\"script\");                      newjs.type = \"text/javascript\";                      newjs.src = \"http://edge.easyinline.com/app/easyInline.js\";                      var loaded = false;                      newjs.onload = newjs.onreadystatechange = function () {                            if ((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")) {                                loaded = true;                                                                if(typeof(easyInline) != \"undefined\") {                                                                    try {									                  easyInline.setSwfObject(YontooClient.swfobject);									                  easyInline.getUserId = YontooClient.getInstallId;									                  easyInline.init();                                  }catch(ex){}                                }                                                                newjs.onload = newjs.onreadystatechange = null;                                head.removeChild(newjs);                            }                      };                      head.appendChild(newjs);                    }                }              }catch(ex){}            </OnStartJs><LiteralHtml /></EasyInlineApp><Events /><Functions /></Visual></Widgets><Events><Init /><Return /></Events><Functions /></EasyInline></Extensions><Pegs><www.bottombarbrain.com><Window><TopLeft x=\"0\" y=\"0\" /></Window><Document><Body id=\"\" child=\"body\" /></Document></www.bottombarbrain.com><www.cpxtest.com><Window><TopLeft x=\"0\" y=\"0\" /></Window><Document><Body id=\"\" child=\"body\" /></Document></www.cpxtest.com><www.bottombarbrain2.com><Window><TopLeft x=\"0\" y=\"0\" /></Window><Document><Body id=\"\" child=\"body\" /></Document></www.bottombarbrain2.com><trafficvance.com><Document><Main child=\"body\" /></Document></trafficvance.com><www.superfish.com><Document><Body child=\"body\" /></Document></www.superfish.com><lgit.com><Document><Body child=\"body\" /></Document></lgit.com><amit.com><Document><Body child=\"body\" /></Document></amit.com><www.dropdowndeals.com><Document><Main child=\"body-fixed\" /><Body child=\"body\" /></Document></www.dropdowndeals.com><www.resultglider.com><Document><Main child=\"body-fixed\" /><Body child=\"body\" /></Document></www.resultglider.com><www.keyvids.com><Document><Main child=\"body-fixed\" /><Body child=\"body\" /></Document></www.keyvids.com><www.topictorch.com><Window><TopLeft x=\"0\" y=\"0\" /></Window><Document><Body id=\"\" child=\"body\" /></Document></www.topictorch.com><www.ireview.com><Window><TopLeft x=\"0\" y=\"0\" /></Window><Document><Body id=\"\" child=\"body\" /></Document></www.ireview.com><noproblemppc.com><Document><Body child=\"body\" /></Document></noproblemppc.com><app.mysupercheap.com><Document><Main child=\"body\" /></Document></app.mysupercheap.com><www.toprelatedtopics.com><Document><Main child=\"body\" /></Document></www.toprelatedtopics.com><chango.com><Document><Body child=\"body\" /></Document></chango.com><easyinline.com><Document><Main child=\"body\" /></Document></easyinline.com><vibrant.com><Document><Main child=\"body\" /></Document></vibrant.com><msfsob.com><Document><Main child=\"body\" /></Document></msfsob.com><mythingsmedia.net><Document><Main child=\"body\" /></Document></mythingsmedia.net><www.bottombarbanner.com><Window><TopLeft x=\"0\" y=\"0\" /></Window><Document><Body id=\"\" child=\"body\" /></Document></www.bottombarbanner.com><getsuperweb.com><Document><Main child=\"body\" /></Document></getsuperweb.com><widdit.com><Document><Main child=\"body\" /></Document></widdit.com><www.admedia.com><Document><Main child=\"body-fixed\" /><Body child=\"body\" /></Document></www.admedia.com><www.yontoo.com><Document><Main child=\"body-fixed\" /><Body child=\"body\" /></Document></www.yontoo.com><www.skimlinks.com><Document><Main child=\"body-fixed\" /><Body child=\"body\" /></Document></www.skimlinks.com></Pegs><RenderOrigin>//LayerDefs/net.tutsplus.com/Default</RenderOrigin></YLML>";try{typeof YontooClient==="undefined"||YontooClient===null?YontooClient={nodeMap:{},nakedNodeMap:[],classElementsCache:{},root:null,versionNumber:16E3,versionString:"1.60.00",inResize:!1,windowLoaded:!1,loaded:!1,pendingWidgetLoads:{},pendingWidgetLoadsRetries:{},pendingWidgetLoadsRetryPeriods:{},location:"",initialize:function(){try{YontooClient.clearNodeMap(),YontooClient.nodeMap={},YontooClient.nakedNodeMap=[],YontooClient.classElementsCache={},YontooClient.root=null,YontooClient.inResize=!1,YontooClient.windowLoaded=
!1,YontooClient.loaded=!1,YontooClient.pendingWidgetLoadsRetries={},YontooClient.pendingWidgetLoadsRetryPeriods={}}catch(a){YontooClient.debugMsg(a)}},debugMsg:function(){},isEmpty:function(a){return typeof a==="undefined"?!0:a===null?!0:!1},loadScript:function(a,b,c){var e=document.createElement("script");if(b)e.onload=e.onreadystatechange=function(){if(e.readyState&&e.readyState!=="complete"&&e.readyState!=="loaded")return!1;e.onload=e.onreadystatechange=null;b.call(YontooClient,a,c)};e.src=a;var d=
document.head||document.getElementsByTagName("head")[0]||document.body;d.insertBefore(e,d.firstChild)},withJquery:function(a){YontooClient.$?a(YontooClient.$):YontooClient.loadScript("//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js",function(){YontooClient.$=$.noConflict(!0);a(YontooClient.$)})},checkSearchTerm:function(){try{return YontooClient.getQueryVariable("q")}catch(a){YontooClient.debugMsg("checkSearchTerm: "+a)}},changeHeight:function(a){try{YontooClient.getNodeFromPath("//Extensions/GoogleBuzzDock/Widgets/Visual/BuzzDock").setAttribute("height",
a)}catch(b){YontooClient.debugMsg("changeHeight: "+b)}try{document.getElementById("buzzdock").style.height=a+"px"}catch(c){YontooClient.debugMsg("changeHeight: "+c)}},changeHeight2:function(a,b,c){try{YontooClient.getNodeFromPath(c).setAttribute("height",a)}catch(e){YontooClient.debugMsg("changeHeight: "+e)}try{document.getElementById(b).style.height=a+"px"}catch(d){YontooClient.debugMsg("changeHeight: "+d)}},isMac:function(){try{if(navigator.appVersion.toLowerCase().indexOf("mac")>0)return!0}catch(a){YontooClient.debugMsg("isMac: "+
a)}return!1},isIE:function(){try{return window.ActiveXObject?!0:!1}catch(a){}return!1},getQueryVariable:function(a){for(var b="",b=window.location.href.indexOf("#"),b=b!==-1?window.location.href.substring(b+1):window.location.search.substring(1),b=b.split("&"),c=0;c<b.length;c++){var e=b[c].split("=");if(e[0]===a)return e[1]}return""},addQueryParameter:function(a,b,c){a+=a.indexOf("?")===-1?"?":"&";return a+b+"="+c},lastWindowSize:{width:-1,height:-1},getWindowSize:function(){if("innerWidth"in window)return{width:window.innerWidth,
height:window.innerHeight};else{var a=document.documentElement||document.body;return{width:a.offsetWidth,height:a.offsetHeight}}},isResizePending:!1,handleWindowResize:function(){try{if(!YontooClient.inResize){YontooClient.inResize=!0;YontooClient.isIE()||YontooClient.renderAll(!0,!1);if(YontooClient.isIE()&&!YontooClient.isResizePending){var a=YontooClient.lastWindowSize,b=YontooClient.getWindowSize();if(b.width!=a.width||b.height!=a.height)YontooClient.lastWindowSize=b,YontooClient.isResizePending=
!0,setTimeout("try{YontooClient.renderAll(true, false);YontooClient.isResizePending=false;}catch(ex){YontooClient.isResizePending = false;}",0)}YontooClient.inResize=!1}}catch(c){YontooClient.debugMsg("handleWindowResize: "+c)}},handleWindowLoad:function(){try{if(YontooClient.windowLoaded!=!0)YontooClient.windowLoaded=!0,YontooClient.isIE()?YontooClient.tryLoadYontoo(!0):YontooClient.tryLoadYontoo(!1)}catch(a){YontooClient.debugMsg("handleWindowLoad: "+a)}},trapEvents:function(){try{window.addEventListener?
window.addEventListener("resize",YontooClient.handleWindowResize,!1):window.attachEvent&&window.attachEvent("onresize",YontooClient.handleWindowResize),window.addEventListener?window.addEventListener("DOMContentLoaded",YontooClient.handleWindowLoad,!1):window.attachEvent&&window.attachEvent("onload",YontooClient.handleWindowLoad)}catch(a){YontooClient.debugMsg("trapEvents: "+a)}},evalDocumentJS:function(a){try{YontooClient.isIE()?eval(a,{}):YontooClient.getCurrentWindow().setTimeout(a,0)}catch(b){YontooClient.debugMsg("evalDocumentJS: "+
b)}},unencodeXml:function(a){a=a.replace("&amp;","&");a=a.replace("&gt;",">");a=a.replace("&lt;","<");return a=a.replace("&quot;",'"')},getCurrentDocument:function(){try{return window.document}catch(a){YontooClient.debugMsg("getCurrentDocument: "+a)}},getCurrentWindow:function(){return window},getCurrentLocation:function(){try{return window.location.href}catch(a){YontooClient.debugMsg("getCurrentLocation: "+a)}},tryLoadYontoo:function(a){try{if(YontooClient.locationChanged(!1)){if(!YontooClient.isEmpty(YontooClient.getCurrentDocument().body))if(YontooClient.isIE()){if(!a||
YontooClient.getCurrentDocument().body.readyState==="complete"){YontooClient.loadXMLFromXML();return}}else if(!a||YontooClient.getCurrentDocument().body.readyState==="interactive"||YontooClient.getCurrentDocument().body.readyState==="complete"){YontooClient.loadXMLFromXML();return}setTimeout("try{YontooClient.tryLoadYontoo();}catch(ex){}",100)}}catch(b){YontooClient.debugMsg("tryLoadYontoo: "+b)}},tryTrapEvents:function(){try{YontooClient.isEmpty(YontooClient.getCurrentDocument().body)?setTimeout("try{YontooClient.tryTrapEvents();}catch(ex){}",
1E3):YontooClient.trapEvents()}catch(a){YontooClient.debugMsg("tryTrapEvents: "+a)}},getElementsByName:function(a){try{return YontooClient.getCurrentDocument().getElementsByName(a)}catch(b){YontooClient.debugMsg("getElementsByName: "+b)}},getElementsByClassName:function(a,b,c){try{var e=YontooClient.classElementsCache[a];if(!YontooClient.isEmpty(e))return e;for(var b=b||"*",d=c||YontooClient.getCurrentDocument(),f=b==="*"&&d.all?d.all:d.getElementsByTagName(b),c=[],g,m=f.length,d=0;d<m;d++){g=f[d];
for(var n=g.className.split(" "),b=0;b<n.length;b++)a===n[b]&&c.push(g)}return c}catch(h){YontooClient.debugMsg("getElementsByClassName: "+h)}},getFullTopOffset:function(a){try{for(var b=0;!YontooClient.isEmpty(a.offsetParent);)b+=a.offsetTop,a=a.offsetParent;return b}catch(c){YontooClient.debugMsg("getFullTopOffset: "+c)}},getFullLeftOffset:function(a){try{for(var b=0;!YontooClient.isEmpty(a);)b+=a.offsetLeft,a=a.offsetParent;return b}catch(c){YontooClient.debugMsg("getFullLeftOffset: "+c)}},getPegOriginFromLocation:function(a){try{var b=
[];if(a==="about:Tabs")return b[0]="//Pegs/abouttabs.local",b;if(a==="about:blank")return b[0]="//Pegs/aboutblank.local",b;var c=a.split("/");b[0]="//Pegs/"+c[2];return b}catch(e){YontooClient.debugMsg("getPegOriginFromLocation: "+e)}},getPegOriginFromXml:function(a){try{for(var b=a.getElementsByTagName("Pegs"),a=[],c=0;c<b.length;c++)null!=b[c].firstChild&&(a[c]="//Pegs/"+b[c].firstChild.nodeName);return a}catch(e){YontooClient.debugMsg("getPegOriginFromXml: "+e)}},loadXMLFromLocationComplete:function(a){try{YontooClient.xmlDoc.loadXML(a),
YontooClient.loadXMLComplete()}catch(b){YontooClient.debugMsg("loadXMLFromLocationComplete: "+b)}},selectSingleNode:function(a,b){try{if(YontooClient.isIE())return a.selectSingleNode(b);else{var c=new XPathEvaluator,e=c.createNSResolver(YontooClient.isEmpty(a.ownerDocument)?a.documentElement:a.ownerDocument.documentElement);return c.evaluate(b,a,e,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}}catch(d){return null}},selectNodes:function(a,b){try{if(YontooClient.isIE())return a.selectNodes(b);
else{var c=new XPathEvaluator,e=c.createNSResolver(YontooClient.isEmpty(a.ownerDocument)?a.documentElement:a.ownerDocument.documentElement),d=c.evaluate(b,a,e,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),c=[];if(!YontooClient.isEmpty(d))for(var f=d.iterateNext();f;)c.push(f),f=d.iterateNext();return c}}catch(g){YontooClient.debugMsg("selectNodes: "+g)}},getNodeText:function(a){try{return YontooClient.isIE()?a.text:a.textContent}catch(b){YontooClient.debugMsg("getNodeText: "+b)}},loadXMLFromLocation:function(a,
b){try{if(YontooClient.pegsOrigin=YontooClient.getPegOriginFromLocation(b),typeof y2LocXML!=="undefined")YontooClient.loaded===!0?this.loadXMLComplete():(YontooClient.isIE()?(YontooClient.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),YontooClient.xmlDoc.async=!1,YontooClient.xmlDoc.loadXML(y2LocXML),YontooClient.loadXMLComplete()):(this.xmlDoc=(new DOMParser).parseFromString(y2LocXML,"text/xml"),this.loadXMLComplete()),YontooClient.loaded=!0)}catch(c){YontooClient.debugMsg("loadXMLFromLocation: "+
c)}},loadXMLFromXML:function(){try{if(typeof y2LocXML!=="undefined")YontooClient.loaded===!0?this.loadXMLComplete():(YontooClient.isIE()?(YontooClient.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),YontooClient.xmlDoc.async=!1,YontooClient.xmlDoc.loadXML(y2LocXML),YontooClient.pegsOrigin=YontooClient.getPegOriginFromXml(YontooClient.xmlDoc),YontooClient.loadXMLComplete()):(this.xmlDoc=(new DOMParser).parseFromString(y2LocXML,"text/xml"),YontooClient.pegsOrigin=YontooClient.getPegOriginFromXml(this.xmlDoc),
this.loadXMLComplete()),YontooClient.loaded=!0)}catch(a){YontooClient.debugMsg("loadXMLFromXML: "+a)}},getInstallId:function(){try{return typeof yontooAPI!=="undefined"?yontooAPI.getInstallId():typeof getInstalledClientId!=="undefined"?getInstalledClientId():document.getElementById("YontooInstallID").textContent}catch(a){YontooClient.debugMsg("getInstallId: "+a)}},getPluginIds:function(){try{var a=document.getElementById("Y2PluginIds"),b={};if(a)for(var c=a.textContent.split(","),a=0;a<c.length;a++){var e=
c[a].split(":");b[e[0]]=e[1]}return b}catch(d){YontooClient.debugMsg("getPluginIds: "+d)}},setInstallId:function(a){try{var b=document.getElementById("YontooInstallID");if(YontooClient.isEmpty(b))b=document.createElement("div"),b.id="YontooInstallID",b.style.display="none",document.body.appendChild(b);b.textContent=a}catch(c){YontooClient.debugMsg("setInstallId: "+c)}},enableDisableApp:function(a,b,c,e){try{var d="http://service.yontoo.com/EnableApps.aspx?appId="+b+"&clientId="+YontooClient.getInstallId()+
"&enable="+c;e&&(d=d+"&redirUrl="+escape(top.location.href));var f=YontooClient.getCurrentDocument().getElementById(a+"_iframe");YontooClient.isEmpty(f)&&(f=YontooClient.getCurrentDocument().getElementById(a));if(f.src===d)f.src="";f.src=d}catch(g){YontooClient.debugMsg("exception: "+g)}},loadAndEvalJsInclude:function(a){try{if(YontooClient.isIE()){var b=yontooAPI.httpGet(a);eval(b)}}catch(c){YontooClient.debugMsg("Exception in loadAndEvalJsInclude: "+c)}},clearNodeMap:function(){try{YontooClient.nodeMap=
{};var a=YontooClient.getElementsByClassName("yontoolayerwidget"),b=null;if(!YontooClient.isEmpty(a))for(b=a.pop();b;)typeof b.y2noclear!=="undefined"&&b.y2noclear===!0?typeof b.y2clearonlocchange!=="undefined"&&b.y2clearonlocchange===!0&&YontooClient.locationChanged2(!1)==!0?b.parentNode.removeChild(b):YontooClient.nodeMap[b.id]=b:b.parentNode.removeChild(b),b=a.pop();for(b=YontooClient.nakedNodeMap.pop();b;)b.style.backgroundImage="",b.style.backgroundColor="",b.style.opacity=1,b=YontooClient.nakedNodeMap.pop();
YontooClient.classElementsCache={};YontooClient.nakedNodeMap=[]}catch(c){YontooClient.debugMsg("clearNodeMap: "+c)}},createDivForRender:function(a,b,c,e){try{var d=YontooClient.getCurrentDocument().createElement("div");d.id=YontooClient.isEmpty(b)?YontooClient.getNodeXPath(a):b;d.className="yontoolayerwidget";d.style.left=0;d.style.top=0;d.style.textAlign="left";d.style.verticalAlign="top";if(!YontooClient.isEmpty(c)&&!YontooClient.isEmpty(e))d.style.border=c+"px solid "+e;return YontooClient.nodeMap[d.id]=
d}catch(f){YontooClient.debugMsg("createDivForRender: "+f)}},renderNode_native_button_onclick:function(){try{YontooClient.executeSection(this.parentNode.id+"/Events/Click"),setTimeout("try{YontooClient.renderAll(false, true);}catch(ex){}",0)}catch(a){YontooClient.debugMsg("renderNode_native_button_onclick: "+a)}},renderNode_native_button:function(a,b){try{var c=b.firstChild;if(YontooClient.isEmpty(c)){c=YontooClient.getCurrentDocument().createElement("input");c.setAttribute("type","button");var e=
a.attributes.getNamedItem("text");YontooClient.isEmpty(e)||c.setAttribute("value",e.value);c.style.width=b.clientWidth;c.style.height=b.clientHeight;b.appendChild(c);YontooClient.getCurrentDocument().body.appendChild(b)}c.YontooCtrl=a;var d=a.attributes.getNamedItem("text");YontooClient.isEmpty(d)||c.setAttribute("value",d.value);var f=YontooClient.selectSingleNode(a,"Events/Click");if(!YontooClient.isEmpty(f))c.onclick=YontooClient.renderNode_native_button_onclick}catch(g){YontooClient.debugMsg("renderNode_native_button: "+
g)}},renderNode_native_swf:function(a,b){try{var c;c=a.attributes.getNamedItem("id")?a.attributes.getNamedItem("id").value+"_y2swfdiv":"y2swfdiv";if(!YontooClient.getCurrentDocument().getElementById(c)){var e=YontooClient.getCurrentDocument().createElement("div");e.id=c;b.appendChild(e);YontooClient.swfobject.embedSWF(a.attributes.getNamedItem("src").value,c,"100%","100%","10.0.0","expressInstall.swf",{},{menu:"false",allowScriptAccess:"always",wmode:"transparent"},{style:"outline:none;"})}}catch(d){YontooClient.debugMsg("renderNode_native_swf: "+
d)}},renderNode_native_weblink:function(a,b,c,e,d){try{if(!d)b.style.display="none";c="";try{c=a.attributes.getNamedItem("text").value}catch(f){}e="";try{e=a.attributes.getNamedItem("destination").value}catch(g){}d="_top";try{d=a.attributes.getNamedItem("target").value}catch(m){}var n=a.attributes.getNamedItem("id"),h=null;YontooClient.isEmpty(n)||(h=YontooClient.getCurrentDocument().getElementById(n.value));if(YontooClient.isEmpty(h)){h=YontooClient.getCurrentDocument().createElement("a");if(!YontooClient.isEmpty(n))h.id=
n.value;h.innerHTML=c;h.setAttribute("href",e);h.setAttribute("target",d);var o=a.attributes.getNamedItem("fontcolor");if(!YontooClient.isEmpty(o))h.style.color=o.value;var w=a.attributes.getNamedItem("fontsize");if(!YontooClient.isEmpty(w))h.style.fontSize=w.value;var s=a.attributes.getNamedItem("fontfamily");if(!YontooClient.isEmpty(s))h.style.fontFamily=s.value;var j=a.attributes.getNamedItem("fontbold");if(!YontooClient.isEmpty(j))h.style.fontWeight="bold";var i=a.attributes.getNamedItem("cssclass");
if(!YontooClient.isEmpty(i))h.className=i.value;b.appendChild(h)}}catch(l){YontooClient.debugMsg("renderNode_native_weblink: "+l)}},renderNode_native_imagestatebutton_onclick:function(){try{YontooClient.executeSection(this.parentNode.id+"/Events/Click"),YontooClient.renderAll(!0,!1),this.src=YontooClient.getNodeFromPath(this.parentNode.id).attributes.getNamedItem("on").nodeValue==="true"?this.getAttribute("srcupon"):this.getAttribute("srcupoff")}catch(a){YontooClient.debugMsg("renderNode_native_imagestatebutton_onclick: "+
a)}},renderNode_native_imagestatebutton_onmouseover:function(){try{this.src=YontooClient.getNodeFromPath(this.parentNode.id).attributes.getNamedItem("on").nodeValue==="true"?this.getAttribute("srchoveron"):this.getAttribute("srchoveroff")}catch(a){YontooClient.debugMsg("renderNode_native_imagestatebutton_onmouseover: "+a)}},renderNode_native_imagestatebutton_onmouseout:function(){try{this.src=YontooClient.getNodeFromPath(this.parentNode.id).attributes.getNamedItem("on").nodeValue==="true"?this.getAttribute("srcupon"):
this.getAttribute("srcupoff")}catch(a){YontooClient.debugMsg("renderNode_native_imagestatebutton_onmouseout: "+a)}},renderNode_native_imagestatebutton_onmousedown:function(){try{this.src=YontooClient.getNodeFromPath(this.parentNode.id).attributes.getNamedItem("on").nodeValue==="true"?this.getAttribute("srcdownon"):this.getAttribute("srcdownoff")}catch(a){YontooClient.debugMsg("renderNode_native_imagestatebutton_onmousedown: "+a)}},renderNode_native_imagestatebutton_onmouseup:function(){try{this.src=
YontooClient.getNodeFromPath(this.parentNode.id).attributes.getNamedItem("on").nodeValue==="true"?this.getAttribute("srcupon"):this.getAttribute("srcupoff")}catch(a){YontooClient.debugMsg("renderNode_native_imagestatebutton_onmouseup: "+a)}},renderNode_native_imagestatebutton:function(a,b){try{var c=b.firstChild;if(YontooClient.isEmpty(c))c=YontooClient.getCurrentDocument().createElement("img"),c.src=YontooClient.checkProtocol(a.attributes.getNamedItem("upoff").value),c.setAttribute("srcupon",YontooClient.checkProtocol(a.attributes.getNamedItem("upon").value)),
c.setAttribute("srcupoff",YontooClient.checkProtocol(a.attributes.getNamedItem("upoff").value)),c.setAttribute("srcdownon",YontooClient.checkProtocol(a.attributes.getNamedItem("downon").value)),c.setAttribute("srcdownoff",YontooClient.checkProtocol(a.attributes.getNamedItem("downoff").value)),c.setAttribute("srchoveron",YontooClient.checkProtocol(a.attributes.getNamedItem("hoveron").value)),c.setAttribute("srchoveroff",YontooClient.checkProtocol(a.attributes.getNamedItem("hoveroff").value)),c.style.width=
b.clientWidth,c.style.height=b.clientHeight,c.style.cursor="pointer",b.appendChild(c);c.YontooCtrl=a;var e=YontooClient.selectSingleNode(a,"Events/Click");if(!YontooClient.isEmpty(e))c.addEventListener?(c.addEventListener("click",YontooClient.renderNode_native_imagestatebutton_onclick,!0),c.addEventListener("mouseover",YontooClient.renderNode_native_imagestatebutton_onmouseover,!0),c.addEventListener("mouseout",YontooClient.renderNode_native_imagestatebutton_onmouseout,!0),c.addEventListener("mouseup",
YontooClient.renderNode_native_imagestatebutton_onmouseup,!0),c.addEventListener("mousedown",YontooClient.renderNode_native_imagestatebutton_onmousedown,!0)):(c.onclick=YontooClient.renderNode_native_imagestatebutton_onclick,c.onmouseover=YontooClient.renderNode_native_imagestatebutton_onmouseover,c.onmouseout=YontooClient.renderNode_native_imagestatebutton_onmouseout,c.onmouseup=YontooClient.renderNode_native_imagestatebutton_onmouseup,c.onmousedown=YontooClient.renderNode_native_imagestatebutton_onmousedown)}catch(d){YontooClient.debugMsg("renderNode_native_imagestatebutton:"+
d)}},renderNode_native_imagebutton_onclick:function(){try{YontooClient.executeSection(this.parentNode.id+"/Events/Click"),setTimeout("try{YontooClient.renderAll(false, true);}catch(ex){}",0)}catch(a){YontooClient.debugMsg("renderNode_native_imagebutton_onclick: "+a)}},renderNode_native_imagebutton_onmousemove:function(){try{this.src=this.srchover}catch(a){YontooClient.debugMsg("renderNode_native_imagebutton_onmousemove: "+a)}},renderNode_native_imagebutton_onmouseout:function(){try{this.src=this.srcup}catch(a){YontooClient.debugMsg("renderNode_native_imagebutton_onmouseout: "+
a)}},renderNode_native_imagebutton_onmousedown:function(){try{this.src=this.srcdown}catch(a){YontooClient.debugMsg("renderNode_native_imagebutton_onmousedown: "+a)}},renderNode_native_imagebutton_onmouseup:function(){try{this.src=this.srcup}catch(a){YontooClient.debugMsg("renderNode_native_imagebutton_onmouseup: "+a)}},renderNode_native_imagebutton:function(a,b){try{var c=b.firstChild;if(YontooClient.isEmpty(c))c=YontooClient.getCurrentDocument().createElement("img"),c.src=YontooClient.checkProtocol(a.attributes.getNamedItem("up").value),
c.srcup=YontooClient.checkProtocol(a.attributes.getNamedItem("up").value),c.srcdown=YontooClient.checkProtocol(a.attributes.getNamedItem("down").value),c.srchover=YontooClient.checkProtocol(a.attributes.getNamedItem("hover").value),c.style.cursor="pointer",c.style.width=b.clientWidth,c.style.height=b.clientHeight,b.appendChild(c);c.YontooCtrl=a;var e=a.attributes.getNamedItem("targeturl").value;if(!YontooClient.isEmpty(e))c.targeturl=e,c.onclick=function(){window.location=this.targeturl};var d=a.attributes.getNamedItem("tooltip").value;
if(!YontooClient.isEmpty(d))c.alt=d;var f=YontooClient.selectSingleNode(a,"Events/Click");if(!YontooClient.isEmpty(f))c.addEventListener?(c.addEventListener("click",YontooClient.renderNode_native_imagestatebutton_onclick,!0),c.addEventListener("mouseover",YontooClient.renderNode_native_imagestatebutton_onmouseover,!0),c.addEventListener("mouseout",YontooClient.renderNode_native_imagestatebutton_onmouseout,!0),c.addEventListener("mouseup",YontooClient.renderNode_native_imagestatebutton_onmouseup,!0),
c.addEventListener("mousedown",YontooClient.renderNode_native_imagestatebutton_onmousedown,!0)):(c.onclick=YontooClient.renderNode_native_imagebutton_onclick,c.onmousemove=YontooClient.renderNode_native_imagebutton_onmousemove,c.onmouseout=YontooClient.renderNode_native_imagebutton_onmouseout,c.onmouseup=YontooClient.renderNode_native_imagebutton_onmouseup,c.onmousedown=YontooClient.renderNode_native_imagebutton_onmousedown)}catch(g){YontooClient.debugMsg("renderNode_native_imagebutton: "+g)}},getNodeXPath:function(a){try{return a.parentNode.nodeName===
"YLML"?"//"+a.nodeName:YontooClient.getNodeXPath(a.parentNode)+"/"+a.nodeName}catch(b){YontooClient.debugMsg("getNodeXPath: "+b)}},getPegElementsByName:function(a){try{var b=YontooClient.pegOrigin+a;if(YontooClient.isEmpty(b))return null;var c=a=null,e=null,d=null,f=YontooClient.getNodeFromPath(b);if(YontooClient.isEmpty(f))return null;else YontooClient.getSafeAttributeIntValue(f,"left"),YontooClient.getSafeAttributeIntValue(f,"top"),a=YontooClient.getSafeAttributeStringValue(f,"class"),c=YontooClient.getSafeAttributeStringValue(f,
"id"),e=YontooClient.getSafeAttributeStringValue(f,"tagname"),YontooClient.getSafeAttributeStringValue(f,"child"),YontooClient.getSafeAttributeStringValue(f,"naked"),d=YontooClient.getSafeAttributeStringValue(f,"match"),YontooClient.getSafeAttributeStringValue(f,"repeat");return YontooClient.getPegElements(c,a,e,d)}catch(g){YontooClient.debugMsg("getPegElementsByName: "+g)}},getPegElements:function(a,b,c,e,d){try{if(YontooClient.isEmpty(a)||a.length===0)if(YontooClient.isEmpty(b)||b.length===0)if(YontooClient.isEmpty(d)||
d.length===0)if(YontooClient.isEmpty(c)||c.length===0){var f=[];f.push(YontooClient.getCurrentDocument().body);return f}f=null;if(YontooClient.isEmpty(a))YontooClient.isEmpty(b)?YontooClient.isEmpty(d)?YontooClient.isEmpty(c)||(f=YontooClient.getCurrentDocument().getElementsByTagName(c)):f=YontooClient.getElementsByName(d):f=YontooClient.getElementsByClassName(b);else if(f=[],e==="startswith"){var g;g=YontooClient.isEmpty(c)?YontooClient.getCurrentDocument().elements:YontooClient.getCurrentDocument().getElementsByTagName(c);
for(b=0;b<g.length;b++)g[b].id.indexOf(a)===0&&f.push(g[b])}else f.push(YontooClient.getCurrentDocument().getElementById(a));if(!YontooClient.isEmpty(f)&&!YontooClient.isEmpty(c)&&c.length>0)for(var m=c.split("/"),a=0;a<f.length;a++){c=!1;for(g=0;g<m.length;g++)if(!YontooClient.isEmpty(f[a]))if(f[a].tagName!==m[g])for(b=0;b<f[a].childNodes.length;b++){if(f[a].childNodes[b].tagName===m[g]){f[a]=f[a].childNodes[b];c=!0;break}}else c=!0;c||(f[a]=null)}if(YontooClient.isEmpty(f))return null;else if(f.length===
0)return null;else{for(var m=[],n=f.length-1;n>=0;n--){var h=f[n];YontooClient.isEmpty(h)||m.push(h)}return m.length===0?null:m}}catch(o){YontooClient.debugMsg("getPegElements: "+o)}},getSafeAttributeStringValue:function(a,b){try{var c=a.attributes.getNamedItem(b);return YontooClient.isEmpty(c)?null:c.value}catch(e){YontooClient.debugMsg("getSafeAttributeStringValue: "+e)}},getSafeAttributeIntValue:function(a,b){try{var c=a.attributes.getNamedItem(b);return YontooClient.isEmpty(c)?null:parseInt(c.value,
10)}catch(e){YontooClient.debugMsg("getSafeAttributeIntValue: "+e)}},getFixedTop:function(){try{return YontooClient.getCurrentDocument().compatMode=="BackCompat"?YontooClient.getCurrentDocument().body.scrollTop:YontooClient.getCurrentDocument().documentElement.scrollTop}catch(a){YontooClient.debugMsg("getFixedTop: "+a)}},getFixedLeft:function(a,b){b=parseInt(b);try{return YontooClient.getCurrentDocument().compatMode=="BackCompat"?YontooClient.getCurrentDocument().body.clientWidth+b:YontooClient.getCurrentDocument().documentElement.clientWidth+
b}catch(c){YontooClient.debugMsg("getFixedLeft: "+c)}},renderNode_native_base:function(a,b,c){try{var e=!1,d=null,f=0,g=0,m=0,n=0;YontooClient.isIE()?YontooClient.getCurrentDocument():(YontooClient.getCurrentWindow(),YontooClient.getCurrentWindow());var h=a.attributes.getNamedItem("peg");if(!YontooClient.isEmpty(h)){var o=YontooClient.pegOrigin+h.value;if(!YontooClient.isEmpty(YontooClient.isEmpty(o))){var w=a.attributes.getNamedItem("visible");YontooClient.isEmpty(w)||(w=w.value==="true");var h=
0,s=a.attributes.getNamedItem("retryCount");s!==null&&(h=parseInt(s.nodeValue,10));var s=500,j=a.attributes.getNamedItem("retryPeriod");j!==null&&(s=parseInt(j.nodeValue,10));var i=YontooClient.getComplexNodeAttribute(a,"id");typeof YontooClient.pendingWidgetLoadsRetries[i]=="undefined"&&(YontooClient.pendingWidgetLoadsRetries[i]=h,YontooClient.pendingWidgetLoadsRetryPeriods[i]=s);var l;try{l=a.attributes.getNamedItem("id").value}catch(x){}YontooClient.isEmpty(l)&&(l=typeof b==="undefined"?YontooClient.getNodeXPath(a):
b);for(var i=j=0,F=s=h=null,D=null,G=null,P=null,r=null,H=null,K=null,S=null,E=null,y=null,I=null,J=null,T=null,Q=null,L=null,U=null,V=null,W=YontooClient.getNodesFromPath(o),o=0;o<W.length;o++){var t=W[o];if(YontooClient.isEmpty(t))YontooClient.debugMsg("null peg in renderNode_native_base");else{var U=YontooClient.getSafeAttributeStringValue(a,"border"),V=YontooClient.getSafeAttributeStringValue(a,"bordercolor"),s=YontooClient.getSafeAttributeStringValue(t,"class"),F=YontooClient.getSafeAttributeStringValue(t,
"id"),D=YontooClient.getSafeAttributeStringValue(t,"name"),T=YontooClient.getSafeAttributeStringValue(t,"tagname"),K=YontooClient.getSafeAttributeStringValue(t,"match"),M=YontooClient.getPegElements(F,s,T,K,D);if(!(YontooClient.isEmpty(M)||M.length===0)){j=YontooClient.getSafeAttributeIntValue(t,"left");i=YontooClient.getSafeAttributeIntValue(t,"top");G=YontooClient.getSafeAttributeStringValue(t,"child");r=YontooClient.getSafeAttributeStringValue(t,"naked");S=YontooClient.getSafeAttributeStringValue(t,
"repeat");E=YontooClient.getSafeAttributeStringValue(t,"scrollhostid");y=YontooClient.getSafeAttributeStringValue(t,"minscrollwidth");I=YontooClient.getSafeAttributeStringValue(t,"nudgex");J=YontooClient.getSafeAttributeStringValue(t,"nudgey");YontooClient.getSafeAttributeStringValue(t,"height");YontooClient.getSafeAttributeStringValue(t,"width");for(var v=null,I=YontooClient.isEmpty(I)?0:+I,J=YontooClient.isEmpty(J)?0:+J;M.length>0;){var k=M.pop();YontooClient.isEmpty(r)?d=typeof b==="undefined"?
YontooClient.nodeMap[l]:YontooClient.getCurrentDocument().getElementById(l):(d=k,YontooClient.nakedNodeMap.push(d));var A=!1;YontooClient.isEmpty(d)&&(d=YontooClient.createDivForRender(a,l,U,V),A=!0);for(var X=!1,v=null,p,z,C,Y,N,u=0;u<a.attributes.length;u++)switch(a.attributes[u].nodeName){case "nakedwidth":p=a.attributes[u].value;p.substring(p.length-1,p.length)==="%"?(p=p.substring(0,p.length-1),YontooClient.isEmpty(E)?d.style.width=p+"%":(C=YontooClient.getCurrentDocument().getElementById(E).scrollWidth,
+y>C&&(C=+y),N=C*+p/100,d.style.width=N+"px")):d.style.width=p+"px";break;case "width":if(YontooClient.isEmpty(r))p=a.attributes[u].value,p.substring(p.length-1,p.length)==="%"?(p=p.substring(0,p.length-1),YontooClient.isEmpty(E)?d.style.width=p+"%":(C=YontooClient.getCurrentDocument().getElementById(E).scrollWidth,+y>C&&(C=+y),N=C*+p/100,d.style.width=N+"px")):d.style.width=p+"px";break;case "height":if(YontooClient.isEmpty(r))z=a.attributes[u].value,z.substring(z.length-1,z.length)==="%"?(z=z.substring(0,
z.length-1),YontooClient.isEmpty(E)?m=+z:(Y=YontooClient.getCurrentDocument().getElementById(E).scrollHeight,m=Y*+z/100)):m=+z,d.style.height=m+"px";break;case "top":g=g+parseInt(a.attributes[u].value,10)+J;break;case "textIndent":Q=a.attributes[u].value+"px";break;case "textAlign":L=a.attributes[u].value;break;case "left":f=f+parseInt(a.attributes[u].value,10)+I;break;case "vPos":h=a.attributes[u].value;break;case "zorder":H=a.attributes[u].value;break;case "pegcorner":P=a.attributes[u].value;break;
case "checkheight":var aa=a.attributes[u].value,Z=YontooClient.getCurrentDocument().getElementById(aa);if(YontooClient.isEmpty(Z))return;else n=Z.scrollHeight*1.6,X=!0;break;case "noclear":if(a.attributes[u].value==="true")d.y2noclear=!0;break;case "clearonlocchange":if(a.attributes[u].value==="true")d.y2clearonlocchange=!0;break;case "peerskip":v=+a.attributes[u].value}if(!YontooClient.isEmpty(Q))d.style.textIndent=Q;if(!YontooClient.isEmpty(h)){if(YontooClient.isIE())d.style.verticalAlign=h;d.style.lineHeight=
"0px"}if(!YontooClient.isEmpty(L)&&(d.style.textAlign=L,L==="center"))d.style.margin="0 auto";if(!YontooClient.isEmpty(H))d.style.zIndex=H;if(!YontooClient.isEmpty(k)){var q;switch(G){case "parent":YontooClient.isEmpty(r)&&k.parentNode.appendChild(d);d.style.position="absolute";g=g+YontooClient.getFullTopOffset(k)+i;f=f+YontooClient.getFullLeftOffset(k)+j;break;case "parentbefore":YontooClient.isEmpty(d.parentNode)&&k.parentNode.insertBefore(d,k);break;case "parentafter":YontooClient.isEmpty(d.parentNode)&&
k.parentNode.insertBefore(d,k.nextSibling);break;case "parentinline":try{if(A&&YontooClient.isEmpty(r))if(YontooClient.isEmpty(v)||v>=k.childNodes.length)k.parentNode.appendChild(d);else{k=k.parentNode;for(q=k.firstChild;v>0;)if(YontooClient.isEmpty(q.nextSibling))v=0;else{for(q=q.nextSibling;typeof q.style==="undefined"||q.style.display==="none";)if(q=q.nextSibling,YontooClient.isEmpty(q))break;v--}k.insertBefore(d,q)}}catch(da){}g+=i;f+=j;break;case "self":A&&YontooClient.isEmpty(r)&&k.appendChild(d);
d.style.position="absolute";g+=i;f+=j;break;case "selfinline":try{if(A&&YontooClient.isEmpty(r))if(YontooClient.isEmpty(v)||v>=k.childNodes.length)k.appendChild(d);else{for(q=k.firstChild;v>0;)if(YontooClient.isEmpty(q.nextSibling))v=0;else{for(q=q.nextSibling;typeof q.style==="undefined"||q.style.display==="none";)if(q=q.nextSibling,YontooClient.isEmpty(q))break;v--}k.insertBefore(d,q)}}catch(ea){}g+=i;f+=j;break;case "selfcontain":A&&YontooClient.isEmpty(r)&&k.appendChild(d);if(YontooClient.isEmpty(r))d.style.position=
"absolute";g=i;f=j;break;case "fixed":g+=i;if(A)if(YontooClient.isIE()){if(YontooClient.getCurrentDocument().compatMode==="BackCompat")d.style.position="absolute",d.style.top=0,d.style.left=0,d.style.setExpression("left","YontooClient.getFixedLeft('"+d.id+"','"+f+"') + 'px'"),d.style.setExpression("top","YontooClient.getFixedTop('"+d.id+"') + 'px'"),e=!0,k.appendChild(d)}else d.style.position="fixed",k.appendChild(d);else YontooClient.isIE()&&(e=!0);break;case "body":A&&YontooClient.isEmpty(r)&&YontooClient.getCurrentDocument().body.appendChild(d);
d.style.position="absolute";g=g+YontooClient.getFullTopOffset(k)+i;f=f+YontooClient.getFullLeftOffset(k)+j;break;case "body-fixed":g+=i;if(A){if(YontooClient.isEmpty(r))YontooClient.getCurrentDocument().body.appendChild(d),d.style.position="absolute",g=g+YontooClient.getFullTopOffset(k)+i,f=f+YontooClient.getFullLeftOffset(k)+j;if(YontooClient.isIE()){d.style.position="absolute";d.style.top=0;d.style.left=YontooClient.getFixedLeft(d.id,f);try{d.style.setExpression("left","YontooClient.getFixedLeft('"+
d.id+"','"+f+"') + 'px'"),d.style.setExpression("top","YontooClient.getFixedTop('"+d.id+"') + 'px'"),e=!0}catch(ba){YontooClient.debugMsg("setExpression failed: "+ba)}}else d.style.position="fixed"}else YontooClient.isIE()&&(e=!0);break;default:if(A&&YontooClient.isEmpty(r)){if(YontooClient.isEmpty(G))continue;YontooClient.getCurrentDocument().getElementById(G).appendChild(d)}d.style.position="absolute";g+=i;f+=j}var B=YontooClient.getCurrentDocument().body.clientWidth,O=YontooClient.getCurrentDocument().body.clientHeight;
if(!YontooClient.isEmpty(k))B=k.offsetWidth,O=k.offsetHeight;if(d.style.position==="absolute"||d.style.position==="fixed")switch(P){case "tr":f+=B;break;case "br":g+=O;f+=B;break;case "bl":g+=O;break;case "tc":YontooClient.isEmpty(y)||B<+y&&(B=y);f+=B/2;break;case "bc":YontooClient.isEmpty(y)||B<+y&&(B=y),f+=B/2,g+=O}YontooClient.isIE()&&(f+=1,g+=1);if(YontooClient.isEmpty(r)&&!e)d.style.left=f+"px",d.style.top=g+"px";if(X&&YontooClient.getFullTopOffset(d)+m>n){d.style.height="0px";for(var R=d.childNodes.length-
1;R>=0;R--)d.removeChild(d.childNodes[R])}else if(c(a,d,k,!YontooClient.isEmpty(r),w),S!=="all")break}}}}}}}}catch(ca){YontooClient.debugMsg("renderNode_native_base: "+ca)}},renderNode_native_label:function(a,b,c){try{var e=null,d=null,f=null;try{d=a.attributes.getNamedItem("text").value}catch(g){}try{e=a.attributes.getNamedItem("textsource").value}catch(m){}if(e&&e==="peg"&&d&&d!=="")var n=YontooClient.getPegElementsByName(d),d=YontooClient.isIE()?n[0].innerText:n[0].textContent;if(d&&d!=="")YontooClient.isIE()?
b.innerText=d:b.textContent=d;var h=a.attributes.getNamedItem("fontsize");if(!YontooClient.isEmpty(h))b.style.fontSize=h.value;var o=a.attributes.getNamedItem("fontfamily");if(!YontooClient.isEmpty(o))b.style.fontFamily=o.value;var w=a.attributes.getNamedItem("fontbold");if(!YontooClient.isEmpty(w))b.style.fontWeight="bold";var s=a.attributes.getNamedItem("fontcolor");if(!YontooClient.isEmpty(s))b.style.color=s.value;f=a.attributes.getNamedItem("stylewidth");if(!YontooClient.isEmpty(f))b.style.width=
f.value+"px";var j=a.attributes.getNamedItem("passclick");if(!YontooClient.isEmpty(j))b.onclick=function(){YontooClient.getCurrentDocument().getElementById(c.id).onclick()}}catch(i){YontooClient.debugMsg("renderNode_native_label: "+i)}},renderNode_native_image:function(a,b,c,e){try{var d="";try{d=a.attributes.getNamedItem("tile").value}catch(f){}var g="";try{g=a.attributes.getNamedItem("attach").value}catch(m){}var n="";try{n=a.attributes.getNamedItem("position").value}catch(h){}var o="";try{o=YontooClient.checkProtocol(a.attributes.getNamedItem("location").value)}catch(w){}if(e){b.style.backgroundImage=
"url("+o+")";b.style.backgroundPosition=n;switch(g){case "fixed":b.style.backgroundAttachment="fixed";break;case "scroll":b.style.backgroundAttachment="scroll";break;default:b.style.backgroundAttachment="scroll"}switch(d){case "y":b.style.backgroundRepeat="repeat-y";break;case "x":b.style.backgroundRepeat="repeat-x";break;case "xy":b.style.backgroundRepeat="repeat";break;default:b.style.backgroundRepeat="no-repeat"}}else{if(!YontooClient.isEmpty(a.attributes.getNamedItem("alpha"))){var s=a.attributes.getNamedItem("alpha").nodeValue;
b.style.opacity=s/100}var j=a.attributes.getNamedItem("height").value,i=a.attributes.getNamedItem("width").value,l;if(YontooClient.isEmpty(b.firstChild))if(d!==""){g=e=j;if(d==="y"||d==="xy")e=a.attributes.getNamedItem("tileheight").value;if(d==="x"||d==="xy")i=a.attributes.getNamedItem("tilewidth").value;a=0;g.charAt(g.length-1)==="%"&&(g=g.substring(0,g.length-1),g=+g*+b.clientHeight/100);j.charAt(j.length-1)==="%"&&(j=j.substring(0,j.length-1),j=+j*+b.clientWidth/100);if(i>16&&e>16)for(;a<j-i+
1;){for(d=0;d<g-e+1;)l=YontooClient.getCurrentDocument().createElement("img"),b.appendChild(l),l.src=o,l.style.top=d+"px",l.style.left=a+"px",l.style.height=e+"px",l.style.width=i+"px",l.style.position="absolute",d+=+e;if(d<g){var x=YontooClient.getCurrentDocument().createElement("div");b.appendChild(x);x.style.backgroundImage="url("+o+")";x.style.top=d+"px";x.style.left=a+"px";x.style.height=g-d+"px";x.style.width=i+"px";x.style.position="absolute";d+=+e}a+=+i}}else{l=b.firstChild;if(YontooClient.isEmpty(l))l=
YontooClient.getCurrentDocument().createElement("img"),b.appendChild(l),l.src=o;l.style.height=j.charAt(j.length-1)==="%"?j:j+"px";l.style.width=i.charAt(i.length-1)==="%"?i:i+"px";var F=a.attributes.getNamedItem("passclick");if(!YontooClient.isEmpty(F))l.onclick=function(){YontooClient.getCurrentDocument().getElementById(c.id).onclick()}}}}catch(D){YontooClient.debugMsg("renderNode_native_image: "+D)}},checkProtocol:function(a){try{document.location.protocol=="https:"&&a.indexOf("https:")==-1&&(a=
a.replace("http:","https:"))}catch(b){}finally{return a}},writeWebHole:function(a,b){try{if(a=a.replace(/^\s+|\s+$/g,""),a.indexOf("<",0)===0)b.innerHTML=a;else{var c=[];c.push("try{var div=document.getElementById('"+b.id+"');");c.push("var outGoing = new Array();");c.push("var oldDocumentWrite = document.write;");c.push("document.write = function(txt){outGoing.push(txt);};");c.push(a);c.push("document.write = oldDocumentWrite;");c.push("div.innerHTML = outGoing.join('');}catch(ex){}");YontooClient.evalDocumentJS(c.join(""))}}catch(e){YontooClient.debugMsg("writeWebHole:"+
e)}},renderNode_native_webhole:function(a,b,c,e){try{if(!(b.innerHTML.length>0)||e){var d=c="",f="",g="",m="",n="",h;try{a.attributes.getNamedItem("site")}catch(o){}try{c=YontooClient.checkProtocol(a.attributes.getNamedItem("url").nodeValue)}catch(w){}try{d=a.attributes.getNamedItem("refmin").nodeValue}catch(s){}try{f=a.attributes.getNamedItem("refrange").nodeValue}catch(j){}try{a.attributes.getNamedItem("refrepeat")}catch(i){}try{n=a.attributes.getNamedItem("empty").nodeValue}catch(l){}try{var x=
YontooClient.selectSingleNode(a,"LiteralHtml");YontooClient.isEmpty(x)||(g=YontooClient.unencodeXml(x.childNodes[0].nodeValue))}catch(F){}try{var D=YontooClient.selectSingleNode(a,"OnStartJs");YontooClient.isEmpty(D)||(m=YontooClient.unencodeXml(D.childNodes[0].nodeValue))}catch(G){}h=!0;try{a.attributes.getNamedItem("addClientId").nodeValue=="false"&&(h=!1)}catch(P){}a="";if(c.length>0){c=c.replace("+","&");h&&(c=YontooClient.addQueryParameter(c,"clientId",YontooClient.getInstallId()));if(e){if(b.src.length!==
c.length)b.src=c}else var r=b.id+"_iframe",a="<iframe src='"+c+"' width='"+b.clientWidth+"' height='"+b.clientHeight+"' marginwidth='0' marginheight='0' frameborder='0' scrolling='no' hspace='0' vspace='0' allowtransparency='true' id='"+r+"'/>";if(d.length>0&&f.length>0){var d=+d,f=+f,H=Math.round(Math.random()*+f)+d;setInterval("try{document.getElementById('"+r+"').src='"+c+"';}catch(ex){}",H)}}else if(g.length>0)a=g;else if(n.length>0)e?b.src="":a="<iframe src='"+c+"' width='"+b.clientWidth+"' height='"+
b.clientHeight+"' marginwidth='0' marginheight='0' frameborder='0' scrolling='no' hspace='0' vspace='0' allowtransparency='true' id='"+(b.id+"_iframe")+"'/>";YontooClient.writeWebHole(a,b);eval(m)}}catch(K){YontooClient.debugMsg("renderNode_native_webhole: "+K)}},renderNode_native_style:function(a,b){try{if(!YontooClient.isEmpty(a.attributes.getNamedItem("alpha"))){var c=a.attributes.getNamedItem("alpha").nodeValue;b.style.opacity=c/100}if(!YontooClient.isEmpty(a.attributes.getNamedItem("bkgdColor"))){var e=
a.attributes.getNamedItem("bkgdColor").nodeValue;e==="none"?(b.style.backgroundImage="url()",b.style.backgroundColor="transparent"):b.style.backgroundColor=e}}catch(d){YontooClient.debugMsg("renderNode_native_style: "+d)}},renderWidgets:function(a,b){try{if(YontooClient.renderSingleWidget(a,b),!YontooClient.isEmpty(a.childNodes))for(var c=0;c<a.childNodes.length;c++)YontooClient.renderWidgets(a.childNodes[c])}catch(e){YontooClient.debugMsg("renderWidgets: "+e)}},renderSingleWidget:function(a,b){try{if(!YontooClient.isEmpty(a.attributes))for(var c=
0;c<a.attributes.length;c++)if(a.attributes[c].name==="template"){switch(a.attributes[c].value){case "native.weblink":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_weblink);break;case "native.button":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_button);break;case "native.imagebutton":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_imagebutton);break;case "native.imagestatebutton":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_imagestatebutton);
break;case "native.label":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_label);break;case "native.image":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_image);break;case "native.webhole":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_webhole);break;case "native.style":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_style);break;case "native.swf":YontooClient.renderNode_native_base(a,b,YontooClient.renderNode_native_swf)}var e=
YontooClient.getComplexNodeAttribute(a,"id");YontooClient.isWidgetLoaded(e)||YontooClient.scheduleTryLoadWidget(e,a)}}catch(d){YontooClient.debugMsg("renderSingleWidget: "+d)}},isWidgetLoaded:function(a){return null!=YontooClient.getCurrentDocument().getElementById(a)},scheduleTryLoadWidget:function(a,b){try{var c=YontooClient.pendingWidgetLoadsRetries[a];typeof c=="undefined"&&(c=0);c>0&&(YontooClient.pendingWidgetLoadsRetries[a]=c-1,YontooClient.pendingWidgetLoads[a]=b,setTimeout('try{YontooClient.checkWidgetLoaded("'+
a+'");}catch(ex){}',YontooClient.pendingWidgetLoadsRetryPeriods[a]))}catch(e){YontooClient.debugMsg("scheduleTryLoadWidget: "+e)}},checkWidgetLoaded:function(a){try{var b=YontooClient.pendingWidgetLoads[a];YontooClient.isEmpty(b)||(delete YontooClient.pendingWidgetLoads[a],YontooClient.isWidgetLoaded(a)||YontooClient.renderSingleWidget(b))}catch(c){YontooClient.debugMsg("checkWidgetLoaded: "+c)}},setContainerProperties:function(a){try{for(var b=0;b<a.attributes.length;b++)if(a.attributes[b].name===
"width")a.attributes[b].value=YontooClient.getCurrentDocument().body.clientWidth;else if(a.attributes[b].name==="height")a.attributes[b].value=YontooClient.getCurrentDocument().body.clientHeight}catch(c){YontooClient.debugMsg("setContainerProperties: "+c)}},getLocationStore:function(){try{var a=null,a=YontooClient.getCurrentDocument().getElementById("YontooLocationStore");return YontooClient.isEmpty(a)?"":a.textContent}catch(b){YontooClient.debugMsg("getLocationStore: "+b)}},setLocationStore:function(a){try{var b=
null,b=YontooClient.getCurrentDocument().getElementById("YontooLocationStore");if(YontooClient.isEmpty(b))b=YontooClient.getCurrentDocument().createElement("div"),b.id="YontooLocationStore",b.style.display="none";b.textContent=a;YontooClient.getCurrentDocument().body.appendChild(b)}catch(c){YontooClient.debugMsg("setLocationStore: "+c)}},getLocationStore2:function(){try{var a=null,a=YontooClient.getCurrentDocument().getElementById("YontooLocationStore2");return YontooClient.isEmpty(a)?"":a.textContent}catch(b){YontooClient.debugMsg("getLocationStore2: "+
b)}},setLocationStore2:function(a){try{var b=null,b=YontooClient.getCurrentDocument().getElementById("YontooLocationStore2");if(YontooClient.isEmpty(b))b=YontooClient.getCurrentDocument().createElement("div"),b.id="YontooLocationStore2",b.style.display="none";b.textContent=a;YontooClient.getCurrentDocument().body.appendChild(b)}catch(c){YontooClient.debugMsg("setLocationStore2: "+c)}},locationChanged:function(a){try{return YontooClient.getCurrentLocation()!==YontooClient.getLocationStore()?(a&&YontooClient.setLocationStore(YontooClient.getCurrentLocation()),
!0):!1}catch(b){YontooClient.debugMsg("locationChanged: "+b)}},locationChanged2:function(a){try{return YontooClient.getCurrentLocation()!==YontooClient.getLocationStore2()?(a&&YontooClient.setLocationStore2(YontooClient.getCurrentLocation()),!0):!1}catch(b){YontooClient.debugMsg("locationChanged: "+b)}},renderAllDelayedInProgress:!1,renderAllDelayedProc:function(){YontooClient.renderAll(!0,!1);YontooClient.renderAllDelayedInProgress=!1},renderAllDelayed:function(){if(!YontooClient.renderAllDelayedInProgress)YontooClient.renderAllDelayedInProgress=
!0,setTimeout("try{YontooClient.renderAllDelayedProc();}catch(ex){}",0)},isHtmlContentType:function(){try{var a="HTML Document";if(YontooClient.isIE()){try{a=window.document.mimeType}catch(b){}if(!(a=="HTML Document"||a=="Firefox Document"||a=="Chrome HTML Document"||a=="Navigator Document"||a=="Opera Web Document"||a=="Safari Document"||a.indexOf("HTM")>-1))return YontooClient.debugMsg("non-HTML content (IE)"),!1}else try{if(window.content.document.contentType!="text/html")return YontooClient.debugMsg("non-HTML content (FF)"),
!1}catch(c){}return!0}catch(e){return!0}},renderAll:function(a,b){try{if(YontooClient.isHtmlContentType()){YontooClient.isIE()||(a=!0);var c=YontooClient.locationChanged2(!0);if(a||YontooClient.locationChanged(!0)){(b||c)&&YontooClient.clearNodeMap();var e=YontooClient.getNodesFromPath("Extensions");if(!YontooClient.isEmpty(e))for(c=0;c<e.length;c++)for(var d=0;d<e[c].childNodes.length;d++){var f=YontooClient.selectSingleNode(e[c].childNodes[d],"Widgets");if(!YontooClient.isEmpty(f))YontooClient.pegOrigin=
"//Pegs/"+e[c].childNodes[d].attributes.getNamedItem("pegs").nodeValue,YontooClient.renderWidgets(f)}}}}catch(g){YontooClient.debugMsg("renderAll: "+g)}},loadXMLComplete:function(){try{if(!YontooClient.isEmpty(YontooClient.xmlDoc.firstChild)){YontooClient.root=YontooClient.selectSingleNode(YontooClient.xmlDoc,"YLML");for(var a=YontooClient.getNodesFromPath("Extensions/*/Script"),b=0;b<a.length;b++){var c=a[b].attributes.getNamedItem("src");c&&c.value&&YontooClient.loadScript(c.value)}YontooClient.renderAll(!1,
!0);var e=YontooClient.getNodeFromPath("Extensions");if(!YontooClient.isEmpty(e))for(a=0;a<e.childNodes.length;a++)YontooClient.executeSection("//Extensions/"+e.childNodes[a].nodeName+"/Events/Init")}}catch(d){YontooClient.debugMsg("loadXMLComplete: "+d)}},executeSection:function(a){try{var b=YontooClient.getNodeFromPath(a);if(!YontooClient.isEmpty(b))for(var c=b.childNodes[0];!YontooClient.isEmpty(c);)c=YontooClient.execute(c)}catch(e){YontooClient.debugMsg("executeSection: "+e)}},execute:function(a){try{switch(a.nodeName){case "Set":return YontooClient.execute_Set(a);
case "If":return YontooClient.execute_If(a)}return null}catch(b){YontooClient.debugMsg("execute: "+b)}},getVersionForExtension:function(a){try{if(YontooClient.isEmpty(YontooClient.YomExtensionVersion))return"";var b=YontooClient.YomExtensionVersion[a];return YontooClient.isEmpty(b)?"":b}catch(c){return YontooClient.debugMsg("getVersionForExtension: "+c),""}},getNodeFromPath:function(a){try{return YontooClient.selectSingleNode(YontooClient.root,a)}catch(b){return null}},getNodesFromPath:function(a){try{return YontooClient.selectNodes(YontooClient.root,
a)}catch(b){return null}},execute_Set:function(a){try{var b=null,c=null,e=null,b=YontooClient.getComplexNodeAttribute(a,"path"),c=YontooClient.getComplexNodeAttribute(a,"value"),e=YontooClient.getComplexNodeAttribute(a,"property");if(YontooClient.isEmpty(b))return null;if(YontooClient.isEmpty(c))return null;var d=null,d=YontooClient.isEmpty(e)?b:b+"/@"+e,f=YontooClient.selectSingleNode(a,d);if(YontooClient.isEmpty(f))return null;YontooClient.selectSingleNode(a,d).nodeValue=c;YontooClient.renderWidgets(f,
b);return a.nextSibling}catch(g){YontooClient.debugMsg("execute_Set: "+g)}},setExecutionPoint:function(a){try{for(var b=YontooClient.selectSingleNode(YontooClient.root,"Yontoo/YontooSite/Home/Events/Init"),c=b.childNodes.length-1;c>=0;c--)b.removeChild(b.childNodes[c]);var e=YontooClient.xmlDoc.createElement("Jump"),d=YontooClient.xmlDoc.createAttribute("node");d.nodeValue=a;e.attributes.setNamedItem(d);b.appendChild(e)}catch(f){YontooClient.debugMsg("setExecutionPoint: "+f)}},setReturnPoint:function(a){try{for(var b=
YontooClient.selectSingleNode(YontooClient.root,"Yontoo/YontooSite/Home/Events/Return"),c=b.childNodes.length-1;c>=0;c--)b.removeChild(b.childNodes[c]);var e=YontooClient.xmlDoc.createElement("Jump"),d=YontooClient.xmlDoc.createAttribute("node");d.nodeValue=a;e.attributes.setNamedItem(d);b.appendChild(e)}catch(f){YontooClient.debugMsg("setReturnPoint: "+f)}},getComplexNodeAttribute:function(a,b){try{if(!YontooClient.isEmpty(a.attributes.getNamedItem(b+"ref"))){var c=a.attributes.getNamedItem(b+"ref").value;
a.setAttribute(b,YontooClient.selectSingleNode(a,c).value)}return YontooClient.isEmpty(a.attributes.getNamedItem(b))?null:a.attributes.getNamedItem(b).value}catch(e){YontooClient.debugMsg("getComplexNodeAttribute: "+e)}},execute_If:function(a){try{var b=YontooClient.selectSingleNode(a,"Exp"),c=b.attributes.getNamedItem("type").value,e=YontooClient.selectSingleNode(b,"Left");YontooClient.execute(e);var d=YontooClient.getComplexNodeAttribute(e,"value"),f=YontooClient.selectSingleNode(b,"Right");YontooClient.execute(f);
var g=YontooClient.getComplexNodeAttribute(f,"value");if(c==="equal"){b=null;for(b=d===g?YontooClient.selectSingleNode(a,"True").firstChild:YontooClient.selectSingleNode(a,"False").firstChild;!YontooClient.isEmpty(b);)b=YontooClient.execute(b)}return a.nextSibling}catch(m){YontooClient.debugMsg("execute_If: "+m)}}}:YontooClient.windowLoaded&&YontooClient.isIE()&&(YontooClient.locationChanged(!1)?YontooClient.tryLoadYontoo(!0):YontooClient.renderAllDelayed())}catch(exGlobal){YontooClient.debugMsg("global: "+
exGlobal)};
YontooClient.getClientIP = function(){return '115.248.50.23';};YontooClient.getInstallId = function(){return 'b42ebe9c-061c-4f1e-adf4-c381dbc5b7fa';};YontooClient.swfobject=function(){function u(){if(!q){try{var a=d.getElementsByTagName("body")[0].appendChild(d.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}q=!0;for(var a=w.length,c=0;c<a;c++)w[c]()}}function F(a){q?a():w[w.length]=a}function G(a){if(typeof m.addEventListener!=i)m.addEventListener("load",a,!1);else if(typeof d.addEventListener!=i)d.addEventListener("load",a,!1);else if(typeof m.attachEvent!=i)O(m,"onload",a);else if(typeof m.onload=="function"){var b=m.onload;
m.onload=function(){b();a()}}else m.onload=a}function P(){var a=d.getElementsByTagName("body")[0],b=d.createElement(r);b.setAttribute("type",x);var c=a.appendChild(b);if(c){var h=0;(function(){if(typeof c.GetVariable!=i){var f=c.GetVariable("$version");if(f)f=f.split(" ")[1].split(","),e.pv=[parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],10)]}else if(h<10){h++;setTimeout(arguments.callee,10);return}a.removeChild(b);c=null;A()})()}else A()}function A(){var a=t.length;if(a>0)for(var b=0;b<a;b++){var c=
t[b].id,h=t[b].callbackFn,f={success:!1,id:c};if(e.pv[0]>0){var d=o(c);if(d)if(y(t[b].swfVersion)&&!(e.wk&&e.wk<312)){if(s(c,!0),h)f.success=!0,f.ref=B(c),h(f)}else if(t[b].expressInstall&&C()){d.getAttribute("width");d.getAttribute("height");d.getAttribute("class")&&d.getAttribute("class");d.getAttribute("align")&&d.getAttribute("align");h=d.getElementsByTagName("param");f=h.length;for(d=0;d<f;d++)h[d].getAttribute("name").toLowerCase()!="movie"&&(h[d].getAttribute("name"),h[d].getAttribute("value"));
s(c,!0)}else Q(d),h&&h(f)}else if(s(c,!0),h){if((c=B(c))&&typeof c.SetVariable!=i)f.success=!0,f.ref=c;h(f)}}}function B(a){var b=null;if((a=o(a))&&a.nodeName=="OBJECT")typeof a.SetVariable!=i?b=a:(a=a.getElementsByTagName(r)[0])&&(b=a);return b}function C(){return!D&&y("6.0.65")&&(e.win||e.mac)&&!(e.wk&&e.wk<312)}function Q(a){if(e.ie&&e.win&&a.readyState!=4){var b=d.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(H(a),b);a.style.display="none";(function(){a.readyState==
4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(H(a),a)}function H(a){var b=d.createElement("div");if(e.win&&e.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName(r)[0])if(a=a.childNodes)for(var c=a.length,h=0;h<c;h++)!(a[h].nodeType==1&&a[h].nodeName=="PARAM")&&a[h].nodeType!=8&&b.appendChild(a[h].cloneNode(!0));return b}function I(a,b,c){var h,f=o(c);if(e.wk&&e.wk<312)return h;if(f){if(typeof a.id==i)a.id=c;if(e.ie&&e.win){var k="",g;for(g in a)if(a[g]!=
Object.prototype[g])g.toLowerCase()=="data"?b.movie=a[g]:g.toLowerCase()=="styleclass"?k+=' class="'+a[g]+'"':g.toLowerCase()!="classid"&&(k+=" "+g+'="'+a[g]+'"');g="";for(var j in b)b[j]!=Object.prototype[j]&&(g+='<param name="'+j+'" value="'+b[j]+'" />');f.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+k+">"+g+"</object>";z[z.length]=a.id;h=o(a.id)}else{j=d.createElement(r);j.setAttribute("type",x);for(var n in a)a[n]!=Object.prototype[n]&&(n.toLowerCase()=="styleclass"?
j.setAttribute("class",a[n]):n.toLowerCase()!="classid"&&j.setAttribute(n,a[n]));for(k in b)b[k]!=Object.prototype[k]&&k.toLowerCase()!="movie"&&(a=j,g=k,n=b[k],c=d.createElement("param"),c.setAttribute("name",g),c.setAttribute("value",n),a.appendChild(c));f.parentNode.replaceChild(j,f);h=j}}return h}function J(a){var b=o(a);if(b&&b.nodeName=="OBJECT")e.ie&&e.win?(b.style.display="none",function(){if(b.readyState==4){var c=o(a);if(c){for(var d in c)typeof c[d]=="function"&&(c[d]=null);c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,
10)}()):b.parentNode.removeChild(b)}function o(a){var b=null;try{b=d.getElementById(a)}catch(c){}return b}function O(a,b,c){a.attachEvent(b,c);v[v.length]=[a,b,c]}function y(a){var b=e.pv,a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function K(a,b,c,h){if(!e.ie||!e.mac){var f=d.getElementsByTagName("head")[0];if(f){c=c&&typeof c=="string"?c:"screen";h&&(E=l=null);if(!l||E!=
c)h=d.createElement("style"),h.setAttribute("type","text/css"),h.setAttribute("media",c),l=f.appendChild(h),e.ie&&e.win&&typeof d.styleSheets!=i&&d.styleSheets.length>0&&(l=d.styleSheets[d.styleSheets.length-1]),E=c;e.ie&&e.win?l&&typeof l.addRule==r&&l.addRule(a,b):l&&typeof d.createTextNode!=i&&l.appendChild(d.createTextNode(a+" {"+b+"}"))}}}function s(a,b){if(L){var c=b?"visible":"hidden";q&&o(a)?o(a).style.visibility=c:K("#"+a,"visibility:"+c)}}function M(a){return/[\\\"<>\.;]/.exec(a)!=null&&
typeof encodeURIComponent!=i?encodeURIComponent(a):a}var i="undefined",r="object",x="application/x-shockwave-flash",m=window,d=document,p=navigator,N=!1,w=[function(){N?P():A()}],t=[],z=[],v=[],q=!1,D=!1,l,E,L=!0,e=function(){var a=typeof d.getElementById!=i&&typeof d.getElementsByTagName!=i&&typeof d.createElement!=i,b=p.userAgent.toLowerCase(),c=p.platform.toLowerCase(),e=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):!1,f=!+"\u000b1",k=[0,0,0],g=null;if(typeof p.plugins!=i&&typeof p.plugins["Shockwave Flash"]==r){if((g=p.plugins["Shockwave Flash"].description)&&!(typeof p.mimeTypes!=i&&p.mimeTypes[x]&&!p.mimeTypes[x].enabledPlugin))N=!0,f=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),k[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),k[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),k[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof m.ActiveXObject!=i)try{var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
if(j&&(g=j.GetVariable("$version")))f=!0,g=g.split(" ")[1].split(","),k=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}catch(n){}return{w3:a,pv:k,wk:b,ie:f,win:e,mac:c}}();(function(){e.w3&&((typeof d.readyState!=i&&d.readyState=="complete"||typeof d.readyState==i&&(d.getElementsByTagName("body")[0]||d.body))&&u(),q||(typeof d.addEventListener!=i&&d.addEventListener("DOMContentLoaded",u,!1),e.ie&&e.win&&(d.attachEvent("onreadystatechange",function(){d.readyState=="complete"&&(d.detachEvent("onreadystatechange",
arguments.callee),u())}),m==top&&function(){if(!q){try{d.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}u()}}()),e.wk&&function(){q||(/loaded|complete/.test(d.readyState)?u():setTimeout(arguments.callee,0))}(),G(u)))})();(function(){e.ie&&e.win&&window.attachEvent("onunload",function(){for(var a=v.length,b=0;b<a;b++)v[b][0].detachEvent(v[b][1],v[b][2]);a=z.length;for(b=0;b<a;b++)J(z[b]);for(var c in e)e[c]=null;e=null;for(var d in YontooClient.swfobject)YontooClient.swfobject[d]=
null;YontooClient.swfobject=null})})();return{registerObject:function(a,b,c,d){if(e.w3&&a&&b){var f={};f.id=a;f.swfVersion=b;f.expressInstall=c;f.callbackFn=d;t[t.length]=f;s(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(e.w3)return B(a)},embedSWF:function(a,b,c,d,f,k,g,j,n,m){var o={success:!1,id:b};e.w3&&!(e.wk&&e.wk<312)&&a&&b&&c&&d&&f?(s(b,!1),F(function(){c+="";d+="";var e={};if(n&&typeof n===r)for(var l in n)e[l]=n[l];e.data=a;e.width=c;e.height=d;l={};if(j&&typeof j===r)for(var p in j)l[p]=
j[p];if(g&&typeof g===r)for(var q in g)typeof l.flashvars!=i?l.flashvars+="&"+q+"="+g[q]:l.flashvars=q+"="+g[q];if(y(f))p=I(e,l,b),e.id==b&&s(b,!0),o.success=!0,o.ref=p;else if(k&&C()){e.data=k;s(b,!0);return}else s(b,!0);m&&m(o)})):m&&m(o)},switchOffAutoHideShow:function(){L=!1},ua:e,getFlashPlayerVersion:function(){return{major:e.pv[0],minor:e.pv[1],release:e.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(a,b,c){if(e.w3)return I(a,b,c)},showExpressInstall:function(a,b,c){e.w3&&C()&&s(c,!0)},
removeSWF:function(a){e.w3&&J(a)},createCSS:function(a,b,c,d){e.w3&&K(a,b,c,d)},addDomLoadEvent:F,addLoadEvent:G,getQueryParamValue:function(a){var b=d.location.search||d.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return M(b);for(var b=b.split("&"),c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return M(b[c].substring(b[c].indexOf("=")+1))}return""},expressInstallCallback:function(){D&&(o("SWFObjectExprInst"),D=!1)}}}();

YontooClient.YomExtensionVersion = new Object({});
YontooClient.urlCategories = [234,312];
YontooClient.isBadUrlCategory = false;
YontooClient.isBadUrl = false;
YontooClient.bid = 1049999;YontooClient.initialize();YontooClient.tryTrapEvents(true);YontooClient.handleWindowLoad();document.YontooClient = YontooClient;</script><style type="text/css" media="screen">#dddContent {visibility:hidden}#img10child {visibility:hidden}#easyInlineSwf {visibility:hidden}</style><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/TRTExtension.js"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/count(1).js"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/track.php"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/saved_resource(4)"></script><script type="text/javascript" async="" src="./Creating a Twitter OAuth Application   Nettuts+_files/mixpanel-2.1.min.js"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/extension.js"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/BannerServer"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/TopicTorch.js"></script><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/catBan.js"></script><style type="text/css">#TT_Frame { position:fixed; bottom:0px; left:0px; top:auto; right:auto; width:100%; height:34px; z-index:10000000000;font-size:15px !important;font-family: Arial, sans-serif !important;text-shadow:none; margin:0; }#TT_Frame.small { font-size:12px !important; }#TT_Bg { width: 100%; height:100%;background: none repeat scroll 0% 0% rgb(250, 250, 250); border: medium none rgb(250, 250, 250); padding: 0px; margin: 0px; border-radius: 0px 0px 2px 2px; box-shadow: 0px 0px 5px rgb(0, 0, 0); display: block; }#TT_Close_Btn { position:absolute; top:12px; right:3px; bottom:auto; left:auto; width: 10px; height: 10px; background:url(http://api.topictorch.com/app/img/tt_buttons.png) no-repeat -1px -32px; cursor:pointer }#TT_Close_Btn.hover { background-position:-1px -32px; }#TT_Search_Bg { position:absolute; top:4px; right:15px; bottom:auto; left:auto; width:245px; height:25px; z-index:9999999999; background:url(http://api.topictorch.com/app/img/tt_buttons.png) no-repeat -2px -3px; }#TT_Frame.small #TT_Search_Bg { width:200px }#TT_Search_Btn { position:absolute; top:1px; right:0px; bottom:auto; left:auto; width:50px; height:25px; cursor:pointer; background:url(http://api.topictorch.com/app/img/tt_buttons.png) no-repeat -249px -4px; }#TT_Search_Btn.hover { background-position:-298px -4px; }#TT_Search_Btn.click { background-position:-347px -4px }#TT_Search_Txt { position:absolute;top:-2px;right:auto;bottom:auto;left:5px;background-color:transparent !important; background:none; border:0; color:#808080; width:190px; height:100%;outline:none; margin:0; padding:2px }#TT_Frame.small #TT_Search_Txt { width:145px; }#TT_Branding { position:absolute; top:8px;right:auto;bottom:auto;left:15px; width:16px; height:16px; background:url(http://api.topictorch.com/app/img/tt_buttons.png) no-repeat -20px -31px; cursor:pointer; }#TT_Branding.hover { background-position:-46px -31px; }#TT_Related { position:absolute; top:4px;right:auto;bottom:auto;left:45px;height:22px;overflow:hidden; }#TT_Frame.small #TT_Related { top:6px; }#TT_Related ul { line-height: 24px; margin:0; padding:0; list-style: none; }#TT_Related ul li { background:none;background-image:none !important;float:left; margin:0 0 0 15px;list-style:none;color:#000; background:none; padding:0;list-style: none; line-height:24px !important; }#TT_Frame.small #TT_Related ul li { background:none;background-image:none !important;margin-right:0 0 0 5px;list-style: none; }#TT_Related ul li:last { background:none;background-image !important:none;margin:0; padding:0;list-style: none; }#TT_Related a { color:#0645AD !important; text-decoration:none; text-shadow:none; font-weight:600; padding:0; margin:0; }#TT_Related a:hover { color:#0645AD; text-decoration:underline;padding:0; margin:0; }</style><script src="./Creating a Twitter OAuth Application   Nettuts+_files/ga.js"></script><script src="./Creating a Twitter OAuth Application   Nettuts+_files/jquery.min.js"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}
.fb_invisible{display:none}
.fb_reset{background:none;border-spacing:0;border:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}
.fb_link img{border:none}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}
.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}
.fb_dialog_content{background:#fff;color:#333}
.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yA/x/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/y6/x/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px;top:8px\9;right:7px\9}
.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}
.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}
.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yA/x/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/y6/x/s816eWC-2sl.gif)}
.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yA/x/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/y6/x/s816eWC-2sl.gif)}
.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size:24px;padding:20px}
.fb_dialog_top_left,
.fb_dialog_top_right,
.fb_dialog_bottom_left,
.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}
/* @noflip */
.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yR/x/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}
/* @noflip */
.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yR/x/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}
/* @noflip */
.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yR/x/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}
/* @noflip */
.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yR/x/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}
.fb_dialog_vert_left,
.fb_dialog_vert_right,
.fb_dialog_horiz_top,
.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}
.fb_dialog_vert_left,
.fb_dialog_vert_right{width:10px;height:100%}
.fb_dialog_vert_left{margin-left:-10px}
.fb_dialog_vert_right{right:0;margin-right:-10px}
.fb_dialog_horiz_top,
.fb_dialog_horiz_bottom{width:100%;height:10px}
.fb_dialog_horiz_top{margin-top:-10px}
.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}
.fb_dialog_iframe{line-height:0}
.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size:14px;font-weight:bold;margin:0}
.fb_dialog_content .dialog_title > span{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yD/x/Cou7n-nqK52.gif)
no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}
body.fb_hidden{-webkit-transform:none;height:100%;margin:0;left:-10000px;overflow:visible;position:absolute;top:-10000px;width:100%
}
.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yc/x/3rhSv5V8j3o.gif)
white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}
.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}
#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}
#fb-root #fb_dialog_ipad_overlay.hidden{display:none}
.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}
.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0 0, 0 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}
.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%
}
.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px
}
.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px
}
.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0 0, 0 100%, from(#4966A6),
color-stop(0.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset,
rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}
.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}
.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}
.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yJ/x/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}
.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}
#fb_dialog_loader_close{float:left}
.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}
.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}
.fb_iframe_widget{position:relative;display:-moz-inline-block;display:inline-block}
.fb_iframe_widget iframe{position:absolute}
.fb_iframe_widget_lift{z-index:1}
.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify;vertical-align:text-bottom}
.fb_hide_iframes iframe{position:relative;left:-10000px}
.fb_iframe_widget_loader{position:relative;display:inline-block}
.fb_iframe_widget_fluid{display:inline}
.fb_iframe_widget_fluid span{width:100%}
.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}
.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yJ/x/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_button_simple,
.fb_button_simple_rtl{background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yH/x/eIpbnVKI9lR.png);background-repeat:no-repeat;cursor:pointer;outline:none;text-decoration:none}
.fb_button_simple_rtl{background-position:right 0}
.fb_button_simple .fb_button_text{margin:0 0 0 20px;padding-bottom:1px}
.fb_button_simple_rtl .fb_button_text{margin:0 10px 0 0}
a.fb_button_simple:hover .fb_button_text,
a.fb_button_simple_rtl:hover .fb_button_text,
.fb_button_simple:hover .fb_button_text,
.fb_button_simple_rtl:hover .fb_button_text{text-decoration:underline}
.fb_button,
.fb_button_rtl{background:#29447e url(http://static.ak.fbcdn.net/rsrc.php/v2/yl/x/FGFbc80dUKj.png);background-repeat:no-repeat;cursor:pointer;display:inline-block;padding:0 0 0 1px;text-decoration:none;outline:none}
.fb_button .fb_button_text,
.fb_button_rtl .fb_button_text{background:#5f78ab url(http://static.ak.fbcdn.net/rsrc.php/v2/yl/x/FGFbc80dUKj.png);border-top:solid 1px #879ac0;border-bottom:solid 1px #1a356e;color:#fff;display:block;font-family:"lucida grande",tahoma,verdana,arial,sans-serif;font-weight:bold;padding:2px 6px 3px 6px;margin:1px 1px 0 21px;text-shadow:none}
a.fb_button,
a.fb_button_rtl,
.fb_button,
.fb_button_rtl{text-decoration:none}
a.fb_button:active .fb_button_text,
a.fb_button_rtl:active .fb_button_text,
.fb_button:active .fb_button_text,
.fb_button_rtl:active .fb_button_text{border-bottom:solid 1px #29447e;border-top:solid 1px #45619d;background:#4f6aa3;text-shadow:none}
.fb_button_xlarge,
.fb_button_xlarge_rtl{background-position:left -60px;font-size:24px;line-height:30px}
.fb_button_xlarge .fb_button_text{padding:3px 8px 3px 12px;margin-left:38px}
a.fb_button_xlarge:active{background-position:left -99px}
.fb_button_xlarge_rtl{background-position:right -268px}
.fb_button_xlarge_rtl .fb_button_text{padding:3px 8px 3px 12px;margin-right:39px}
a.fb_button_xlarge_rtl:active{background-position:right -307px}
.fb_button_large,
.fb_button_large_rtl{background-position:left -138px;font-size:13px;line-height:16px}
.fb_button_large .fb_button_text{margin-left:24px;padding:2px 6px 4px 6px}
a.fb_button_large:active{background-position:left -163px}
.fb_button_large_rtl{background-position:right -346px}
.fb_button_large_rtl .fb_button_text{margin-right:25px}
a.fb_button_large_rtl:active{background-position:right -371px}
.fb_button_medium,
.fb_button_medium_rtl{background-position:left -188px;font-size:11px;line-height:14px}
a.fb_button_medium:active{background-position:left -210px}
.fb_button_medium_rtl{background-position:right -396px}
.fb_button_text_rtl,
.fb_button_medium_rtl .fb_button_text{padding:2px 6px 3px 6px;margin-right:22px}
a.fb_button_medium_rtl:active{background-position:right -418px}
.fb_button_small,
.fb_button_small_rtl{background-position:left -232px;font-size:10px;line-height:10px}
.fb_button_small .fb_button_text{padding:2px 6px 3px;margin-left:17px}
a.fb_button_small:active,
.fb_button_small:active{background-position:left -250px}
.fb_button_small_rtl{background-position:right -440px}
.fb_button_small_rtl .fb_button_text{padding:2px 6px;margin-right:18px}
a.fb_button_small_rtl:active{background-position:right -458px}
.fb_share_count_wrapper{position:relative;float:left}
.fb_share_count{background:#b0b9ec none repeat scroll 0 0;color:#333;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;text-align:center}
.fb_share_count_inner{background:#e8ebf2;display:block}
.fb_share_count_right{margin-left:-1px;display:inline-block}
.fb_share_count_right .fb_share_count_inner{border-top:solid 1px #e8ebf2;border-bottom:solid 1px #b0b9ec;margin:1px 1px 0 1px;font-size:10px;line-height:10px;padding:2px 6px 3px;font-weight:bold}
.fb_share_count_top{display:block;letter-spacing:-1px;line-height:34px;margin-bottom:7px;font-size:22px;border:solid 1px #b0b9ec}
.fb_share_count_nub_top{border:none;display:block;position:absolute;left:7px;top:35px;margin:0;padding:0;width:6px;height:7px;background-repeat:no-repeat;background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yP/x/bSOHtKbCGYI.png)}
.fb_share_count_nub_right{border:none;display:inline-block;padding:0;width:5px;height:10px;background-repeat:no-repeat;background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/x/i_oIVTKMYsL.png);vertical-align:top;background-position:right 5px;z-index:10;left:2px;margin:0 2px 0 0;position:relative}
.fb_share_no_count{display:none}
.fb_share_size_Small .fb_share_count_right .fb_share_count_inner{font-size:10px}
.fb_share_size_Medium .fb_share_count_right .fb_share_count_inner{font-size:11px;padding:2px 6px 3px;letter-spacing:-1px;line-height:14px}
.fb_share_size_Large .fb_share_count_right .fb_share_count_inner{font-size:13px;line-height:16px;padding:2px 6px 4px;font-weight:normal;letter-spacing:-1px}
.fb_share_count_hidden .fb_share_count_nub_top,
.fb_share_count_hidden .fb_share_count_top,
.fb_share_count_hidden .fb_share_count_nub_right,
.fb_share_count_hidden .fb_share_count_right{visibility:hidden}
.fb_connect_bar_container div,
.fb_connect_bar_container span,
.fb_connect_bar_container a,
.fb_connect_bar_container img,
.fb_connect_bar_container strong{background:none;border-spacing:0;border:0;direction:ltr;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal;vertical-align:baseline}
.fb_connect_bar_container{position:fixed;left:0 !important;right:0 !important;height:42px !important;padding:0 25px !important;margin:0 !important;vertical-align:middle !important;border-bottom:1px solid #333 !important;background:#3b5998 !important;z-index:99999999 !important;overflow:hidden !important}
.fb_connect_bar_container_ie6{position:absolute;top:expression(document.compatMode=="CSS1Compat"? document.documentElement.scrollTop+"px":body.scrollTop+"px")}
.fb_connect_bar{position:relative;margin:auto;height:100%;width:100%;padding:6px 0 0 0 !important;background:none;color:#fff !important;font-family:"lucida grande", tahoma, verdana, arial, sans-serif !important;font-size:13px !important;font-style:normal !important;font-variant:normal !important;font-weight:normal !important;letter-spacing:normal !important;line-height:1 !important;text-decoration:none !important;text-indent:0 !important;text-shadow:none !important;text-transform:none !important;white-space:normal !important;word-spacing:normal !important}
.fb_connect_bar a:hover{color:#fff}
.fb_connect_bar .fb_profile img{height:30px;width:30px;vertical-align:middle;margin:0 6px 5px 0}
.fb_connect_bar div a,
.fb_connect_bar span,
.fb_connect_bar span a{color:#bac6da;font-size:11px;text-decoration:none}
.fb_connect_bar .fb_buttons{float:right;margin-top:7px}
.fb_edge_widget_with_comment{position:relative;*z-index:1000}
.fb_edge_widget_with_comment span.fb_edge_comment_widget{position:absolute}
.fb_edge_widget_with_comment span.fb_send_button_form_widget{z-index:1}
.fb_edge_widget_with_comment span.fb_send_button_form_widget .FB_Loader{left:0;top:1px;margin-top:6px;margin-left:0;background-position:50% 50%;background-color:#fff;height:150px;width:394px;border:1px #666 solid;border-bottom:2px solid #283e6c;z-index:1}
.fb_edge_widget_with_comment span.fb_send_button_form_widget.dark .FB_Loader{background-color:#000;border-bottom:2px solid #ccc}
.fb_edge_widget_with_comment span.fb_send_button_form_widget.siderender
.FB_Loader{margin-top:0}
.fbpluginrecommendationsbarleft,
.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}
/* @noflip */
.fbpluginrecommendationsbarleft{left:10px}
/* @noflip */
.fbpluginrecommendationsbarright{right:10px}</style></head><body class="single single-post postid-16614 single-format-standard" data-twttr-rendered="true" style="margin-right: 160px;">  <script type="text/javascript">/*<![CDATA[*/if(window.WTOptimize && typeof wtObj != "undefined"){
    WTOptimize.setup(wtObj);
  }/*]]>*/</script>  <script type="text/javascript">if (!plus_member_logged_in()) {
  (function(){
    var bsa = document.createElement('script');
       bsa.type = 'text/javascript';
       bsa.async = true;
       bsa.src = '//s3.buysellads.com/ac/bsa.js';
    (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
  })();
}</script> <div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" scrolling="no" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tab-index="-1" style="border: none;" src="./Creating a Twitter OAuth Application   Nettuts+_files/xd_arbiter.htm"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" scrolling="no" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tab-index="-1" style="border: none;" src="./Creating a Twitter OAuth Application   Nettuts+_files/xd_arbiter(1).htm"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>  <script type="text/javascript">(function(){
  var fb = document.createElement('script');
  fb.type = 'text/javascript';
  fb.async = true;
  fb.src = document.location.protocol + '//connect.facebook.net/en_US/all.js#xfbml=1';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(fb);
})();</script> <div id="header_wrap"><div id="header"> <a href="http://net.tutsplus.com/" class="logo">Nettuts+</a><ul class="top_navigation"><li><a href="http://net.tutsplus.com/advertise/">Advertise</a></li><li><a href="http://net.tutsplus.com/about/write-a-tutorial/">Write for Us</a></li><li><a href="http://net.tutsplus.com/about/">About</a></li></ul><div class="search_form"><form method="get" action="http://net.tutsplus.com/"> <input type="text" class="submit_input" name="s" id="s" placeholder="Search..."> <input class="submit_button" type="submit" value="Search"></form></div><div id="navigation"><ul class="navigation"><li class="parent"><a href="http://net.tutsplus.com/category/tutorials/">Tutorials</a><ul class="child-nav"><li class="cat-item cat-item-568"><a href="http://net.tutsplus.com/category/tutorials/asp-net/" title="ASP.NET programming tutorials.">ASP.NET</a></li><li class="cat-item cat-item-464"><a href="http://net.tutsplus.com/category/tutorials/cmss/" title="Tutorials that details how to work with various CMSs.">CMSs</a></li><li class="cat-item cat-item-547"><a href="http://net.tutsplus.com/category/tutorials/databases/" title="Learn how to work more efficiently with databases.">Databases</a></li><li class="cat-item cat-item-286"><a href="http://net.tutsplus.com/category/tutorials/design-tutorials/" title="Learn the ins and outs of web design.">Design</a></li><li class="cat-item cat-item-8"><a href="http://net.tutsplus.com/category/tutorials/html-css-techniques/" title="Get up to speed with HTML and CSS.">HTML &amp; CSS</a></li><li class="cat-item cat-item-10"><a href="http://net.tutsplus.com/category/tutorials/javascript-ajax/" title="Learn about vanilla JavaScript, and the various popular libraries that are available, like jQuery.">JavaScript &amp; AJAX</a></li><li class="cat-item cat-item-153"><a href="http://net.tutsplus.com/category/tutorials/other/" title="View all posts filed under Other">Other</a></li><li class="cat-item cat-item-41"><a href="http://net.tutsplus.com/category/tutorials/php/" title="Learn how to use PHP.">PHP</a></li><li class="cat-item cat-item-1285"><a href="http://net.tutsplus.com/category/tutorials/python-tutorials/" title="View all posts filed under Python">Python</a></li><li class="cat-item cat-item-124"><a href="http://net.tutsplus.com/category/tutorials/ruby/" title="High quality Ruby and RoR tutorials and screencasts.">Ruby</a></li><li class="cat-item cat-item-7"><a href="http://net.tutsplus.com/category/tutorials/site-builds/" title="Learn how to convert a PSD to HTML from scratch.">Site Builds</a></li><li class="cat-item cat-item-29"><a href="http://net.tutsplus.com/category/tutorials/tools-and-tips/" title="Details the most popular tools when building web applications.">Tools &amp; Tips</a></li><li class="cat-item cat-item-35"><a href="http://net.tutsplus.com/category/tutorials/wordpress/" title="Become a WordPress master.">Wordpress</a></li></ul></li><li class="parent"><a href="http://net.tutsplus.com/category/articles/">Articles</a><ul class="child-nav"><li class="cat-item cat-item-1334"><a href="http://net.tutsplus.com/category/articles/editorials/" title="Opinion pieces on the web development arena. ">Editorials</a></li><li class="cat-item cat-item-128"><a href="http://net.tutsplus.com/category/articles/general/" title="Generic articles on web development.">General</a></li><li class="cat-item cat-item-127"><a href="http://net.tutsplus.com/category/articles/interviews/" title="Interviews with prominent developers in the web development industry.">Interviews</a></li><li class="cat-item cat-item-1084"><a href="http://net.tutsplus.com/category/articles/lectures/" title="Featured talks from web development conferences around the world.">Lectures</a></li><li class="cat-item cat-item-1"><a href="http://net.tutsplus.com/category/articles/news/" title="Recent news in the web development industry.">News</a></li><li class="cat-item cat-item-1251"><a href="http://net.tutsplus.com/category/articles/quizzes/" title="Quizzes to check your knowledge.">Quizzes</a></li><li class="cat-item cat-item-437"><a href="http://net.tutsplus.com/category/articles/reviews/" title="Reviews of new web apps, frameworks, and books.">Reviews</a></li><li class="cat-item cat-item-1379"><a href="http://net.tutsplus.com/category/articles/roundups-articles/" title="Compilations of tools, frameworks and other assorted stuff.">Roundups</a></li><li class="cat-item cat-item-23"><a href="http://net.tutsplus.com/category/articles/web-roundups/" title="Compilations of popular articles from around the web.">Web Roundups</a></li></ul></li><li class="parent"><a href="http://net.tutsplus.com/tag/tips/">Tips</a><ul class="child-nav"><li><a href="http://net.tutsplus.com/category/articles/?tag=tips" title="Articles">Articles</a></li><li><a href="http://net.tutsplus.com/category/tutorials/tools-and-tips/?tag=tips" title="Tools &amp; Tips">Tools &amp; Tips</a></li><li><a href="http://net.tutsplus.com/category/tutorials/javascript-ajax/?tag=tips" title="JavaScript &amp; AJAX">JavaScript &amp; AJAX</a></li><li><a href="http://net.tutsplus.com/category/tutorials/other/?tag=tips" title="Other">Other</a></li><li><a href="http://net.tutsplus.com/category/tutorials/php/?tag=tips" title="PHP">PHP</a></li><li><a href="http://net.tutsplus.com/category/tutorials/?tag=tips" title="Tutorials">Tutorials</a></li></ul></li><li><a href="http://net.tutsplus.com/sessions/">Sessions</a></li><li class="parent"><a href="http://net.tutsplus.com/tag/videos/">Videos</a><ul class="child-nav"><li><a href="http://net.tutsplus.com/category/tutorials/php/?tag=videos" title="PHP">PHP</a></li><li><a href="http://net.tutsplus.com/category/tutorials/javascript-ajax/?tag=videos" title="JavaScript &amp; AJAX">JavaScript &amp; AJAX</a></li><li><a href="http://net.tutsplus.com/category/tutorials/tools-and-tips/?tag=videos" title="Tools &amp; Tips">Tools &amp; Tips</a></li><li><a href="http://net.tutsplus.com/category/articles/news/?tag=videos" title="News">News</a></li></ul></li><li id="nav-premium-link"> <a href="http://tutsplus.com/courses/?q=true&filter_topic=35" target="_blank">Tuts+ Premium</a></li></ul></div><div class="site_switcher"><ul><li class="link-hub"><a href="http://hub.tutsplus.com/">Tuts+ Hub <span>The Latest Tuts+ Updates</span></a></li><li class="link-psd"><a href="http://psd.tutsplus.com/">Psdtuts+ <span>Adobe Photoshop</span></a></li><li class="link-net"><a href="http://net.tutsplus.com/">Nettuts+ <span>Web Development</span></a></li><li class="link-vector"><a href="http://vector.tutsplus.com/">Vectortuts+ <span>Illustrator and Vector</span></a></li><li class="link-audio"><a href="http://audio.tutsplus.com/">Audiotuts+ <span>Audio and Production</span></a></li><li class="link-ae"><a href="http://ae.tutsplus.com/">Aetuts+ <span>Adobe After Effects</span></a></li><li class="link-cg"><a href="http://cg.tutsplus.com/">Cgtuts+ <span>Computer Graphics</span></a></li><li class="link-photo"><a href="http://photo.tutsplus.com/">Phototuts+ <span>Photography</span></a></li><li class="link-mobile"><a href="http://mobile.tutsplus.com/">Mobiletuts+ <span>Mobile Development</span></a></li><li class="link-webdesign"><a href="http://webdesign.tutsplus.com/">Webdesigntuts+ <span>Web Design</span></a></li><li class="link-wp"><a href="http://wp.tutsplus.com/">Wptuts+ <span>WordPress</span></a></li><li class="link-mac"><a href="http://mac.tutsplus.com/">Mactuts+ <span>Mac &amp; OS X</span></a></li><li class="link-gamedev"><a href="http://gamedev.tutsplus.com/">Gamedevtuts+ <span>Game Development</span></a></li><li class="link-craft"><a href="http://craft.tutsplus.com/">Crafttuts+ <span>Craft &amp; Handmade</span></a></li></ul> <a href="javascript:void(0);" class="site_switcher_button">Toggle</a></div><div class="header-marketplace-ad ad-themeforest"><a href="http://themeforest.net/?WT.mc_id=TutsHeader&ref=NetPremium" rel="nofollow external" target="_blank"><span>&nbsp;</span>Website Templates</a></div></div></div><div id="content_wrap"><div id="content" class="clearfix"><div class="page_wrap"><div id="leader-board-wrap" style=""><div class="leader_board"> <a href="http://net.tutsplus.com/advertise/" class="LB_advert">Advertise Here</a><div class="lb_inner"><div id="bsap_1245834" class="bsap_1245834 bsap"><div id="wrapper10" style="width: 728px; margin-left: 0px; padding: 0px; display: inline-block; overflow: hidden;"><div id="img10" style="height: 90px; overflow: hidden; font-size: 16px; color: white; padding: 0px; display: inline-block; min-width: 728px;" replaced="true"><object type="application/x-shockwave-flash" style="margin-top: 0px; margin-bottom: 0px; visibility: visible;" data="http://cloud.bannergadgets.com/v07/BannerGadgets_728x90.swf" width="728" height="90" id="img10child"><param name="menu" value="false"><param name="allowScriptAccess" value="always"><param name="allowfullscreen" value="true"><param name="wmode" value="transparent"><param name="flashvars" value="url=http://cloud.bannergadgets.com/v07/&amp;guid=b42ebe9c-061c-4f1e-adf4-c381dbc5b7fa&amp;app=RelatedTopics&amp;index=1&amp;number=0&amp;connectionId=13602754008720.8093835420440882&amp;appCount=1&amp;extMode=v9"></object></div></div></div></div></div></div> <script type="text/javascript">if (!plus_member_logged_in()) {
    $('#leader-board-wrap').show()
  }</script> <div id="page" class="single_post"><div class="page_inner"><div class="post post_inner" id="post-16614"><div class="tut_top"><div class="post_image"> <a href="./Creating a Twitter OAuth Application   Nettuts+_files/Creating a Twitter OAuth Application   Nettuts+.htm"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/preview.jpg" alt="Creating a Twitter OAuth Application" width="200" height="200" original="http://d2o0t5hpnwv4c1.cloudfront.net/861_twitterOAuth/preview.jpg"></a></div><div class="preview"><div class="post_taxonomy"><ul><li><a href="http://net.tutsplus.com/category/tutorials/">Tutorials</a><span>\</span></li><li><a href="http://net.tutsplus.com/category/tutorials/php/">PHP</a></li></ul><div id="tuts-rating" class=""><p><span> \</span>Rating:</p><ul id="">  <li><a href="javascript:void(0)" class="rate-this one active">1</a></li>  <li><a href="javascript:void(0)" class="rate-this two active">2</a></li>  <li><a href="javascript:void(0)" class="rate-this three active">3</a></li>  <li><a href="javascript:void(0)" class="rate-this four active">4</a></li>  <li><a href="javascript:void(0)" class="rate-this five active half">5</a></li></ul></div></div><h1 class="post_title"> Creating a Twitter OAuth Application</h1><div class="post_meta"> <a href="http://net.tutsplus.com/author/steveguidetti/" title="Posts by Steve Guidetti" rel="author">Steve Guidetti</a> on Nov 29th 2010 with <a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#disqus_thread" title="Comment on Creating a Twitter OAuth Application" data-disqus-identifier="16614 http://net.tutsplus.com/?p=16614">36 Comments and 0 Reactions</a></div></div></div></div><div class="tut_bottom"><div class="tutorial_details"><h5>Tutorial Details</h5><ul><li></li><li><strong>Topic:</strong> PHP</li><li><strong>Difficulty:</strong> Advanced</li><li><strong>Estimated Completion Time:</strong> 1 hour</li></ul></div><div class="article_social_media"><div class="tweetmeme_btn"> <iframe allowtransparency="true" frameborder="0" scrolling="no" src="./Creating a Twitter OAuth Application   Nettuts+_files/tweet_button.1359159993.htm" class="twitter-share-button twitter-count-none" style="width: 59px; height: 20px;" title="Twitter Tweet Button" data-twttr-rendered="true"></iframe><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/widgets.js"></script> </div><div class="facebook_send_btn"> <div style="height: 20px; width: 32px; display: inline-block; text-indent: 0px; margin: 0px; padding: 0px; background-color: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; background-position: initial initial; background-repeat: initial initial;" id="___plusone_0"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I0_1360275387930" name="I0_1360275387930" src="./Creating a Twitter OAuth Application   Nettuts+_files/fastbutton.htm" allowtransparency="true" data-gapiattached="true" title="+1"></iframe></div></div><div class="facebook_btn"> <fb:like layout="button_count" width="90" height="21" fb-xfbml-state="rendered" class="fb_edge_widget_with_comment fb_iframe_widget"><span style="height: 20px; width: 71px;"><iframe id="f3c0cff21c" name="f7bcc73dc" scrolling="no" style="border: none; overflow: hidden; height: 20px; width: 71px;" title="Like this content on Facebook." class="fb_ltr" src="./Creating a Twitter OAuth Application   Nettuts+_files/like.htm"></iframe></span></fb:like></div></div></div><div class="post post_inner_article"><div class="download_wrap"><div class="big_btn"> <a href="http://nettuts.s3.amazonaws.com/861_twitterOAuth/src.zip" rel="external" target="_blank"><span>Download</span> <small>Source Files</small></a></div><div class="big_btn"> <a href="http://dev.ultramegatech.com/twitteravatars/" rel="external" target="_blank"><span>Demo</span> <small>View It Online</small></a></div></div> <script type="text/javascript">/*<![CDATA[*///
(function($) { $(function() { WpPostRatings({context: $('#post-16614'), post_id: 16614, rpc: 'http://net.tutsplus.com/wp-admin/admin-ajax.php', base_url: 'http://net.tutsplus.com', allow_voting: true}).init() })})(jQuery)
//]]&gt;/*]]>*/</script><p>OAuth can be a tricky concept to wrap your head around at first, but with the Twitter API now requiring its use, it is something you need to understand before creating a Twitter application. This tutorial will introduce you to OAuth, and walk you through the process of creating a basic application.</p><p><span id="more-16614"></span></p><hr><h2>Introduction</h2><p>In this tutorial, we will be building a simple app that allows users to apply different effects to their Twitter avatar. In order to work with the Twitter API, we must use OAuth to authorize our app to make requests on the user’s behalf.</p><p>Our application flow will be something like this:</p><ol><li>The user is asked to connect with Twitter.</li><li>The user is presented a list of preview avatars to select from.</li><li>Upon selection, the user is presented a confirmation screen showing the original and new avatar for comparison. The user is also offered an option to send a tweet.</li><li>After the user confirms, the app creates and uploads the modified avatar to Twitter and a success page is displayed.</li></ol><hr><h2>Setup</h2><p>To start, we should set up our source directory. We need a <code>lib</code> directory for our PHP library (class) files, a <code>tmp</code> directory to keep temporary files (this needs to writable by the server), a <code>css</code> directory for our style sheet, and an <code>img</code> directory for any images.</p><p>Here’s what your directory tree should look like:</p><ul><li>tutorial<ul><li>css</li><li>img</li><li>lib</li><li>tmp (writable)</li></ul></li></ul><hr><h2>Register Your Application</h2><p>In order to use OAuth, you’ll need what is called a consumer key and secret to identify your app. To obtain these, you must register an application with Twitter by following these steps.</p><p><a href="http://dev.twitter.com/apps/new" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">Go to the registration page</a>, logging in if necessary. You’ll be greeted by the form pictured below:</p><div class="tutorial_image"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/register.png" border="0" original="http://d2o0t5hpnwv4c1.cloudfront.net/861_twitterOAuth/register.png" style="display: inline-block;"></div><p>Fill out the form with details pertaining to your app. In our case, the <em>Application Type</em> is <strong>Browser</strong> and we need to set a default <em>Callback URL</em>. This URL can be anything as long as it is a valid format. We will be overriding the callback within our code, so it isn’t critical that it is a real URL. The <em>Default Access type</em> should be <strong>Read &amp; Write</strong> for convenience.</p><p>Once you register and accept the terms, you’ll be presented with information on your new application. The important details we need are the <em>Consumer key</em> and <em>Consumer secret</em>, which should look something like this:</p><div class="tutorial_image"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/key.png" border="0" original="http://d2o0t5hpnwv4c1.cloudfront.net/861_twitterOAuth/key.png" style="display: inline-block;"></div><hr><h2>Download the tmhOAuth Library</h2><p>We will be making use of a library to handle all the details behind making OAuth requests. In this tutorial, we will be using @themattharris’ <a href="http://github.com/themattharris/tmhOAuth" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;github.com&#39;]);" target="_blank">tmhOAuth</a> library, which supports file uploading.</p><ol><li><a href="http://github.com/themattharris/tmhOAuth/archives/master" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;github.com&#39;]);" target="_blank">Download tmhOAuth from GitHub</a></li><li>Extract <strong>tmhOAuth.php</strong> to the <strong>lib</strong> directory we created earlier</li></ol><hr><h2>Authentication</h2><p>Authentication with OAuth is basically a three step process. For a more in depth explanation, see this <a href="http://dev.twitter.com/pages/auth#intro" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">page on authentication</a> at Twitter, but here is a summary:</p><ol><li>App obtains a request token: The first step is for our app to identify itself to Twitter (using its consumer key) and obtain a <em>request token</em>. We’ll need to save this request token for later.</li><li>User authorizes app on Twitter: The user now needs to be sent to Twitter in order to grant our app access to their account. After that, the user is sent back to the callback URL specified by the app.</li><li>App exchanges request token for access token: Now that our app has been approved, it can exchange the request token from step 1 for an <em>access token</em>. Once we have the access token, our app is free to interact with the Twitter API on the user’s behalf.</li></ol><p>So let’s get started with some code. We’ll handle all authentication tasks in a class called <code>TwitterApp</code>. Start with the following code in a new file called <code>lib/TwitterApp.php</code>:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">class</span><span>&nbsp;TwitterApp&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;variable&nbsp;holds&nbsp;the&nbsp;tmhOAuth&nbsp;object&nbsp;used&nbsp;throughout&nbsp;the&nbsp;class</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;tmhOAuth&nbsp;An&nbsp;object&nbsp;of&nbsp;the&nbsp;tmhOAuth&nbsp;class</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="vars">$tmhOAuth</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;User's&nbsp;Twitter&nbsp;account&nbsp;data</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array&nbsp;Information&nbsp;on&nbsp;the&nbsp;current&nbsp;authenticated&nbsp;user</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="vars">$userdata</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Authentication&nbsp;state</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Values:</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;-&nbsp;0:&nbsp;not&nbsp;authed</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;-&nbsp;1:&nbsp;Request&nbsp;token&nbsp;obtained</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;-&nbsp;2:&nbsp;Access&nbsp;token&nbsp;obtained&nbsp;(authed)</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;int&nbsp;The&nbsp;current&nbsp;state&nbsp;of&nbsp;authentication</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="vars">$state</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Initialize&nbsp;a&nbsp;new&nbsp;TwitterApp&nbsp;object</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;tmhOAuth&nbsp;$tmhOAuth&nbsp;A&nbsp;tmhOAuth&nbsp;object&nbsp;with&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;&nbsp;__construct(tmhOAuth&nbsp;</span><span class="vars">$tmhOAuth</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;tmhOAuth&nbsp;object</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth&nbsp;=&nbsp;</span><span class="vars">$tmhOAuth</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">&lt;?php
class TwitterApp {
    /**
     * This variable holds the tmhOAuth object used throughout the class
     *
     * @var tmhOAuth An object of the tmhOAuth class
     */
    public $tmhOAuth;
    /**
     * User's Twitter account data
     *
     * @var array Information on the current authenticated user
     */
    public $userdata;
    /**
     * Authentication state
     *
     * Values:
     *  - 0: not authed
     *  - 1: Request token obtained
     *  - 2: Access token obtained (authed)
     *
     * @var int The current state of authentication
     */
    protected $state;
    /**
     * Initialize a new TwitterApp object
     *
     * @param tmhOAuth $tmhOAuth A tmhOAuth object with consumer key and secret
     */
    public function  __construct(tmhOAuth $tmhOAuth) {
        // save the tmhOAuth object
        $this-&gt;tmhOAuth = $tmhOAuth;
    }
}</pre><p>Here we’ve created three properties and a simple constructor. The <code>$tmhOAuth</code> property will be a tmhOAuth object, which will be used throughout the class. The <code>$userdata</code> property will hold an object containing info on the user such as their Twitter user name and status. The <code>$state</code> property keeps track of the current state of authentication.</p><p>The constructor simply accepts a tmhOAuth object and assigns it to the <code>$tmhOAuth</code> property.</p><hr><h2> <span>Step 1:</span> Get a Request Token</h2><p>Here is the method to obtain a request token:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Obtain&nbsp;a&nbsp;request&nbsp;token&nbsp;from&nbsp;Twitter</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;False&nbsp;if&nbsp;request&nbsp;failed</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getRequestToken()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;send&nbsp;request&nbsp;for&nbsp;a&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/request_token"</span><span>,&nbsp;</span><span class="string">""</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;pass&nbsp;a&nbsp;variable&nbsp;to&nbsp;set&nbsp;the&nbsp;callback</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'oauth_callback'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;php_self()&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;));&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;and&nbsp;store&nbsp;the&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$response</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;extract_params(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"response"</span><span>]);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authtoken"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token"</span><span>];&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authsecret"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token_secret"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;state&nbsp;is&nbsp;now&nbsp;1</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;redirect&nbsp;the&nbsp;user&nbsp;to&nbsp;Twitter&nbsp;to&nbsp;authorize</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$url</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/authorize"</span><span>,&nbsp;</span><span class="string">""</span><span>)&nbsp;.&nbsp;</span><span class="string">'?oauth_token='</span><span>&nbsp;.&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header("Location:&nbsp;'&nbsp;.&nbsp;<span class="vars">$url</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="func">exit</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;false;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Obtain a request token from Twitter
 *
 * @return bool False if request failed
 */
private function getRequestToken() {
    // send request for a request token
    $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("oauth/request_token", ""), array(
        // pass a variable to set the callback
        'oauth_callback'    =&gt; $this-&gt;tmhOAuth-&gt;php_self()
    ));
    if($this-&gt;tmhOAuth-&gt;response["code"] == 200) {
        // get and store the request token
        $response = $this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);
        $_SESSION["authtoken"] = $response["oauth_token"];
        $_SESSION["authsecret"] = $response["oauth_token_secret"];
        // state is now 1
        $_SESSION["authstate"] = 1;
        // redirect the user to Twitter to authorize
        $url = $this-&gt;tmhOAuth-&gt;url("oauth/authorize", "") . '?oauth_token=' . $response["oauth_token"];
        header("Location: ' . $url);
        exit;
    }
    return false;
}</pre><p>To understand the first part, you need to know about the <code>tmhOAuth::request()</code> method. This method allows us to make an OAuth enabled HTTP request, and it has the following usage:</p><p><code>tmhOAuth::request($method, $url[, $params[, $useauth[, $multipart]]])</code></p><ul><li><code>string $method</code> – The request method to use (GET, POST, etc.)</li><li><code>string $url</code> – The URL to access</li><li><code>array $params</code> (optional) – Associative array of parameters to include in the request</li><li><code>bool $useauth</code> (optional, default true) – Is authentication required?</li><li><code>bool $multipart</code> (optional, default false) – Set to true for file uploads</li></ul><p>For the <code>$url</code> parameter, we make use of the <code>tmhOAuth::url()</code> method to craft a URL based on the API method we are calling:</p><p><code>tmhOAuth::url($request[, $format])</code></p><ul><li><code>string $request </code>- The api method (without extension)</li><li><code>string $format </code>(optional, default ‘json”) – The desired response format (JSON, XML, etc.)</li></ul><p>Now that you are familiar with those methods, we must make a POST request to the <a href="http://dev.twitter.com/doc/post/oauth/request_token" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">oauth/request_token</a> API method. This will return OAuth data in a special format, so we need to set the format to blank when we use the <code>tmhOAuth::url()</code> method. We also need to pass a variable called <code>oauth_callback</code>, which is where the user will return after authorizing at Twitter. We will use the <code>tmhOAuth::php_self()</code> method to refer to the current page. Here is that code again:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;send&nbsp;request&nbsp;for&nbsp;a&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/request_token"</span><span>,&nbsp;</span><span class="string">""</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;pass&nbsp;a&nbsp;variable&nbsp;to&nbsp;set&nbsp;the&nbsp;callback</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'oauth_callback'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;php_self()&nbsp;&nbsp;</span></span></li><li class="alt"><span>));&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// send request for a request token
$this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("oauth/request_token", ""), array(
    // pass a variable to set the callback
    'oauth_callback'    =&gt; $this-&gt;tmhOAuth-&gt;php_self()
));</pre><p>Once we make the request, the response is stored as an array in the <code>tmhOAuth::response</code> property, with the following key pieces of data:</p><ul><li><code>code</code> – The HTTP response code</li><li><code>response</code> – The actual data returned</li><li><code>headers</code> – The response headers</li></ul><p>So the next part of our code checks the response code (200 means success), and then places the <code>oauth_token</code> and <code>oauth_token_secret</code> that we received into session variables since we’ll need them later. These are extracted from the response data using the <code>tmhOAuth::extract_params()</code> method, which returns an array of data contained in the response. We also set an <code>authstate</code> session variable to signal that we are on the next stage of authentication. Here is the code:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;and&nbsp;store&nbsp;the&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$response</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;extract_params(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"response"</span><span>]);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authtoken"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authsecret"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token_secret"</span><span>];&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;state&nbsp;is&nbsp;now&nbsp;1</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">if($this-&gt;tmhOAuth-&gt;response["code"] == 200) {
    // get and store the request token
    $response = $this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);
    $_SESSION["authtoken"] = $response["oauth_token"];
    $_SESSION["authsecret"] = $response["oauth_token_secret"];
    // state is now 1
    $_SESSION["authstate"] = 1;
}</pre><p>After that is done, we must now redirect the user to the <a href="http://dev.twitter.com/doc/get/oauth/authorize" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">oauth/authorize</a> URL, including the <code>oauth_token</code> in a GET parameter. Here is that code again:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;redirect&nbsp;the&nbsp;user&nbsp;to&nbsp;Twitter&nbsp;to&nbsp;authorize</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$url</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/authorize"</span><span>,&nbsp;</span><span class="string">""</span><span>)&nbsp;.&nbsp;</span><span class="string">'?oauth_token='</span><span>&nbsp;.&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>header("Location:&nbsp;'&nbsp;.&nbsp;<span class="vars">$url</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span><span class="func">exit</span><span>;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// redirect the user to Twitter to authorize
$url = $this-&gt;tmhOAuth-&gt;url("oauth/authorize", "") . '?oauth_token=' . $response["oauth_token"];
header("Location: ' . $url);
exit;</pre><hr><h2> <span>Step 2:</span> Get an Access Token</h2><p>Here is the method to exchange our request token for an access token:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Obtain&nbsp;an&nbsp;access&nbsp;token&nbsp;from&nbsp;Twitter</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;False&nbsp;if&nbsp;request&nbsp;failed</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getAccessToken()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;set&nbsp;the&nbsp;request&nbsp;token&nbsp;and&nbsp;secret&nbsp;we&nbsp;have&nbsp;stored</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config[</span><span class="string">"user_token"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authtoken"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config[</span><span class="string">"user_secret"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authsecret"</span><span>];&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;send&nbsp;request&nbsp;for&nbsp;an&nbsp;access&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/access_token"</span><span>,&nbsp;</span><span class="string">""</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;pass&nbsp;the&nbsp;oauth_verifier&nbsp;received&nbsp;from&nbsp;Twitter</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'oauth_verifier'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;</span><span class="vars">$_GET</span><span>[</span><span class="string">"oauth_verifier"</span><span>]&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;));&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;access&nbsp;token&nbsp;and&nbsp;store&nbsp;it&nbsp;in&nbsp;a&nbsp;cookie</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$response</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;extract_params(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"response"</span><span>]);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token"</span><span>,&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token"</span><span>],&nbsp;time()+3600*24*30);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token_secret"</span><span>,&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token_secret"</span><span>],&nbsp;time()+3600*24*30);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;state&nbsp;is&nbsp;now&nbsp;2</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;redirect&nbsp;user&nbsp;to&nbsp;clear&nbsp;leftover&nbsp;GET&nbsp;variables</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header("Location:&nbsp;'&nbsp;.&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;php_self());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="func">exit</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;false;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Obtain an access token from Twitter
 *
 * @return bool False if request failed
 */
private function getAccessToken() {
    // set the request token and secret we have stored
    $this-&gt;tmhOAuth-&gt;config["user_token"] = $_SESSION["authtoken"];
    $this-&gt;tmhOAuth-&gt;config["user_secret"] = $_SESSION["authsecret"];
    // send request for an access token
    $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("oauth/access_token", ""), array(
        // pass the oauth_verifier received from Twitter
        'oauth_verifier'    =&gt; $_GET["oauth_verifier"]
    ));
    if($this-&gt;tmhOAuth-&gt;response["code"] == 200) {
        // get the access token and store it in a cookie
        $response = $this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);
        setcookie("access_token", $response["oauth_token"], time()+3600*24*30);
        setcookie("access_token_secret", $response["oauth_token_secret"], time()+3600*24*30);
        // state is now 2
        $_SESSION["authstate"] = 2;
        // redirect user to clear leftover GET variables
        header("Location: ' . $this-&gt;tmhOAuth-&gt;php_self());
        exit;
    }
    return false;
}</pre><p>The first thing we do is set the <code>user_token</code> and <code>user_secret</code> in the <code>tmhOAuth::config</code> array to the request token we obtained earlier.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;set&nbsp;the&nbsp;request&nbsp;token&nbsp;and&nbsp;secret&nbsp;we&nbsp;have&nbsp;stored</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config[</span><span class="string">"user_token"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authtoken"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config[</span><span class="string">"user_secret"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authsecret"</span><span>];&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// set the request token and secret we have stored
$this-&gt;tmhOAuth-&gt;config["user_token"] = $_SESSION["authtoken"];
$this-&gt;tmhOAuth-&gt;config["user_secret"] = $_SESSION["authsecret"];</pre><p>The next part is where we make a POST request to <a href="http://dev.twitter.com/doc/post/oauth/access_token" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">oauth/access_token</a>. We pass the <code>oauth_verifier</code> we received in a GET variable as a parameter in this request.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;send&nbsp;request&nbsp;for&nbsp;an&nbsp;access&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/access_token"</span><span>,&nbsp;</span><span class="string">""</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;pass&nbsp;the&nbsp;oauth_verifier&nbsp;received&nbsp;from&nbsp;Twitter</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'oauth_verifier'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;</span><span class="vars">$_GET</span><span>[</span><span class="string">"oauth_verifier"</span><span>]&nbsp;&nbsp;</span></span></li><li class="alt"><span>));&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// send request for an access token
$this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("oauth/access_token", ""), array(
    // pass the oauth_verifier received from Twitter
    'oauth_verifier'    =&gt; $_GET["oauth_verifier"]
));</pre><p>Twitter will respond with an access token and secret, which we’ll need to save for any future requests. So the next chunk of code takes these and saves each in a cookie, then sets the state to 2.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;access&nbsp;token&nbsp;and&nbsp;store&nbsp;it&nbsp;in&nbsp;a&nbsp;cookie</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$response</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;extract_params(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"response"</span><span>]);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token"</span><span>,&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token"</span><span>],&nbsp;time()+3600*24*30);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token_secret"</span><span>,&nbsp;</span><span class="vars">$response</span><span>[</span><span class="string">"oauth_token_secret"</span><span>],&nbsp;time()+3600*24*30);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;state&nbsp;is&nbsp;now&nbsp;2</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;redirect&nbsp;user&nbsp;to&nbsp;clear&nbsp;leftover&nbsp;GET&nbsp;variables</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;header("Location:&nbsp;'&nbsp;.&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;php_self());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="func">exit</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">if($this-&gt;tmhOAuth-&gt;response["code"] == 200) {
    // get the access token and store it in a cookie
    $response = $this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);
    setcookie("access_token", $response["oauth_token"], time()+3600*24*30);
    setcookie("access_token_secret", $response["oauth_token_secret"], time()+3600*24*30);
    // state is now 2
    $_SESSION["authstate"] = 2;
    // redirect user to clear leftover GET variables
    header("Location: ' . $this-&gt;tmhOAuth-&gt;php_self());
    exit;
}</pre><p>The redirect at the end is there to clear the URL parameters left by Twitter, and allows the cookies to take effect.</p><hr><h2> <span>Step 3:</span> Verify the Access Token</h2><p>With our access token obtained, we should check to make sure it is valid. Here is the method to do that:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Verify&nbsp;the&nbsp;validity&nbsp;of&nbsp;our&nbsp;access&nbsp;token</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Access&nbsp;token&nbsp;verified</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;verifyAccessToken()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config[</span><span class="string">"user_token"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token"</span><span>];&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config[</span><span class="string">"user_secret"</span><span>]&nbsp;=&nbsp;</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token_secret"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;send&nbsp;verification&nbsp;request&nbsp;to&nbsp;test&nbsp;access&nbsp;key</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"GET"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/account/verify_credentials"</span><span>));&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;store&nbsp;the&nbsp;user&nbsp;data&nbsp;returned&nbsp;from&nbsp;the&nbsp;API</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;userdata&nbsp;=&nbsp;json_decode(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"response"</span><span>]);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;HTTP&nbsp;200&nbsp;means&nbsp;we&nbsp;were&nbsp;successful</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200);&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Verify the validity of our access token
 *
 * @return bool Access token verified
 */
private function verifyAccessToken() {
    $this-&gt;tmhOAuth-&gt;config["user_token"] = $_COOKIE["access_token"];
    $this-&gt;tmhOAuth-&gt;config["user_secret"] = $_COOKIE["access_token_secret"];
    // send verification request to test access key
    $this-&gt;tmhOAuth-&gt;request("GET", $this-&gt;tmhOAuth-&gt;url("1/account/verify_credentials"));
    // store the user data returned from the API
    $this-&gt;userdata = json_decode($this-&gt;tmhOAuth-&gt;response["response"]);
    // HTTP 200 means we were successful
    return ($this-&gt;tmhOAuth-&gt;response["code"] == 200);
}</pre><p>This code should look pretty familiar by now. All we do here is set the <code>user_token</code> and <code>user_secret</code> and make a GET request to <a href="http://dev.twitter.com/doc/get/account/verify_credentials" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">1/account/verify_credentials</a>. If Twitter responds with a 200 code, then the access token is valid.</p><p>Another detail to note is that this is where we populate the <code>$userdata</code> property with the data returned by this Twitter request. The data is in the JSON format, so we use <code>json_decode()</code> to convert it to a PHP object. Here’s that line again:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;store&nbsp;the&nbsp;user&nbsp;data&nbsp;returned&nbsp;from&nbsp;the&nbsp;API</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$this</span><span>-&gt;userdata&nbsp;=&nbsp;json_decode(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"response"</span><span>]);&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// store the user data returned from the API
$this-&gt;userdata = json_decode($this-&gt;tmhOAuth-&gt;response["response"]);</pre><hr><h2> <span>Step 4:</span> Tie Everything Together</h2><p>With our OAuth components in place, it is time to tie everything together. We need a public facing method to allow our client code to start the authentication process, and here it is:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Authenticate&nbsp;user&nbsp;with&nbsp;Twitter</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Authentication&nbsp;successful</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;auth()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;state&nbsp;1&nbsp;requires&nbsp;a&nbsp;GET&nbsp;variable&nbsp;to&nbsp;exist</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1&nbsp;&amp;&amp;&nbsp;!isset(</span><span class="vars">$_GET</span><span>[</span><span class="string">"oauth_verifier"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Step&nbsp;1:&nbsp;Get&nbsp;a&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;0)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;getRequestToken();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Step&nbsp;2:&nbsp;Get&nbsp;an&nbsp;access&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;getAccessToken();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Step&nbsp;3:&nbsp;Verify&nbsp;the&nbsp;access&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;verifyAccessToken();&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Authenticate user with Twitter
 *
 * @return bool Authentication successful
 */
public function auth() {
    // state 1 requires a GET variable to exist
    if($this-&gt;state == 1 &amp;&amp; !isset($_GET["oauth_verifier"])) {
        $this-&gt;state = 0;
    }
    // Step 1: Get a request token
    if($this-&gt;state == 0) {
        return $this-&gt;getRequestToken();
    }
    // Step 2: Get an access token
    elseif($this-&gt;state == 1) {
        return $this-&gt;getAccessToken();
    }
    // Step 3: Verify the access token
    return $this-&gt;verifyAccessToken();
}</pre><p>Most of the <code>auth()</code> method should be self-explanatory. Based on the state, it executes the appropriate method for that stage of authentication. If the state is 1, an <code>oauth_verifier</code> GET variable should exists, so the method also checks that.</p><p>We should now create a public method to find out if we are authenticated. This <code>isAuthed()</code> method returns true if the state is 2:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Check&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;authentication</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;True&nbsp;if&nbsp;state&nbsp;is&nbsp;2&nbsp;(authenticated)</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;isAuthed()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;2;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Check the current state of authentication
 *
 * @return bool True if state is 2 (authenticated)
 */
public function isAuthed() {
    return $this-&gt;state == 2;
}</pre><p>We can also use a method to remove the user’s authentication. This <code>endSession()</code> method sets the state to 0 and removes the cookies containing the access token:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Remove&nbsp;user's&nbsp;access&nbsp;token&nbsp;cookies</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;endSession()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token"</span><span>,&nbsp;</span><span class="string">""</span><span>,&nbsp;0);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token_secret"</span><span>,&nbsp;</span><span class="string">""</span><span>,&nbsp;0);&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Remove user's access token cookies
 */
public function endSession() {
    $this-&gt;state = 0;
    $_SESSION["authstate"] = 0;
    setcookie("access_token", "", 0);
    setcookie("access_token_secret", "", 0);
}</pre><hr><h2>Initialization</h2><p>Now we need to add some things to our <code>__construct()</code> method to figure out which authentication state the application is in upon initialization. Also, since our code uses session variables, we should make sure the session is started with this code:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;start&nbsp;a&nbsp;session&nbsp;if&nbsp;one&nbsp;does&nbsp;not&nbsp;exist</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(!session_id())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;session_start();&nbsp;&nbsp;</span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// start a session if one does not exist
if(!session_id()) {
    session_start();
}</pre><p>This next part is where we determine the state. State starts at 0; if there are cookies set containing an access token, state is assumed to be 2; failing that, the state is set to the <code>authstate</code> session variable if it exists. Here is the code:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;determine&nbsp;the&nbsp;authentication&nbsp;status</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="comment">//&nbsp;default&nbsp;to&nbsp;0</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="comment">//&nbsp;2&nbsp;(authenticated)&nbsp;if&nbsp;the&nbsp;cookies&nbsp;are&nbsp;set</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">if</span><span>(isset(</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token"</span><span>],&nbsp;</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token_secret"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;otherwise&nbsp;use&nbsp;value&nbsp;stored&nbsp;in&nbsp;session</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">elseif</span><span>(isset(</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;(int)</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// determine the authentication status
// default to 0
$this-&gt;state = 0;
// 2 (authenticated) if the cookies are set
if(isset($_COOKIE["access_token"], $_COOKIE["access_token_secret"])) {
    $this-&gt;state = 2;
}
// otherwise use value stored in session
elseif(isset($_SESSION["authstate"])) {
    $this-&gt;state = (int)$_SESSION["authstate"];
}</pre><p>If the state is 1, that means we are in the process of authentication. So we can go ahead and continue the process at this point:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;if&nbsp;we&nbsp;are&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;authentication&nbsp;we&nbsp;continue</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;auth();&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// if we are in the process of authentication we continue
if($this-&gt;state == 1) {
    $this-&gt;auth();
}</pre><p>If the state is 2, we should verify the access token. If authentication fails, this code clears the cookies and resets the state:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;verify&nbsp;authentication,&nbsp;clearing&nbsp;cookies&nbsp;if&nbsp;it&nbsp;fails</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">elseif</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;2&nbsp;&amp;&amp;&nbsp;!</span><span class="vars">$this</span><span>-&gt;auth())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;endSession();&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// verify authentication, clearing cookies if it fails
elseif($this-&gt;state == 2 &amp;&amp; !$this-&gt;auth()) {
    $this-&gt;endSession();
}</pre><p>Here is the new constructor with these changes made:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Initialize&nbsp;a&nbsp;new&nbsp;TwitterApp&nbsp;object</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;tmhOAuth&nbsp;$tmhOAuth&nbsp;A&nbsp;tmhOAuth&nbsp;object&nbsp;with&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;&nbsp;__construct(tmhOAuth&nbsp;</span><span class="vars">$tmhOAuth</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;tmhOAuth&nbsp;object</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth&nbsp;=&nbsp;</span><span class="vars">$tmhOAuth</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;start&nbsp;a&nbsp;session&nbsp;if&nbsp;one&nbsp;does&nbsp;not&nbsp;exist</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!session_id())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session_start();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;determine&nbsp;the&nbsp;authentication&nbsp;status</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;default&nbsp;to&nbsp;0</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2&nbsp;(authenticated)&nbsp;if&nbsp;the&nbsp;cookies&nbsp;are&nbsp;set</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token"</span><span>],&nbsp;</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token_secret"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;otherwise&nbsp;use&nbsp;value&nbsp;stored&nbsp;in&nbsp;session</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(isset(</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;(int)</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;if&nbsp;we&nbsp;are&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;authentication&nbsp;we&nbsp;continue</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;auth();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;verify&nbsp;authentication,&nbsp;clearing&nbsp;cookies&nbsp;if&nbsp;it&nbsp;fails</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;2&nbsp;&amp;&amp;&nbsp;!</span><span class="vars">$this</span><span>-&gt;auth())&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;endSession();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Initialize a new TwitterApp object
 *
 * @param tmhOAuth $tmhOAuth A tmhOAuth object with consumer key and secret
 */
public function  __construct(tmhOAuth $tmhOAuth) {
    // save the tmhOAuth object
    $this-&gt;tmhOAuth = $tmhOAuth;
    // start a session if one does not exist
    if(!session_id()) {
        session_start();
    }
    // determine the authentication status
    // default to 0
    $this-&gt;state = 0;
    // 2 (authenticated) if the cookies are set
    if(isset($_COOKIE["access_token"], $_COOKIE["access_token_secret"])) {
        $this-&gt;state = 2;
    }
    // otherwise use value stored in session
    elseif(isset($_SESSION["authstate"])) {
    $this-&gt;state = (int)$_SESSION["authstate"];
    }
    // if we are in the process of authentication we continue
    if($this-&gt;state == 1) {
        $this-&gt;auth();
    }
    // verify authentication, clearing cookies if it fails
    elseif($this-&gt;state == 2 &amp;&amp; !$this-&gt;auth()) {
        $this-&gt;endSession();
    }
}</pre><hr><h2>Sending a Tweet</h2><p>Now that all the authorization code is complete, we can add some common functionality to our class. Here is a method to send a tweet through the Twitter API:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Send&nbsp;a&nbsp;tweet&nbsp;on&nbsp;the&nbsp;user's&nbsp;behalf</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$text&nbsp;Text&nbsp;to&nbsp;tweet</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Tweet&nbsp;successfully&nbsp;sent</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;sendTweet(</span><span class="vars">$text</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;limit&nbsp;the&nbsp;string&nbsp;to&nbsp;140&nbsp;characters</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$text</span><span>&nbsp;=&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$text</span><span>,&nbsp;0,&nbsp;140);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;POST&nbsp;the&nbsp;text&nbsp;to&nbsp;the&nbsp;statuses/update&nbsp;method</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/statuses/update"</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'status'&nbsp;=&gt;&nbsp;<span class="vars">$text</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;));&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200);&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Send a tweet on the user's behalf
 *
 * @param string $text Text to tweet
 * @return bool Tweet successfully sent
 */
public function sendTweet($text) {
    // limit the string to 140 characters
    $text = substr($text, 0, 140);
    // POST the text to the statuses/update method
    $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("1/statuses/update"), array(
        'status' =&gt; $text
    ));
    return ($this-&gt;tmhOAuth-&gt;response["code"] == 200);
}</pre><p>The <code>sendTweet()</code> method accepts a string, limits it to 140 characters, and then sends it in a POST request to <a href="http://dev.twitter.com/doc/post/statuses/update" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">1/statuses/update</a>. This pattern should be pretty familiar by now.</p><hr><h2>The Complete TwitterApp Class</h2><div class="dp-highlighter collapsed"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ExpandSource&#39;,this);return false;">+ expand source</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">class</span><span>&nbsp;TwitterApp&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;variable&nbsp;holds&nbsp;the&nbsp;tmhOAuth&nbsp;object&nbsp;used&nbsp;throughout&nbsp;the&nbsp;class</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;tmhOAuth&nbsp;An&nbsp;object&nbsp;of&nbsp;the&nbsp;tmhOAuth&nbsp;class</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="vars">$tmhOAuth</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;User's&nbsp;Twitter&nbsp;account&nbsp;data</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array&nbsp;Information&nbsp;on&nbsp;the&nbsp;current&nbsp;authenticated&nbsp;user</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="vars">$userdata</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Authentication&nbsp;state</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Values:</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;-&nbsp;0:&nbsp;not&nbsp;authed</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;-&nbsp;1:&nbsp;Request&nbsp;token&nbsp;obtained</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;-&nbsp;2:&nbsp;Access&nbsp;token&nbsp;obtained&nbsp;(authed)</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;int&nbsp;The&nbsp;current&nbsp;state&nbsp;of&nbsp;authentication</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="vars">$state</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Initialize&nbsp;a&nbsp;new&nbsp;TwitterApp&nbsp;object</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;tmhOAuth&nbsp;$tmhOAuth&nbsp;A&nbsp;tmhOAuth&nbsp;object&nbsp;with&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;&nbsp;__construct(tmhOAuth&nbsp;</span><span class="vars">$tmhOAuth</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;tmhOAuth&nbsp;object</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth&nbsp;=&nbsp;</span><span class="vars">$tmhOAuth</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;start&nbsp;a&nbsp;session&nbsp;if&nbsp;one&nbsp;does&nbsp;not&nbsp;exist</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!session_id())&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session_start();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;determine&nbsp;the&nbsp;authentication&nbsp;status</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;default&nbsp;to&nbsp;0</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;2&nbsp;(authenticated)&nbsp;if&nbsp;the&nbsp;cookies&nbsp;are&nbsp;set</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token"</span><span>],&nbsp;</span><span class="vars">$_COOKIE</span><span>[</span><span class="string">"access_token_secret"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;otherwise&nbsp;use&nbsp;value&nbsp;stored&nbsp;in&nbsp;session</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(isset(</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;(int)</span><span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>];&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;if&nbsp;we&nbsp;are&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;authentication&nbsp;we&nbsp;continue</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;auth();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;verify&nbsp;authentication,&nbsp;clearing&nbsp;cookies&nbsp;if&nbsp;it&nbsp;fails</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;2&nbsp;&amp;&amp;&nbsp;!</span><span class="vars">$this</span><span>-&gt;auth())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;endSession();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Authenticate&nbsp;user&nbsp;with&nbsp;Twitter</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Authentication&nbsp;successful</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;auth()&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;state&nbsp;1&nbsp;requires&nbsp;a&nbsp;GET&nbsp;variable&nbsp;to&nbsp;exist</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1&nbsp;&amp;&amp;&nbsp;!isset(</span><span class="vars">$_GET</span><span>[</span><span class="string">"oauth_verifier"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Step&nbsp;1:&nbsp;Get&nbsp;a&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;0)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;getRequestToken();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Step&nbsp;2:&nbsp;Get&nbsp;an&nbsp;access&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(</span><span class="vars">$this</span><span>-&gt;state&nbsp;==&nbsp;1)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;getAccessToken();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Step&nbsp;3:&nbsp;Verify&nbsp;the&nbsp;access&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;verifyAccessToken();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Obtain&nbsp;a&nbsp;request&nbsp;token&nbsp;from&nbsp;Twitter</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool&nbsp;False&nbsp;if&nbsp;request&nbsp;failed</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getRequestToken()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;send&nbsp;request&nbsp;for&nbsp;a&nbsp;request&nbsp;token</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"oauth/request_token"</span><span>,&nbsp;</span><span class="string">""</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;pass&nbsp;a&nbsp;variable&nbsp;to&nbsp;set&nbsp;the&nbsp;callback</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'oauth_callback<span class="string">'&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$this-&gt;tmhOAuth-&gt;php_self()</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;));</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($this-&gt;tmhOAuth-&gt;response["code"]&nbsp;==&nbsp;200)&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;and&nbsp;store&nbsp;the&nbsp;request&nbsp;token</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$response&nbsp;=&nbsp;$this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION["authtoken"]&nbsp;=&nbsp;$response["oauth_token"];</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION["authsecret"]&nbsp;=&nbsp;$response["oauth_token_secret"];</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;state&nbsp;is&nbsp;now&nbsp;1</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION["authstate"]&nbsp;=&nbsp;1;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;redirect&nbsp;the&nbsp;user&nbsp;to&nbsp;Twitter&nbsp;to&nbsp;authorize</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;$this-&gt;tmhOAuth-&gt;url("oauth/authorize",&nbsp;"")&nbsp;.&nbsp;'</span><span>?oauth_token=</span><span class="string">'&nbsp;.&nbsp;$response["oauth_token"];</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header("Location:&nbsp;'</span><span>&nbsp;.&nbsp;</span><span class="vars">$url</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="func">exit</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;false;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Obtain&nbsp;an&nbsp;access&nbsp;token&nbsp;from&nbsp;Twitter</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool&nbsp;False&nbsp;if&nbsp;request&nbsp;failed</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getAccessToken()&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;set&nbsp;the&nbsp;request&nbsp;token&nbsp;and&nbsp;secret&nbsp;we&nbsp;have&nbsp;stored</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;config["user_token</span><span class="string">"]&nbsp;=&nbsp;$_SESSION["</span><span>authtoken</span><span class="string">"];</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;tmhOAuth-&gt;config["</span><span>user_secret</span><span class="string">"]&nbsp;=&nbsp;$_SESSION["</span><span>authsecret</span><span class="string">"];</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;send&nbsp;request&nbsp;for&nbsp;an&nbsp;access&nbsp;token</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;tmhOAuth-&gt;request("</span><span>POST</span><span class="string">",&nbsp;$this-&gt;tmhOAuth-&gt;url("</span><span>oauth/access_token</span><span class="string">",&nbsp;"</span><span class="string">"),&nbsp;array(</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;pass&nbsp;the&nbsp;oauth_verifier&nbsp;received&nbsp;from&nbsp;Twitter</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'oauth_verifier'&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$_GET["</span><span>oauth_verifier</span><span class="string">"]</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;));</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($this-&gt;tmhOAuth-&gt;response["</span><span>code</span><span class="string">"]&nbsp;==&nbsp;200)&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;the&nbsp;access&nbsp;token&nbsp;and&nbsp;store&nbsp;it&nbsp;in&nbsp;a&nbsp;cookie</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$response&nbsp;=&nbsp;$this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["</span><span>response</span><span class="string">"]);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setcookie("</span><span>access_token</span><span class="string">",&nbsp;$response["</span><span>oauth_token</span><span class="string">"],&nbsp;time()+3600*24*30);</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setcookie("</span><span>access_token_secret</span><span class="string">",&nbsp;$response["</span><span>oauth_token_secret</span><span class="string">"],&nbsp;time()+3600*24*30);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;state&nbsp;is&nbsp;now&nbsp;2</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION["</span><span>authstate</span><span class="string">"]&nbsp;=&nbsp;2;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;redirect&nbsp;user&nbsp;to&nbsp;clear&nbsp;leftover&nbsp;GET&nbsp;variables</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header("</span><span>Location:&nbsp;</span><span class="string">'&nbsp;.&nbsp;$this-&gt;tmhOAuth-&gt;php_self());</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Verify&nbsp;the&nbsp;validity&nbsp;of&nbsp;our&nbsp;access&nbsp;token</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Access&nbsp;token&nbsp;verified</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;verifyAccessToken()&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;tmhOAuth-&gt;config["user_token"]&nbsp;=&nbsp;$_COOKIE["access_token"];</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;tmhOAuth-&gt;config["user_secret"]&nbsp;=&nbsp;$_COOKIE["access_token_secret"];</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;send&nbsp;verification&nbsp;request&nbsp;to&nbsp;test&nbsp;access&nbsp;key</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;tmhOAuth-&gt;request("GET",&nbsp;$this-&gt;tmhOAuth-&gt;url("1/account/verify_credentials"));</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;store&nbsp;the&nbsp;user&nbsp;data&nbsp;returned&nbsp;from&nbsp;the&nbsp;API</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;userdata&nbsp;=&nbsp;json_decode($this-&gt;tmhOAuth-&gt;response["response"]);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;HTTP&nbsp;200&nbsp;means&nbsp;we&nbsp;were&nbsp;successful</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;($this-&gt;tmhOAuth-&gt;response["code"]&nbsp;==&nbsp;200);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Check&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;authentication</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool&nbsp;True&nbsp;if&nbsp;state&nbsp;is&nbsp;2&nbsp;(authenticated)</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;isAuthed()&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;state&nbsp;==&nbsp;2;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Remove&nbsp;user'</span><span>s&nbsp;access&nbsp;token&nbsp;cookies&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;endSession()&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;state&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$_SESSION</span><span>[</span><span class="string">"authstate"</span><span>]&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token"</span><span>,&nbsp;</span><span class="string">""</span><span>,&nbsp;0);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setcookie(<span class="string">"access_token_secret"</span><span>,&nbsp;</span><span class="string">""</span><span>,&nbsp;0);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Send&nbsp;a&nbsp;tweet&nbsp;on&nbsp;the&nbsp;user's&nbsp;behalf</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$text&nbsp;Text&nbsp;to&nbsp;tweet</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Tweet&nbsp;successfully&nbsp;sent</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;sendTweet(</span><span class="vars">$text</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;limit&nbsp;the&nbsp;string&nbsp;to&nbsp;140&nbsp;characters</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$text</span><span>&nbsp;=&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$text</span><span>,&nbsp;0,&nbsp;140);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;POST&nbsp;the&nbsp;text&nbsp;to&nbsp;the&nbsp;statuses/update&nbsp;method</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/statuses/update"</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'status'&nbsp;=&gt;&nbsp;<span class="vars">$text</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;));&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php:collapse" style="display: none;">&lt;?php
class TwitterApp {
    /**
     * This variable holds the tmhOAuth object used throughout the class
     *
     * @var tmhOAuth An object of the tmhOAuth class
     */
    public $tmhOAuth;
    /**
     * User's Twitter account data
     *
     * @var array Information on the current authenticated user
     */
    public $userdata;
    /**
     * Authentication state
     *
     * Values:
     *  - 0: not authed
     *  - 1: Request token obtained
     *  - 2: Access token obtained (authed)
     *
     * @var int The current state of authentication
     */
    protected $state;
    /**
     * Initialize a new TwitterApp object
     *
     * @param tmhOAuth $tmhOAuth A tmhOAuth object with consumer key and secret
     */
    public function  __construct(tmhOAuth $tmhOAuth) {
        // save the tmhOAuth object
        $this-&gt;tmhOAuth = $tmhOAuth;
        // start a session if one does not exist
        if(!session_id()) {
            session_start();
        }
        // determine the authentication status
        // default to 0
        $this-&gt;state = 0;
        // 2 (authenticated) if the cookies are set
        if(isset($_COOKIE["access_token"], $_COOKIE["access_token_secret"])) {
            $this-&gt;state = 2;
        }
        // otherwise use value stored in session
        elseif(isset($_SESSION["authstate"])) {
            $this-&gt;state = (int)$_SESSION["authstate"];
        }
        // if we are in the process of authentication we continue
        if($this-&gt;state == 1) {
            $this-&gt;auth();
        }
        // verify authentication, clearing cookies if it fails
        elseif($this-&gt;state == 2 &amp;&amp; !$this-&gt;auth()) {
            $this-&gt;endSession();
        }
    }
    /**
     * Authenticate user with Twitter
     *
     * @return bool Authentication successful
     */
    public function auth() {
        // state 1 requires a GET variable to exist
        if($this-&gt;state == 1 &amp;&amp; !isset($_GET["oauth_verifier"])) {
            $this-&gt;state = 0;
        }
        // Step 1: Get a request token
        if($this-&gt;state == 0) {
            return $this-&gt;getRequestToken();
        }
        // Step 2: Get an access token
        elseif($this-&gt;state == 1) {
            return $this-&gt;getAccessToken();
        }
        // Step 3: Verify the access token
        return $this-&gt;verifyAccessToken();
    }
    /**
     * Obtain a request token from Twitter
     *
     * @return bool False if request failed
     */
    private function getRequestToken() {
        // send request for a request token
        $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("oauth/request_token", ""), array(
            // pass a variable to set the callback
            'oauth_callback'    =&gt; $this-&gt;tmhOAuth-&gt;php_self()
        ));
        if($this-&gt;tmhOAuth-&gt;response["code"] == 200) {
            // get and store the request token
            $response = $this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);
            $_SESSION["authtoken"] = $response["oauth_token"];
            $_SESSION["authsecret"] = $response["oauth_token_secret"];
            // state is now 1
            $_SESSION["authstate"] = 1;
            // redirect the user to Twitter to authorize
            $url = $this-&gt;tmhOAuth-&gt;url("oauth/authorize", "") . '?oauth_token=' . $response["oauth_token"];
            header("Location: ' . $url);
            exit;
        }
        return false;
    }
    /**
     * Obtain an access token from Twitter
     *
     * @return bool False if request failed
     */
    private function getAccessToken() {
        // set the request token and secret we have stored
        $this-&gt;tmhOAuth-&gt;config["user_token"] = $_SESSION["authtoken"];
        $this-&gt;tmhOAuth-&gt;config["user_secret"] = $_SESSION["authsecret"];
        // send request for an access token
        $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("oauth/access_token", ""), array(
            // pass the oauth_verifier received from Twitter
            'oauth_verifier'    =&gt; $_GET["oauth_verifier"]
        ));
        if($this-&gt;tmhOAuth-&gt;response["code"] == 200) {
            // get the access token and store it in a cookie
            $response = $this-&gt;tmhOAuth-&gt;extract_params($this-&gt;tmhOAuth-&gt;response["response"]);
            setcookie("access_token", $response["oauth_token"], time()+3600*24*30);
            setcookie("access_token_secret", $response["oauth_token_secret"], time()+3600*24*30);
            // state is now 2
            $_SESSION["authstate"] = 2;
            // redirect user to clear leftover GET variables
            header("Location: ' . $this-&gt;tmhOAuth-&gt;php_self());
            exit;
        }
        return false;
    }
    /**
     * Verify the validity of our access token
     *
     * @return bool Access token verified
     */
    private function verifyAccessToken() {
        $this-&gt;tmhOAuth-&gt;config["user_token"] = $_COOKIE["access_token"];
        $this-&gt;tmhOAuth-&gt;config["user_secret"] = $_COOKIE["access_token_secret"];
        // send verification request to test access key
        $this-&gt;tmhOAuth-&gt;request("GET", $this-&gt;tmhOAuth-&gt;url("1/account/verify_credentials"));
        // store the user data returned from the API
        $this-&gt;userdata = json_decode($this-&gt;tmhOAuth-&gt;response["response"]);
        // HTTP 200 means we were successful
        return ($this-&gt;tmhOAuth-&gt;response["code"] == 200);
    }
    /**
     * Check the current state of authentication
     *
     * @return bool True if state is 2 (authenticated)
     */
    public function isAuthed() {
        return $this-&gt;state == 2;
    }
    /**
     * Remove user's access token cookies
     */
    public function endSession() {
        $this-&gt;state = 0;
        $_SESSION["authstate"] = 0;
        setcookie("access_token", "", 0);
        setcookie("access_token_secret", "", 0);
    }
    /**
     * Send a tweet on the user's behalf
     *
     * @param string $text Text to tweet
     * @return bool Tweet successfully sent
     */
    public function sendTweet($text) {
        // limit the string to 140 characters
        $text = substr($text, 0, 140);
        // POST the text to the statuses/update method
        $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("1/statuses/update"), array(
            'status' =&gt; $text
        ));
        return ($this-&gt;tmhOAuth-&gt;response["code"] == 200);
    }
}</pre><hr><h2>Our Application</h2><p>Now that we have a class that handles all the OAuth tasks, we can now extend it with functionality specific to our application. This includes the ability to get, alter, and set the user’s avatar.</p><p>We will be extending the TwitterApp class with a TwitterAvatars class. Start with the following code in a new file called <code>lib/TwitterAvatars.php</code>:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">class</span><span>&nbsp;TwitterAvatars&nbsp;</span><span class="keyword">extends</span><span>&nbsp;TwitterApp&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;path&nbsp;to&nbsp;our&nbsp;temporary&nbsp;files&nbsp;directory</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string&nbsp;Path&nbsp;to&nbsp;store&nbsp;image&nbsp;files</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;These&nbsp;are&nbsp;all&nbsp;the&nbsp;GD&nbsp;image&nbsp;filters&nbsp;available&nbsp;in&nbsp;this&nbsp;class</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array&nbsp;Associative&nbsp;array&nbsp;of&nbsp;image&nbsp;filters</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="vars">$filters</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'grayscale'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_GRAYSCALE,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'negative'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_NEGATE,&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'edgedetect'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_EDGEDETECT,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'embossed'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_EMBOSS,&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'blurry'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_GAUSSIAN_BLUR,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'sketchy'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_MEAN_REMOVAL&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Initialize&nbsp;a&nbsp;new&nbsp;TwitterAvatars&nbsp;object</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;tmhOAuth&nbsp;$tmhOAuth&nbsp;A&nbsp;tmhOAuth&nbsp;object&nbsp;with&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$path&nbsp;Path&nbsp;to&nbsp;store&nbsp;image&nbsp;files&nbsp;(default&nbsp;'tmp")</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;&nbsp;__construct(tmhOAuth&nbsp;</span><span class="vars">$tmhOAuth</span><span>,&nbsp;</span><span class="vars">$path</span><span>&nbsp;=&nbsp;'tmp")&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;call&nbsp;the&nbsp;parent&nbsp;class'&nbsp;constructor</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent::__construct(<span class="vars">$tmhOAuth</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;path&nbsp;variable</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;path&nbsp;=&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">&lt;?php
class TwitterAvatars extends TwitterApp {
    /**
     * The path to our temporary files directory
     *
     * @var string Path to store image files
     */
    public $path;
    /**
     * These are all the GD image filters available in this class
     *
     * @var array Associative array of image filters
     */
    protected $filters = array(
        'grayscale'     =&gt; IMG_FILTER_GRAYSCALE,
        'negative'      =&gt; IMG_FILTER_NEGATE,
        'edgedetect'    =&gt; IMG_FILTER_EDGEDETECT,
        'embossed'      =&gt; IMG_FILTER_EMBOSS,
        'blurry'        =&gt; IMG_FILTER_GAUSSIAN_BLUR,
        'sketchy'       =&gt; IMG_FILTER_MEAN_REMOVAL
    );
    /**
     * Initialize a new TwitterAvatars object
     *
     * @param tmhOAuth $tmhOAuth A tmhOAuth object with consumer key and secret
     * @param string $path Path to store image files (default 'tmp")
     */
    public function  __construct(tmhOAuth $tmhOAuth, $path = 'tmp") {
        // call the parent class' constructor
        parent::__construct($tmhOAuth);
        // save the path variable
        $this-&gt;path = $path;
    }
}</pre><p>As you can see, the extended class includes a <code>$path</code> property to point to where temporary image files will go, a <code>$filters</code> property holding an array of image filters, and an extended constructor with a parameter to set the path. Since we are overriding the original constructor, we have to explicitly call the parent’s constructor with <code>parent::__construct()</code>.</p><p>Now we can start adding our methods.</p><hr><h2>Downloading</h2><p>Obviously, we’ll need the ability to download images in order to manipulate them. Here is a generic <code>download()</code> method that accepts a URL and returns the data at that location. The method makes a basic cURL request.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Download&nbsp;data&nbsp;from&nbsp;specified&nbsp;URL</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$url&nbsp;URL&nbsp;to&nbsp;download</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;string&nbsp;Downloaded&nbsp;data</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;download(</span><span class="vars">$url</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ch</span><span>&nbsp;=&nbsp;curl_init();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt(<span class="vars">$ch</span><span>,&nbsp;CURLOPT_URL,&nbsp;</span><span class="vars">$url</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt(<span class="vars">$ch</span><span>,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;true);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ret</span><span>&nbsp;=&nbsp;curl_exec(</span><span class="vars">$ch</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;curl_close(<span class="vars">$ch</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$ret</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Download data from specified URL
 *
 * @param string $url URL to download
 * @return string Downloaded data
 */
protected function download($url) {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $ret = curl_exec($ch);
    curl_close($ch);
    return $ret;
}</pre><hr><h2>Finding URLs</h2><p>Now that we can download files, we need to find the location of the files we need. There are two different images we are interested in, the standard sized thumbnail and the original full-sized image. So, we’ll create a method to get each URL.</p><p>To get the standard sized thumbnail, we’ll call the <a href="http://dev.twitter.com/doc/get/users/profile_image/:screen_name" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">users/profile_image/:screen_name</a> API method which responds with a 302 redirect to the specified user’s avatar image. This means the URL will be found in the Location header. Here is that method:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Get&nbsp;the&nbsp;URL&nbsp;to&nbsp;the&nbsp;standard&nbsp;sized&nbsp;avatar</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;URL&nbsp;to&nbsp;the&nbsp;image&nbsp;file</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getImageURL()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;request&nbsp;user's&nbsp;'bigger'&nbsp;profile&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"GET"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/users/profile_image/"</span><span>&nbsp;.&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;screen_name),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'screen_name<span class="string">'&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$this-&gt;userdata-&gt;screen_name,</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'</span><span>size</span><span class="string">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;'</span><span>bigger'&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;));&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;302)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;the&nbsp;direct&nbsp;URL&nbsp;is&nbsp;in&nbsp;the&nbsp;Location&nbsp;header</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"headers"</span><span>][</span><span class="string">"location"</span><span>];&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Error&nbsp;locating&nbsp;image"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Get the URL to the standard sized avatar
 *
 * @return string The URL to the image file
 */
protected function getImageURL() {
    // request user's 'bigger' profile image
    $this-&gt;tmhOAuth-&gt;request("GET", $this-&gt;tmhOAuth-&gt;url("1/users/profile_image/" . $this-&gt;userdata-&gt;screen_name), array(
        'screen_name'   =&gt; $this-&gt;userdata-&gt;screen_name,
        'size'          =&gt; 'bigger'
    ));
    if($this-&gt;tmhOAuth-&gt;response["code"] == 302) {
        // the direct URL is in the Location header
        return $this-&gt;tmhOAuth-&gt;response["headers"]["location"];
    }
    throw new Exception("Error locating image");
}</pre><p>Note that we are making a GET request with tmhOAuth, passing <code>screen_name</code> and <code>size</code> parameters, then returning the contents of the Location header.</p><p>There is no API method to get the full sized image, so for our next method we’ll cheat a little and edit the URL. The user data contains a <code>profile_image_url</code> field that points to something like <em>avatar_normal.jpg</em>, and the original image can be found at <em>avatar.jpg</em> without the suffix. So this method gets the URL, removes the size suffix and returns the modified URL:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Get&nbsp;the&nbsp;URL&nbsp;to&nbsp;the&nbsp;full&nbsp;sized&nbsp;avatar</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;URL&nbsp;to&nbsp;the&nbsp;image&nbsp;file</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getOriginalImageURL()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;regular&nbsp;sized&nbsp;avatar</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$url</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;profile_image_url;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;extension&nbsp;for&nbsp;later</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ext</span><span>&nbsp;=&nbsp;</span><span class="func">strrchr</span><span>(</span><span class="vars">$url</span><span>,&nbsp;</span><span class="string">'.");</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;strip&nbsp;the&nbsp;"_normal'</span><span>&nbsp;suffix&nbsp;</span><span class="keyword">and</span><span>&nbsp;add&nbsp;back&nbsp;the&nbsp;extension&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$url</span><span>,&nbsp;0,&nbsp;</span><span class="func">strrpos</span><span>(</span><span class="vars">$url</span><span>,&nbsp;</span><span class="string">"_"</span><span>))&nbsp;.&nbsp;</span><span class="vars">$ext</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Get the URL to the full sized avatar
 *
 * @return string The URL to the image file
 */
protected function getOriginalImageURL() {
    // get the regular sized avatar
    $url = $this-&gt;userdata-&gt;profile_image_url;
    // save the extension for later
    $ext = strrchr($url, '.");
    // strip the "_normal' suffix and add back the extension
    return substr($url, 0, strrpos($url, "_")) . $ext;
}</pre><hr><h2>Reading Images</h2><p>Now that we can locate and download images, we need a way to read them. We’ll be using the GD library to manipulate images, so this method will convert the raw image data into a GD image resource.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Convert&nbsp;raw&nbsp;image&nbsp;data&nbsp;to&nbsp;a&nbsp;GD&nbsp;resource</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$data&nbsp;Binary&nbsp;image&nbsp;data&nbsp;to&nbsp;parse</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;resource&nbsp;A&nbsp;GD&nbsp;image&nbsp;resource&nbsp;identifier</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;readImage(</span><span class="vars">$data</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;in&nbsp;the&nbsp;original&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$src</span><span>&nbsp;=&nbsp;imagecreatefromstring(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="vars">$src</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Error&nbsp;reading&nbsp;image"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;dimensions</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$width</span><span>&nbsp;=&nbsp;imagesx(</span><span class="vars">$src</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$height</span><span>&nbsp;=&nbsp;imagesy(</span><span class="vars">$src</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;create&nbsp;a&nbsp;blank&nbsp;true&nbsp;color&nbsp;image&nbsp;of&nbsp;the&nbsp;same&nbsp;size</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;imagecreatetruecolor(</span><span class="vars">$width</span><span>,&nbsp;</span><span class="vars">$height</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;copy&nbsp;the&nbsp;original&nbsp;image&nbsp;to&nbsp;this&nbsp;new&nbsp;canvas</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;imagecopy(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$src</span><span>,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;</span><span class="vars">$width</span><span>,&nbsp;</span><span class="vars">$height</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;discard&nbsp;the&nbsp;source&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;imagedestroy(<span class="vars">$src</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$img</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Convert raw image data to a GD resource
 *
 * @param string $data Binary image data to parse
 * @return resource A GD image resource identifier
 */
protected function readImage($data) {
    // read in the original image
    $src = imagecreatefromstring($data);
    if(!$src) {
        throw new Exception("Error reading image");
    }
    // get the dimensions
    $width = imagesx($src);
    $height = imagesy($src);
    // create a blank true color image of the same size
    $img = imagecreatetruecolor($width, $height);
    // copy the original image to this new canvas
    imagecopy($img, $src, 0, 0, 0, 0, $width, $height);
    // discard the source image
    imagedestroy($src);
    return $img;
}</pre><p>To describe what’s happening above:</p><div class="tutorial_image"><script type="text/javascript">google_ad_client = "pub-9093712935949486";
/* 300x250 nettuts middle tutsads */
google_ad_slot = "1775681443";
google_ad_width = 300;
google_ad_height = 250;</script> <script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/show_ads.js"></script><ins style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px"><ins id="aswift_0_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px"><iframe width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" replaced="true"></iframe></ins></ins></div><ol><li>The image data is converted to a GD resource using the <code><a href="http://www.php.net/manual/function.imagecreatefromstring.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagecreatefromstring</a>()</code> function.</li><li>The image dimensions are recorded using <code><a href="http://www.php.net/manual/function.imagesx.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagesx</a>()</code> and <code><a href="http://www.php.net/manual/function.imagesy.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagesy</a>()</code>.</li><li>A new blank true color image with the same dimensions is created using <code><a href="http://www.php.net/manual/function.imagecreatetruecolor.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagecreatetruecolor</a>()</code>.</li><li>The original image is copied into the new image using the <code><a href="http://www.php.net/manual/function.imagecopy.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagecopy</a>()</code> function. This results in a true color version of the original image regardless of the original color mode.</li><li>The original image resource is destroyed using <code><a href="http://www.php.net/manual/function.imagedestroy.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagedestroy</a>()</code> and the handle to the new image is returned.</li></ol><hr><h2>Saving Images</h2><p>Now that we can download images and create a GD resource, we need a method to save the images to the file system. Here is the method that saves the supplied image as a PNG file with the specified name using <code><a href="http://www.php.net/manual/function.imagepng.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagepng</a>()</code>:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Save&nbsp;a&nbsp;GD&nbsp;image&nbsp;resource&nbsp;to&nbsp;a&nbsp;PNG&nbsp;file</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;resource&nbsp;$img&nbsp;GD&nbsp;image&nbsp;resource&nbsp;identifier</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$name&nbsp;Name&nbsp;of&nbsp;the&nbsp;image</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;string&nbsp;Path&nbsp;to&nbsp;the&nbsp;saved&nbsp;image</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$name</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$path</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;path&nbsp;.&nbsp;"/</span><span class="string">'&nbsp;.&nbsp;$name&nbsp;.&nbsp;'</span><span>.png';&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;imagepng(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$path</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;imagedestroy(<span class="vars">$img</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Save a GD image resource to a PNG file
 *
 * @param resource $img GD image resource identifier
 * @param string $name Name of the image
 * @return string Path to the saved image
 */
protected function saveImage($img, $name) {
    $path = $this-&gt;path . "/' . $name . '.png';
    imagepng($img, $path);
    imagedestroy($img);
    return $path;
}</pre><hr><h2>Generating Previews</h2><p>Now that we have all the pieces that power our app, we can start putting them together. In our application flow, we will give the user a selection of previews to choose from. Here is the method to generate these previews:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Generate&nbsp;previews&nbsp;for&nbsp;each&nbsp;image&nbsp;filter</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;array&nbsp;Associative&nbsp;array&nbsp;of&nbsp;image&nbsp;previews</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;generatePreviews()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;we&nbsp;need&nbsp;valid&nbsp;user&nbsp;info&nbsp;to&nbsp;know&nbsp;whose&nbsp;avatar&nbsp;to&nbsp;handle</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="vars">$this</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Requires&nbsp;oauth&nbsp;authorization"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$username</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;screen_name;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;cache&nbsp;the&nbsp;raw&nbsp;data&nbsp;to&nbsp;use</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$data</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;download(</span><span class="vars">$this</span><span>-&gt;getImageURL());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;copy&nbsp;the&nbsp;original&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;</span><span class="string">"_orig"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;array&nbsp;to&nbsp;hold&nbsp;the&nbsp;list&nbsp;of&nbsp;previews</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$images</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;loop&nbsp;through&nbsp;each&nbsp;filter&nbsp;to&nbsp;generate&nbsp;previews</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">foreach</span><span>(</span><span class="vars">$this</span><span>-&gt;filters&nbsp;</span><span class="keyword">as</span><span>&nbsp;</span><span class="vars">$filter_name</span><span>&nbsp;=&gt;&nbsp;</span><span class="vars">$filter</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagefilter(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$filter</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$images</span><span>[</span><span class="vars">$filter_name</span><span>]&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;"_'&nbsp;.&nbsp;</span><span class="vars">$filter_name</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$images</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Generate previews for each image filter
 *
 * @return array Associative array of image previews
 */
public function generatePreviews() {
    // we need valid user info to know whose avatar to handle
    if(!$this-&gt;isAuthed()) {
        throw new Exception("Requires oauth authorization");
    }
    $username = $this-&gt;userdata-&gt;screen_name;
    // cache the raw data to use
    $data = $this-&gt;download($this-&gt;getImageURL());
    // copy the original image
    $img = $this-&gt;readImage($data);
    $this-&gt;saveImage($img, $username . "_orig");
    // array to hold the list of previews
    $images = array();
    // loop through each filter to generate previews
    foreach($this-&gt;filters as $filter_name =&gt; $filter) {
        $img = $this-&gt;readImage($data);
        imagefilter($img, $filter);
        $images[$filter_name] = $this-&gt;saveImage($img, $username . "_' . $filter_name);
    }
    return $images;
}</pre><p>The first thing we do is check that the user is authenticated and then grab the user name to use later in file names.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;we&nbsp;need&nbsp;valid&nbsp;user&nbsp;info&nbsp;to&nbsp;know&nbsp;whose&nbsp;avatar&nbsp;to&nbsp;handle</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(!</span><span class="vars">$this</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Requires&nbsp;oauth&nbsp;authorization"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li><li class="alt"><span><span class="vars">$username</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;screen_name;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// we need valid user info to know whose avatar to handle
if(!$this-&gt;isAuthed()) {
    throw new Exception("Requires oauth authorization");
}
$username = $this-&gt;userdata-&gt;screen_name;</pre><p>Then we download the user’s image using the <code>getImageURL()</code> and <code>download()</code> methods we have created. This data will be used repeatedly for each preview so we save it in the <code>$data</code> variable.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;cache&nbsp;the&nbsp;raw&nbsp;data&nbsp;to&nbsp;use</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$data</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;download(</span><span class="vars">$this</span><span>-&gt;getImageURL());&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// cache the raw data to use
$data = $this-&gt;download($this-&gt;getImageURL());</pre><p>Next, we save an unmodified copy with the _orig suffix. This is for visual comparison later.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;copy&nbsp;the&nbsp;original&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;</span><span class="string">"_orig"</span><span>);&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// copy the original image
$img = $this-&gt;readImage($data);
$this-&gt;saveImage($img, $username . "_orig");</pre><p>The last part of the method is where we loop through the image filters listed in the <code>$filters</code> property, generating an image for each filter. In each iteration, we’re creating an image and applying the <code><a href="http://www.php.net/manual/function.imagefilter.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank">imagefilter</a>()</code> function, which accepts one of the constants we have listed in the <code>$filters</code> array. Then for each image we save, we add its path to an associative array (using the filter name as the key) which this method returns at the end.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;array&nbsp;to&nbsp;hold&nbsp;the&nbsp;list&nbsp;of&nbsp;previews</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$images</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>();&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="comment">//&nbsp;loop&nbsp;through&nbsp;each&nbsp;filter&nbsp;to&nbsp;generate&nbsp;previews</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">foreach</span><span>(</span><span class="vars">$this</span><span>-&gt;filters&nbsp;</span><span class="keyword">as</span><span>&nbsp;</span><span class="vars">$filter_name</span><span>&nbsp;=&gt;&nbsp;</span><span class="vars">$filter</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;imagefilter(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$filter</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$images</span><span>[</span><span class="vars">$filter_name</span><span>]&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;"_'&nbsp;.&nbsp;</span><span class="vars">$filter_name</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li><li class="alt"><span><span class="keyword">return</span><span>&nbsp;</span><span class="vars">$images</span><span>;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">// array to hold the list of previews
$images = array();
// loop through each filter to generate previews
foreach($this-&gt;filters as $filter_name =&gt; $filter) {
    $img = $this-&gt;readImage($data);
    imagefilter($img, $filter);
    $images[$filter_name] = $this-&gt;saveImage($img, $username . "_' . $filter_name);
}
return $images;</pre><p>The next part of our application flow asks the user to confirm their choice, so we need a way to find a specific preview. Here is the simple method to get the path to an image based on the option passed as a parameter, defaulting to the original image:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Get&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;previously&nbsp;generated&nbsp;preview</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filter&nbsp;The&nbsp;image&nbsp;filter&nbsp;to&nbsp;get&nbsp;the&nbsp;preview&nbsp;for</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;preview&nbsp;file&nbsp;or&nbsp;null&nbsp;if&nbsp;not&nbsp;found</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getPreview(</span><span class="vars">$filter</span><span>&nbsp;=&nbsp;</span><span class="string">'orig")&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;if(!$this-&gt;isAuthed())&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Exception("Requires&nbsp;oauth&nbsp;authorization");</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;$path&nbsp;=&nbsp;$this-&gt;path&nbsp;.&nbsp;"/'</span><span>&nbsp;.&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;screen_name&nbsp;.&nbsp;"_</span><span class="string">'&nbsp;.&nbsp;$filter&nbsp;.&nbsp;'</span><span>.png';&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="func">file_exists</span><span>(</span><span class="vars">$path</span><span>))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;null;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Get the path to a previously generated preview
 *
 * @param string $filter The image filter to get the preview for
 * @return string The path to the preview file or null if not found
 */
public function getPreview($filter = 'orig") {
    if(!$this-&gt;isAuthed()) {
        throw new Exception("Requires oauth authorization");
    }
    $path = $this-&gt;path . "/' . $this-&gt;userdata-&gt;screen_name . "_' . $filter . '.png';
    if(file_exists($path)) {
        return $path;
    }
    return null;
}</pre><hr><h2>Changing The Avatar</h2><p>The final stage of our application flow is to actually change the user’s avatar. First we need a method to get the full sized image and apply a specific filter to it. Here it is:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Process&nbsp;the&nbsp;user's&nbsp;full&nbsp;avatar&nbsp;using&nbsp;one&nbsp;of&nbsp;the&nbsp;filters</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filter&nbsp;The&nbsp;filter&nbsp;to&nbsp;apply&nbsp;to&nbsp;the&nbsp;image</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;string&nbsp;Path&nbsp;to&nbsp;the&nbsp;output&nbsp;file</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;processImage(</span><span class="vars">$filter</span><span>&nbsp;=&nbsp;</span><span class="string">"grayscale"</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;make&nbsp;sure&nbsp;the&nbsp;filter&nbsp;exists</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$filter</span><span>&nbsp;=&nbsp;</span><span class="func">strtolower</span><span>(</span><span class="vars">$filter</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="func">array_key_exists</span><span>(</span><span class="vars">$filter</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;filters))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Unsupported&nbsp;image&nbsp;filter"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$username</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;screen_name;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;full&nbsp;sized&nbsp;avatar</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$data</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;download(</span><span class="vars">$this</span><span>-&gt;getOriginalImageURL());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;apply&nbsp;the&nbsp;filter&nbsp;to&nbsp;the&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;imagefilter(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;filters[</span><span class="vars">$filter</span><span>]);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;image&nbsp;and&nbsp;return&nbsp;the&nbsp;path</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;</span><span class="string">"_'&nbsp;.&nbsp;$filter&nbsp;.&nbsp;"</span><span>_full");&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Process the user's full avatar using one of the filters
 *
 * @param string $filter The filter to apply to the image
 * @return string Path to the output file
 */
protected function processImage($filter = "grayscale") {
    // make sure the filter exists
    $filter = strtolower($filter);
    if(!array_key_exists($filter, $this-&gt;filters)) {
        throw new Exception("Unsupported image filter");
    }
    $username = $this-&gt;userdata-&gt;screen_name;
    // get the full sized avatar
    $data = $this-&gt;download($this-&gt;getOriginalImageURL());
    $img = $this-&gt;readImage($data);
    // apply the filter to the image
    imagefilter($img, $this-&gt;filters[$filter]);
    // save the image and return the path
    return $this-&gt;saveImage($img, $username . "_' . $filter . "_full");
}</pre><p>That should be easy to follow since it is very similar to the <code>generatePreviews()</code> method. It accepts a parameter to specify an image filter and checks that it exists. Then it downloads the original image and applies the filter to it, passing back the path to the generated image as the return value.</p><p>Now we need the method that actually sends the generated image to Twitter, updating the user’s avatar. This method calls the <code>processImage()</code> method to create the image and uploads it to Twitter via the <a href="http://dev.twitter.com/doc/post/account/update_profile_image" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">1/account/update_profile_image</a> API method:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Update&nbsp;user's&nbsp;avatar&nbsp;with&nbsp;a&nbsp;filtered&nbsp;version</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filter&nbsp;The&nbsp;filter&nbsp;to&nbsp;use</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;bool&nbsp;Operation&nbsp;successful</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;commitAvatar(</span><span class="vars">$filter</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="vars">$this</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Requires&nbsp;oauth&nbsp;authorization"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;generate&nbsp;the&nbsp;image&nbsp;and&nbsp;get&nbsp;the&nbsp;path</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$path</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;processImage(</span><span class="vars">$filter</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="func">file_exists</span><span>(</span><span class="vars">$path</span><span>))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;send&nbsp;a&nbsp;multipart&nbsp;POST&nbsp;request&nbsp;with&nbsp;the&nbsp;image&nbsp;file&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/account/update_profile_image"</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;format:&nbsp;@local/path.png;type=mime/type;filename=file_name.png</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'image<span class="string">'&nbsp;=&gt;&nbsp;'</span><span>@</span><span class="string">'&nbsp;.&nbsp;$path&nbsp;.&nbsp;'</span><span>;type=image/png;filename='&nbsp;.&nbsp;</span><span class="func">basename</span><span>(</span><span class="vars">$path</span><span>)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),&nbsp;true,&nbsp;true);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;false;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Update user's avatar with a filtered version
 *
 * @param string $filter The filter to use
 * @return bool Operation successful
 */
public function commitAvatar($filter) {
    if(!$this-&gt;isAuthed()) {
        throw new Exception("Requires oauth authorization");
    }
    // generate the image and get the path
    $path = $this-&gt;processImage($filter);
    if(file_exists($path)) {
        // send a multipart POST request with the image file data
        $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("1/account/update_profile_image"), array(
            // format: @local/path.png;type=mime/type;filename=file_name.png
            'image' =&gt; '@' . $path . ';type=image/png;filename=' . basename($path)
        ), true, true);
        return ($this-&gt;tmhOAuth-&gt;response["code"] == 200);
    }
    return false;
}</pre><p>The tricky part here is the actual tmhOAuth POST request, which is a multipart request containing the raw image data. In order to do this, we must set the last parameter of the <code>tmhOAuth::request()</code> method to <code>true</code>, and pass the <code>image</code> variable in a special format:</p><blockquote><p>@[<strong>path_to_image</strong>];type=[<strong>mime_type</strong>];filename=[<strong>file_name</strong>]</p></blockquote><p>For example, if we want to upload tmp/username_grayscale_full.png, the value would be <code>@tmp/username_grayscale_full.png;type=image/png;filename=username_grayscale_full.png</code>.</p><p>Here is that part of the code again:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;send&nbsp;a&nbsp;multipart&nbsp;POST&nbsp;request&nbsp;with&nbsp;the&nbsp;image&nbsp;file&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/account/update_profile_image"</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;format:&nbsp;@local/path.png;type=mime/type;filename=file_name.png</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'image'</span><span>&nbsp;=&gt;&nbsp;</span><span class="string">'@'</span><span>&nbsp;.&nbsp;</span><span class="vars">$path</span><span>&nbsp;.&nbsp;</span><span class="string">';type=image/png;filename='</span><span>&nbsp;.&nbsp;</span><span class="func">basename</span><span>(</span><span class="vars">$path</span><span>)&nbsp;&nbsp;</span></span></li><li class="alt"><span>),&nbsp;true,&nbsp;true);&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">// send a multipart POST request with the image file data
$this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("1/account/update_profile_image"), array(
    // format: @local/path.png;type=mime/type;filename=file_name.png
    'image' =&gt; '@' . $path . ';type=image/png;filename=' . basename($path)
), true, true);</pre><hr><h2>Cleaning Up</h2><p>A side effect of all this file manipulation is a lot of temporary files being left behind. Here is a method to clean up the temporary directory:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;*&nbsp;Delete&nbsp;leftover&nbsp;image&nbsp;files</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;cleanupFiles()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;file&nbsp;to&nbsp;track&nbsp;when&nbsp;we&nbsp;last&nbsp;checked</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$flag</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;path&nbsp;.&nbsp;</span><span class="string">"/.last_check';</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;$time&nbsp;=&nbsp;time();</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;have&nbsp;we&nbsp;checked&nbsp;within&nbsp;the&nbsp;last&nbsp;hour?</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;if(!file_exists($flag)&nbsp;||&nbsp;$time&nbsp;-&nbsp;filemtime($flag)&nbsp;&gt;&nbsp;3600)&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;an&nbsp;array&nbsp;of&nbsp;PNG&nbsp;files&nbsp;in&nbsp;the&nbsp;directory</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;glob($this-&gt;path&nbsp;.&nbsp;"</span><span>/*.png");&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;loop&nbsp;through&nbsp;files,&nbsp;deleting&nbsp;old&nbsp;files&nbsp;(12+&nbsp;hours)</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">foreach</span><span>(</span><span class="vars">$files</span><span>&nbsp;</span><span class="keyword">as</span><span>&nbsp;</span><span class="vars">$file</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$time</span><span>&nbsp;-&nbsp;</span><span class="func">filemtime</span><span>(</span><span class="vars">$file</span><span>)&nbsp;&gt;&nbsp;60*60*12)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink(<span class="vars">$file</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;update&nbsp;the&nbsp;timestamp&nbsp;of&nbsp;our&nbsp;flag&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;touch(<span class="vars">$flag</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">/**
 * Delete leftover image files
 */
public function cleanupFiles() {
    // file to track when we last checked
    $flag = $this-&gt;path . "/.last_check';
    $time = time();
    // have we checked within the last hour?
    if(!file_exists($flag) || $time - filemtime($flag) &gt; 3600) {
        // get an array of PNG files in the directory
        $files = glob($this-&gt;path . "/*.png");
        // loop through files, deleting old files (12+ hours)
        foreach($files as $file) {
            if($time - filemtime($file) &gt; 60*60*12) {
                unlink($file);
            }
        }
        // update the timestamp of our flag file
        touch($flag);
    }
}</pre><p>This simply loops through the PNG files, deleting those more than 12 hours old. It also checks how long it has been since we checked using the timestamp on a .last_check file, allowing us to limit the check to one per hour. This way we can call this method on every request without wasting resources.</p><p>Note: We are making use of the <a href="http://www.php.net/manual/function.glob.php" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;www.php.net&#39;]);" target="_blank"><code>glob()</code> function</a> in PHP, which is an easy way to get an array of files matching a pattern.</p><hr><h2>The Complete TwitterAvatars Class</h2><div class="dp-highlighter collapsed"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ExpandSource&#39;,this);return false;">+ expand source</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&amp;?php&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">class</span><span>&nbsp;TwitterAvatars&nbsp;</span><span class="keyword">extends</span><span>&nbsp;TwitterApp&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;path&nbsp;to&nbsp;our&nbsp;temporary&nbsp;files&nbsp;directory</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;string&nbsp;Path&nbsp;to&nbsp;store&nbsp;image&nbsp;files</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;These&nbsp;are&nbsp;all&nbsp;the&nbsp;GD&nbsp;image&nbsp;filters&nbsp;available&nbsp;in&nbsp;this&nbsp;class</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array&nbsp;Associative&nbsp;array&nbsp;of&nbsp;image&nbsp;filters</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="vars">$filters</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'grayscale'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_GRAYSCALE,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'negative'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_NEGATE,&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'edgedetect'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_EDGEDETECT,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'embossed'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_EMBOSS,&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'blurry'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_GAUSSIAN_BLUR,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'sketchy'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;IMG_FILTER_MEAN_REMOVAL&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Initialize&nbsp;a&nbsp;new&nbsp;TwitterAvatars&nbsp;object</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;tmhOAuth&nbsp;$tmhOAuth&nbsp;A&nbsp;tmhOAuth&nbsp;object&nbsp;with&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$path&nbsp;Path&nbsp;to&nbsp;store&nbsp;image&nbsp;files&nbsp;(default&nbsp;'tmp")</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;&nbsp;__construct(tmhOAuth&nbsp;</span><span class="vars">$tmhOAuth</span><span>,&nbsp;</span><span class="vars">$path</span><span>&nbsp;=&nbsp;'tmp")&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;call&nbsp;the&nbsp;parent&nbsp;class'&nbsp;constructor</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent::__construct(<span class="vars">$tmhOAuth</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;save&nbsp;the&nbsp;path&nbsp;variable</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;path&nbsp;=&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Download&nbsp;data&nbsp;from&nbsp;specified&nbsp;URL</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$url&nbsp;URL&nbsp;to&nbsp;download</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;Downloaded&nbsp;data</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;download(</span><span class="vars">$url</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ch</span><span>&nbsp;=&nbsp;curl_init();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt(<span class="vars">$ch</span><span>,&nbsp;CURLOPT_URL,&nbsp;</span><span class="vars">$url</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt(<span class="vars">$ch</span><span>,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;true);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ret</span><span>&nbsp;=&nbsp;curl_exec(</span><span class="vars">$ch</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_close(<span class="vars">$ch</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$ret</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Get&nbsp;the&nbsp;URL&nbsp;to&nbsp;the&nbsp;standard&nbsp;sized&nbsp;avatar</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;URL&nbsp;to&nbsp;the&nbsp;image&nbsp;file</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;getImageURL()&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;request&nbsp;user's&nbsp;'bigger'&nbsp;profile&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"GET"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/users/profile_image/'&nbsp;.&nbsp;$this-&gt;userdata-&gt;screen_name),&nbsp;array(</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'screen_name'&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$this-&gt;userdata-&gt;screen_name,</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'size'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;'bigger'</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;));</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($this-&gt;tmhOAuth-&gt;response["</span><span>code</span><span class="string">"]&nbsp;==&nbsp;302)&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;direct&nbsp;URL&nbsp;is&nbsp;in&nbsp;the&nbsp;Location&nbsp;header</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;tmhOAuth-&gt;response["</span><span>headers</span><span class="string">"]["</span><span>location</span><span class="string">"];</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Exception("</span><span>Error&nbsp;locating&nbsp;image</span><span class="string">");</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Get&nbsp;the&nbsp;URL&nbsp;to&nbsp;the&nbsp;full&nbsp;sized&nbsp;avatar</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;URL&nbsp;to&nbsp;the&nbsp;image&nbsp;file</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;getOriginalImageURL()&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;the&nbsp;regular&nbsp;sized&nbsp;avatar</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;$this-&gt;userdata-&gt;profile_image_url;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;save&nbsp;the&nbsp;extension&nbsp;for&nbsp;later</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext&nbsp;=&nbsp;strrchr($url,&nbsp;'."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;strip&nbsp;the&nbsp;"_normal'&nbsp;suffix&nbsp;and&nbsp;add&nbsp;back&nbsp;the&nbsp;extension</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$url</span><span>,&nbsp;0,&nbsp;</span><span class="func">strrpos</span><span>(</span><span class="vars">$url</span><span>,&nbsp;"_</span><span class="string">"))&nbsp;.&nbsp;$ext;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Convert&nbsp;raw&nbsp;image&nbsp;data&nbsp;to&nbsp;a&nbsp;GD&nbsp;resource</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$data&nbsp;Binary&nbsp;image&nbsp;data&nbsp;to&nbsp;parse</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;resource&nbsp;A&nbsp;GD&nbsp;image&nbsp;resource&nbsp;identifier</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;readImage($data)&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;read&nbsp;in&nbsp;the&nbsp;original&nbsp;image</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src&nbsp;=&nbsp;imagecreatefromstring($data);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!$src)&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Exception("</span><span>Error&nbsp;reading&nbsp;image</span><span class="string">");</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;the&nbsp;dimensions</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$width&nbsp;=&nbsp;imagesx($src);</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$height&nbsp;=&nbsp;imagesy($src);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;a&nbsp;blank&nbsp;true&nbsp;color&nbsp;image&nbsp;of&nbsp;the&nbsp;same&nbsp;size</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$img&nbsp;=&nbsp;imagecreatetruecolor($width,&nbsp;$height);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;copy&nbsp;the&nbsp;original&nbsp;image&nbsp;to&nbsp;this&nbsp;new&nbsp;canvas</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagecopy($img,&nbsp;$src,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;$width,&nbsp;$height);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;discard&nbsp;the&nbsp;source&nbsp;image</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagedestroy($src);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$img;</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Save&nbsp;a&nbsp;GD&nbsp;image&nbsp;resource&nbsp;to&nbsp;a&nbsp;PNG&nbsp;file</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;resource&nbsp;$img&nbsp;GD&nbsp;image&nbsp;resource&nbsp;identifier</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$name&nbsp;Name&nbsp;of&nbsp;the&nbsp;image</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;Path&nbsp;to&nbsp;the&nbsp;saved&nbsp;image</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;saveImage($img,&nbsp;$name)&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path&nbsp;=&nbsp;$this-&gt;path&nbsp;.&nbsp;"</span><span>/'&nbsp;.&nbsp;</span><span class="vars">$name</span><span>&nbsp;.&nbsp;</span><span class="string">'.png'</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagepng(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$path</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagedestroy(<span class="vars">$img</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Generate&nbsp;previews&nbsp;for&nbsp;each&nbsp;image&nbsp;filter</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;array&nbsp;Associative&nbsp;array&nbsp;of&nbsp;image&nbsp;previews</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;generatePreviews()&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;we&nbsp;need&nbsp;valid&nbsp;user&nbsp;info&nbsp;to&nbsp;know&nbsp;whose&nbsp;avatar&nbsp;to&nbsp;handle</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="vars">$this</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Requires&nbsp;oauth&nbsp;authorization"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$username</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;userdata-&gt;screen_name;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;cache&nbsp;the&nbsp;raw&nbsp;data&nbsp;to&nbsp;use</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$data</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;download(</span><span class="vars">$this</span><span>-&gt;getImageURL());&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;copy&nbsp;the&nbsp;original&nbsp;image</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;</span><span class="string">"_orig"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;array&nbsp;to&nbsp;hold&nbsp;the&nbsp;list&nbsp;of&nbsp;previews</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$images</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;loop&nbsp;through&nbsp;each&nbsp;filter&nbsp;to&nbsp;generate&nbsp;previews</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">foreach</span><span>(</span><span class="vars">$this</span><span>-&gt;filters&nbsp;</span><span class="keyword">as</span><span>&nbsp;</span><span class="vars">$filter_name</span><span>&nbsp;=&gt;&nbsp;</span><span class="vars">$filter</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$img</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;readImage(</span><span class="vars">$data</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagefilter(<span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$filter</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$images</span><span>[</span><span class="vars">$filter_name</span><span>]&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;saveImage(</span><span class="vars">$img</span><span>,&nbsp;</span><span class="vars">$username</span><span>&nbsp;.&nbsp;</span><span class="string">"_'&nbsp;.&nbsp;$filter_name);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$images;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Get&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;previously&nbsp;generated&nbsp;preview</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filter&nbsp;The&nbsp;image&nbsp;filter&nbsp;to&nbsp;get&nbsp;the&nbsp;preview&nbsp;for</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;preview&nbsp;file&nbsp;or&nbsp;null&nbsp;if&nbsp;not&nbsp;found</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;getPreview($filter&nbsp;=&nbsp;'orig"</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="vars">$this</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Requires&nbsp;oauth&nbsp;authorization"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$path</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;path&nbsp;.&nbsp;</span><span class="string">"/'&nbsp;.&nbsp;$this-&gt;userdata-&gt;screen_name&nbsp;.&nbsp;"</span><span>_'&nbsp;.&nbsp;</span><span class="vars">$filter</span><span>&nbsp;.&nbsp;</span><span class="string">'.png'</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="func">file_exists</span><span>(</span><span class="vars">$path</span><span>))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="vars">$path</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;null;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Process&nbsp;the&nbsp;user's&nbsp;full&nbsp;avatar&nbsp;using&nbsp;one&nbsp;of&nbsp;the&nbsp;filters</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$filter&nbsp;The&nbsp;filter&nbsp;to&nbsp;apply&nbsp;to&nbsp;the&nbsp;image</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string&nbsp;Path&nbsp;to&nbsp;the&nbsp;output&nbsp;file</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">protected</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;processImage(</span><span class="vars">$filter</span><span>&nbsp;=&nbsp;'grayscale</span><span class="string">")&nbsp;{</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;make&nbsp;sure&nbsp;the&nbsp;filter&nbsp;exists</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filter&nbsp;=&nbsp;strtolower($filter);</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!array_key_exists($filter,&nbsp;$this-&gt;filters))&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Exception("</span><span>Unsupported&nbsp;image&nbsp;filter</span><span class="string">");</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$username&nbsp;=&nbsp;$this-&gt;userdata-&gt;screen_name;</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;the&nbsp;full&nbsp;sized&nbsp;avatar</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;$this-&gt;download($this-&gt;getOriginalImageURL());</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$img&nbsp;=&nbsp;$this-&gt;readImage($data);</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;apply&nbsp;the&nbsp;filter&nbsp;to&nbsp;the&nbsp;image</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagefilter($img,&nbsp;$this-&gt;filters[$filter]);</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;save&nbsp;the&nbsp;image&nbsp;and&nbsp;return&nbsp;the&nbsp;path</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;saveImage($img,&nbsp;$username&nbsp;.&nbsp;"</span><span>_</span><span class="string">'&nbsp;.&nbsp;$filter&nbsp;.&nbsp;"_full");</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;}</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;/**</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;user'</span><span>s&nbsp;avatar&nbsp;with&nbsp;a&nbsp;filtered&nbsp;version&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;<span class="vars">$filter</span><span>&nbsp;The&nbsp;filter&nbsp;to&nbsp;</span><span class="keyword">use</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@<span class="keyword">return</span><span>&nbsp;bool&nbsp;Operation&nbsp;successful&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;commitAvatar(</span><span class="vars">$filter</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(!</span><span class="vars">$this</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;Exception(</span><span class="string">"Requires&nbsp;oauth&nbsp;authorization"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;generate&nbsp;the&nbsp;image&nbsp;and&nbsp;get&nbsp;the&nbsp;path</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$path</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;processImage(</span><span class="vars">$filter</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="func">file_exists</span><span>(</span><span class="vars">$path</span><span>))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;send&nbsp;a&nbsp;multipart&nbsp;POST&nbsp;request&nbsp;with&nbsp;the&nbsp;image&nbsp;file&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;request(</span><span class="string">"POST"</span><span>,&nbsp;</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;url(</span><span class="string">"1/account/update_profile_image"</span><span>),&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;format:&nbsp;@local/path.png;type=mime/type;filename=file_name.png</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'image'</span><span>&nbsp;=&gt;&nbsp;</span><span class="string">'@'</span><span>&nbsp;.&nbsp;</span><span class="vars">$path</span><span>&nbsp;.&nbsp;</span><span class="string">';type=image/png;filename='</span><span>&nbsp;.&nbsp;</span><span class="func">basename</span><span>(</span><span class="vars">$path</span><span>)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),&nbsp;true,&nbsp;true);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="vars">$this</span><span>-&gt;tmhOAuth-&gt;response[</span><span class="string">"code"</span><span>]&nbsp;==&nbsp;200);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;false;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li class=""><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Delete&nbsp;leftover&nbsp;image&nbsp;files</span>&nbsp;</span></li><li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">function</span><span>&nbsp;cleanupFiles()&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;file&nbsp;to&nbsp;track&nbsp;when&nbsp;we&nbsp;last&nbsp;checked</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$flag</span><span>&nbsp;=&nbsp;</span><span class="vars">$this</span><span>-&gt;path&nbsp;.&nbsp;</span><span class="string">"/.last_check';</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$time&nbsp;=&nbsp;time();</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;have&nbsp;we&nbsp;checked&nbsp;within&nbsp;the&nbsp;last&nbsp;hour?</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!file_exists($flag)&nbsp;||&nbsp;$time&nbsp;-&nbsp;filemtime($flag)&nbsp;&gt;&nbsp;3600)&nbsp;{</span>&nbsp;</span></li><li class=""><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;an&nbsp;array&nbsp;of&nbsp;PNG&nbsp;files&nbsp;in&nbsp;the&nbsp;directory</span>&nbsp;</span></li><li class="alt"><span><span class="string">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;glob($this-&gt;path&nbsp;.&nbsp;"</span><span>/*.png");&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;loop&nbsp;through&nbsp;files,&nbsp;deleting&nbsp;old&nbsp;files&nbsp;(12+&nbsp;hours)</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">foreach</span><span>(</span><span class="vars">$files</span><span>&nbsp;</span><span class="keyword">as</span><span>&nbsp;</span><span class="vars">$file</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$time</span><span>&nbsp;-&nbsp;</span><span class="func">filemtime</span><span>(</span><span class="vars">$file</span><span>)&nbsp;&gt;&nbsp;60*60*12)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink(<span class="vars">$file</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;update&nbsp;the&nbsp;timestamp&nbsp;of&nbsp;our&nbsp;flag&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;touch(<span class="vars">$flag</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php:collapse" style="display: none;">&amp;?php
class TwitterAvatars extends TwitterApp {
    /**
     * The path to our temporary files directory
     *
     * @var string Path to store image files
     */
    public $path;
    /**
     * These are all the GD image filters available in this class
     *
     * @var array Associative array of image filters
     */
    protected $filters = array(
        'grayscale'     =&gt; IMG_FILTER_GRAYSCALE,
        'negative'      =&gt; IMG_FILTER_NEGATE,
        'edgedetect'    =&gt; IMG_FILTER_EDGEDETECT,
        'embossed'      =&gt; IMG_FILTER_EMBOSS,
        'blurry'        =&gt; IMG_FILTER_GAUSSIAN_BLUR,
        'sketchy'       =&gt; IMG_FILTER_MEAN_REMOVAL
    );
    /**
     * Initialize a new TwitterAvatars object
     *
     * @param tmhOAuth $tmhOAuth A tmhOAuth object with consumer key and secret
     * @param string $path Path to store image files (default 'tmp")
     */
    public function  __construct(tmhOAuth $tmhOAuth, $path = 'tmp") {
        // call the parent class' constructor
        parent::__construct($tmhOAuth);
        // save the path variable
        $this-&gt;path = $path;
    }
    /**
     * Download data from specified URL
     *
     * @param string $url URL to download
     * @return string Downloaded data
     */
    protected function download($url) {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        $ret = curl_exec($ch);
        curl_close($ch);
        return $ret;
    }
    /**
     * Get the URL to the standard sized avatar
     *
     * @return string The URL to the image file
     */
    protected function getImageURL() {
        // request user's 'bigger' profile image
        $this-&gt;tmhOAuth-&gt;request("GET", $this-&gt;tmhOAuth-&gt;url("1/users/profile_image/' . $this-&gt;userdata-&gt;screen_name), array(
            'screen_name'   =&gt; $this-&gt;userdata-&gt;screen_name,
            'size'          =&gt; 'bigger'
        ));
        if($this-&gt;tmhOAuth-&gt;response["code"] == 302) {
            // the direct URL is in the Location header
            return $this-&gt;tmhOAuth-&gt;response["headers"]["location"];
        }
        throw new Exception("Error locating image");
    }
    /**
     * Get the URL to the full sized avatar
     *
     * @return string The URL to the image file
     */
    protected function getOriginalImageURL() {
        // get the regular sized avatar
        $url = $this-&gt;userdata-&gt;profile_image_url;
        // save the extension for later
        $ext = strrchr($url, '.");
        // strip the "_normal' suffix and add back the extension
        return substr($url, 0, strrpos($url, "_")) . $ext;
    }
    /**
     * Convert raw image data to a GD resource
     *
     * @param string $data Binary image data to parse
     * @return resource A GD image resource identifier
     */
    protected function readImage($data) {
        // read in the original image
        $src = imagecreatefromstring($data);
        if(!$src) {
            throw new Exception("Error reading image");
        }
        // get the dimensions
        $width = imagesx($src);
        $height = imagesy($src);
        // create a blank true color image of the same size
        $img = imagecreatetruecolor($width, $height);
        // copy the original image to this new canvas
        imagecopy($img, $src, 0, 0, 0, 0, $width, $height);
        // discard the source image
        imagedestroy($src);
        return $img;
    }
    /**
     * Save a GD image resource to a PNG file
     *
     * @param resource $img GD image resource identifier
     * @param string $name Name of the image
     * @return string Path to the saved image
     */
    protected function saveImage($img, $name) {
        $path = $this-&gt;path . "/' . $name . '.png';
        imagepng($img, $path);
        imagedestroy($img);
        return $path;
    }
    /**
     * Generate previews for each image filter
     *
     * @return array Associative array of image previews
     */
    public function generatePreviews() {
        // we need valid user info to know whose avatar to handle
        if(!$this-&gt;isAuthed()) {
            throw new Exception("Requires oauth authorization");
        }
        $username = $this-&gt;userdata-&gt;screen_name;
        // cache the raw data to use
        $data = $this-&gt;download($this-&gt;getImageURL());
        // copy the original image
        $img = $this-&gt;readImage($data);
        $this-&gt;saveImage($img, $username . "_orig");
        // array to hold the list of previews
        $images = array();
        // loop through each filter to generate previews
        foreach($this-&gt;filters as $filter_name =&gt; $filter) {
            $img = $this-&gt;readImage($data);
            imagefilter($img, $filter);
            $images[$filter_name] = $this-&gt;saveImage($img, $username . "_' . $filter_name);
        }
        return $images;
    }
    /**
     * Get the path to a previously generated preview
     *
     * @param string $filter The image filter to get the preview for
     * @return string The path to the preview file or null if not found
     */
    public function getPreview($filter = 'orig") {
        if(!$this-&gt;isAuthed()) {
            throw new Exception("Requires oauth authorization");
        }
        $path = $this-&gt;path . "/' . $this-&gt;userdata-&gt;screen_name . "_' . $filter . '.png';
        if(file_exists($path)) {
            return $path;
        }
        return null;
    }
    /**
     * Process the user's full avatar using one of the filters
     *
     * @param string $filter The filter to apply to the image
     * @return string Path to the output file
     */
    protected function processImage($filter = 'grayscale") {
        // make sure the filter exists
        $filter = strtolower($filter);
        if(!array_key_exists($filter, $this-&gt;filters)) {
            throw new Exception("Unsupported image filter");
        }
        $username = $this-&gt;userdata-&gt;screen_name;
        // get the full sized avatar
        $data = $this-&gt;download($this-&gt;getOriginalImageURL());
        $img = $this-&gt;readImage($data);
        // apply the filter to the image
        imagefilter($img, $this-&gt;filters[$filter]);
        // save the image and return the path
        return $this-&gt;saveImage($img, $username . "_' . $filter . "_full");
    }
    /**
     * Update user's avatar with a filtered version
     *
     * @param string $filter The filter to use
     * @return bool Operation successful
     */
    public function commitAvatar($filter) {
        if(!$this-&gt;isAuthed()) {
            throw new Exception("Requires oauth authorization");
        }
        // generate the image and get the path
        $path = $this-&gt;processImage($filter);
        if(file_exists($path)) {
            // send a multipart POST request with the image file data
            $this-&gt;tmhOAuth-&gt;request("POST", $this-&gt;tmhOAuth-&gt;url("1/account/update_profile_image"), array(
                // format: @local/path.png;type=mime/type;filename=file_name.png
                'image' =&gt; '@' . $path . ';type=image/png;filename=' . basename($path)
            ), true, true);
            return ($this-&gt;tmhOAuth-&gt;response["code"] == 200);
        }
        return false;
    }
    /**
     * Delete leftover image files
     */
    public function cleanupFiles() {
        // file to track when we last checked
        $flag = $this-&gt;path . "/.last_check';
        $time = time();
        // have we checked within the last hour?
        if(!file_exists($flag) || $time - filemtime($flag) &gt; 3600) {
            // get an array of PNG files in the directory
            $files = glob($this-&gt;path . "/*.png");
            // loop through files, deleting old files (12+ hours)
            foreach($files as $file) {
                if($time - filemtime($file) &gt; 60*60*12) {
                    unlink($file);
                }
            }
            // update the timestamp of our flag file
            touch($flag);
        }
    }
}</pre><hr><h2>The Front End</h2><p>We have all the application’s components together, so now all we need is the user interface. All the code here will go into the <strong>index.php</strong> file in the root directory. We’ll start by including the libraries and setting the configuration:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;&nbsp;</span></span></li><li class=""><span><span class="comment">//&nbsp;include&nbsp;our&nbsp;libraries</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">include</span><span>&nbsp;</span><span class="string">'lib/tmhOAuth.php'</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">include</span><span>&nbsp;</span><span class="string">'lib/TwitterApp.php'</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">include</span><span>&nbsp;</span><span class="string">'lib/TwitterAvatars.php'</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="comment">//&nbsp;set&nbsp;the&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>define(<span class="string">"CONSUMER_KEY"</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">'qSkJum23MqlG6greF8Z76A");</span>&nbsp;</span></li><li class=""><span><span class="string">define("CONSUMER_SECRET",&nbsp;&nbsp;&nbsp;'</span><span>Bs738r5UY2R7e5mwp1ilU0voe8OtXAtifgtZe9EhXw");&nbsp;&nbsp;</span></span></li><li class="alt"><span>?&gt;&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">&lt;?php
// include our libraries
include 'lib/tmhOAuth.php';
include 'lib/TwitterApp.php';
include 'lib/TwitterAvatars.php';
// set the consumer key and secret
define("CONSUMER_KEY",      'qSkJum23MqlG6greF8Z76A");
define("CONSUMER_SECRET",   'Bs738r5UY2R7e5mwp1ilU0voe8OtXAtifgtZe9EhXw");
?&gt;</pre><p>Note: Be sure to replace the <code>CONSUMER_KEY</code> and <code>CONSUMER_SECRET</code> with your own.</p><p>We’re going to place our code in a try-catch block so we can gracefully handle any errors, assigning their message to an <code>$error</code> variable.</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>try&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;catch(Exception&nbsp;<span class="vars">$e</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;catch&nbsp;any&nbsp;errors&nbsp;that&nbsp;may&nbsp;occur</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$error</span><span>&nbsp;=&nbsp;</span><span class="vars">$e</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">try {
} catch(Exception $e) {
    // catch any errors that may occur
    $error = $e;
}</pre><p>Within the try block we can begin writing our code, starting by initializing a TwitterAvatars object called <code>$ta</code> with a configured tmhOAuth object:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;our&nbsp;tmhOAuth&nbsp;settings</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$config</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'consumer_key'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;CONSUMER_KEY,&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'consumer_secret'</span><span>&nbsp;&nbsp;&nbsp;=&gt;&nbsp;CONSUMER_SECRET&nbsp;&nbsp;</span></span></li><li class="alt"><span>);&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;create&nbsp;a&nbsp;new&nbsp;TwitterAvatars&nbsp;object</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="vars">$ta</span><span>&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;TwitterAvatars(</span><span class="keyword">new</span><span>&nbsp;tmhOAuth(</span><span class="vars">$config</span><span>));&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">    // our tmhOAuth settings
    $config = array(
        'consumer_key'      =&gt; CONSUMER_KEY,
        'consumer_secret'   =&gt; CONSUMER_SECRET
    );
    // create a new TwitterAvatars object
    $ta = new TwitterAvatars(new tmhOAuth($config));</pre><p>We can clear out any old temporary files at this point:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;check&nbsp;for&nbsp;stale&nbsp;files</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="vars">$ta</span><span>-&gt;cleanupFiles();&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">    // check for stale files
    $ta-&gt;cleanupFiles();</pre><p>Next we check if the user is authenticated or, failing that, if the user has requested authentication, in which case we start the process by calling the <code>auth()</code> method:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;check&nbsp;our&nbsp;authentication&nbsp;status</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(</span><span class="vars">$ta</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;did&nbsp;the&nbsp;user&nbsp;request&nbsp;authorization?</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">elseif</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"auth"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;start&nbsp;authentication&nbsp;process</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;auth();&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">    // check our authentication status
    if($ta-&gt;isAuthed()) {
    }
    // did the user request authorization?
    elseif(isset($_POST["auth"])) {
        // start authentication process
        $ta-&gt;auth();
    }</pre><p>If the user is authenticated, we need to check if an option has been selected, otherwise we will generate previews:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;check&nbsp;our&nbsp;authentication&nbsp;status</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(</span><span class="vars">$ta</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;has&nbsp;the&nbsp;user&nbsp;selected&nbsp;an&nbsp;option?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;generate&nbsp;previews&nbsp;if&nbsp;the&nbsp;user&nbsp;has&nbsp;not&nbsp;chosen</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;$previews&nbsp;will&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;images</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$previews</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;generatePreviews();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">    // check our authentication status
    if($ta-&gt;isAuthed()) {
        // has the user selected an option?
        if(isset($_POST["filter"])) {
        }
        // generate previews if the user has not chosen
        else {
            // $previews will be a list of images
            $previews = $ta-&gt;generatePreviews();
        }
    }</pre><p>If an option was selected, we need to get the paths to the old and new images for display:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;has&nbsp;the&nbsp;user&nbsp;selected&nbsp;an&nbsp;option?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;image&nbsp;paths&nbsp;for&nbsp;display</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$original</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;getPreview();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$newimage</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;getPreview(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]);&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">        // has the user selected an option?
        if(isset($_POST["filter"])) {
            // get the image paths for display
            $original = $ta-&gt;getPreview();
            $newimage = $ta-&gt;getPreview($_POST["filter"]);
        }</pre><p>Finally, we check if the user has confirmed their choice and apply the change. We also send a tweet if requested and set a <code>$success</code> variable to <code>true</code>:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="comment">//&nbsp;has&nbsp;the&nbsp;user&nbsp;selected&nbsp;an&nbsp;option?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;is&nbsp;the&nbsp;user&nbsp;sure?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"confirm"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;change&nbsp;the&nbsp;user's&nbsp;avatar</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;commitAvatar(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;tweet&nbsp;if&nbsp;the&nbsp;user&nbsp;chose&nbsp;to</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"tweet"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;sendTweet(</span><span class="string">"I&nbsp;just&nbsp;updated&nbsp;my&nbsp;avatar&nbsp;using&nbsp;Avatar&nbsp;Effects..."</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$success</span><span>&nbsp;=&nbsp;true;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;image&nbsp;paths&nbsp;for&nbsp;display</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$original</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;getPreview();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$newimage</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;getPreview(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]);&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">        // has the user selected an option?
        if(isset($_POST["filter"])) {
            // is the user sure?
            if(isset($_POST["confirm"])) {
                // change the user's avatar
                $ta-&gt;commitAvatar($_POST["filter"]);
                // tweet if the user chose to
                if(isset($_POST["tweet"])) {
                    $ta-&gt;sendTweet("I just updated my avatar using Avatar Effects...");
                }
                $success = true;
            }
            // get the image paths for display
            $original = $ta-&gt;getPreview();
            $newimage = $ta-&gt;getPreview($_POST["filter"]);
        }</pre><p>Here is what we have so far:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;&nbsp;</span></span></li><li class=""><span><span class="comment">//&nbsp;include&nbsp;our&nbsp;libraries</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">include</span><span>&nbsp;</span><span class="string">'lib/tmhOAuth.php'</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">include</span><span>&nbsp;</span><span class="string">'lib/TwitterApp.php'</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">include</span><span>&nbsp;</span><span class="string">'lib/TwitterAvatars.php'</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="comment">//&nbsp;set&nbsp;the&nbsp;consumer&nbsp;key&nbsp;and&nbsp;secret</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>define(<span class="string">"CONSUMER_KEY"</span><span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">'qSkJum23MqlG6greF8Z76A");</span>&nbsp;</span></li><li class=""><span><span class="string">define("CONSUMER_SECRET",&nbsp;&nbsp;&nbsp;'</span><span>Bs738r5UY2R7e5mwp1ilU0voe8OtXAtifgtZe9EhXw");&nbsp;&nbsp;</span></span></li><li class="alt"><span>try&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;our&nbsp;tmhOAuth&nbsp;settings</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$config</span><span>&nbsp;=&nbsp;</span><span class="keyword">array</span><span>(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'consumer_key'</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;CONSUMER_KEY,&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'consumer_secret'</span><span>&nbsp;&nbsp;&nbsp;=&gt;&nbsp;CONSUMER_SECRET&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;create&nbsp;a&nbsp;new&nbsp;TwitterAvatars&nbsp;object</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;TwitterAvatars(</span><span class="keyword">new</span><span>&nbsp;tmhOAuth(</span><span class="vars">$config</span><span>));&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;for&nbsp;stale&nbsp;files</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;cleanupFiles();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;our&nbsp;authentication&nbsp;status</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(</span><span class="vars">$ta</span><span>-&gt;isAuthed())&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;has&nbsp;the&nbsp;user&nbsp;selected&nbsp;an&nbsp;option?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;is&nbsp;the&nbsp;user&nbsp;sure?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"confirm"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;change&nbsp;the&nbsp;user's&nbsp;avatar</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;commitAvatar(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;tweet&nbsp;if&nbsp;the&nbsp;user&nbsp;chose&nbsp;to</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"tweet"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;sendTweet(</span><span class="string">"I&nbsp;just&nbsp;updated&nbsp;my&nbsp;avatar&nbsp;using&nbsp;Avatar&nbsp;Effects..."</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$success</span><span>&nbsp;=&nbsp;true;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;the&nbsp;image&nbsp;paths&nbsp;for&nbsp;display</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$original</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;getPreview();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$newimage</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;getPreview(</span><span class="vars">$_POST</span><span>[</span><span class="string">"filter"</span><span>]);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;generate&nbsp;previews&nbsp;if&nbsp;the&nbsp;user&nbsp;has&nbsp;not&nbsp;chosen</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;$previews&nbsp;will&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;images</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$previews</span><span>&nbsp;=&nbsp;</span><span class="vars">$ta</span><span>-&gt;generatePreviews();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;did&nbsp;the&nbsp;user&nbsp;request&nbsp;authorization?</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span><span>(isset(</span><span class="vars">$_POST</span><span>[</span><span class="string">"auth"</span><span>]))&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;start&nbsp;authentication&nbsp;process</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$ta</span><span>-&gt;auth();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>}&nbsp;catch(Exception&nbsp;<span class="vars">$e</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;catch&nbsp;any&nbsp;errors&nbsp;that&nbsp;may&nbsp;occur</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars">$error</span><span>&nbsp;=&nbsp;</span><span class="vars">$e</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li><li class=""><span>?&gt;&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">&lt;?php
// include our libraries
include 'lib/tmhOAuth.php';
include 'lib/TwitterApp.php';
include 'lib/TwitterAvatars.php';
// set the consumer key and secret
define("CONSUMER_KEY",      'qSkJum23MqlG6greF8Z76A");
define("CONSUMER_SECRET",   'Bs738r5UY2R7e5mwp1ilU0voe8OtXAtifgtZe9EhXw");
try {
    // our tmhOAuth settings
    $config = array(
        'consumer_key'      =&gt; CONSUMER_KEY,
        'consumer_secret'   =&gt; CONSUMER_SECRET
    );
    // create a new TwitterAvatars object
    $ta = new TwitterAvatars(new tmhOAuth($config));
    // check for stale files
    $ta-&gt;cleanupFiles();
    // check our authentication status
    if($ta-&gt;isAuthed()) {
        // has the user selected an option?
        if(isset($_POST["filter"])) {
            // is the user sure?
            if(isset($_POST["confirm"])) {
                // change the user's avatar
                $ta-&gt;commitAvatar($_POST["filter"]);
                // tweet if the user chose to
                if(isset($_POST["tweet"])) {
                    $ta-&gt;sendTweet("I just updated my avatar using Avatar Effects...");
                }
                $success = true;
            }
            // get the image paths for display
            $original = $ta-&gt;getPreview();
            $newimage = $ta-&gt;getPreview($_POST["filter"]);
        }
        // generate previews if the user has not chosen
        else {
            // $previews will be a list of images
            $previews = $ta-&gt;generatePreviews();
        }
    }
    // did the user request authorization?
    elseif(isset($_POST["auth"])) {
        // start authentication process
        $ta-&gt;auth();
    }
} catch(Exception $e) {
    // catch any errors that may occur
    $error = $e;
}
?&gt;</pre><hr><h2>The HTML</h2><p>After the PHP code we will output the appropriate HTML, starting with this template, which sets the title and main heading:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-xml"><li class="alt"><span><span>&lt;!DOCTYPE&nbsp;html</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="tag">&lt;</span><span class="tag-name">html</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">head</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">meta</span><span>&nbsp;</span><span class="attribute">charset</span><span>=</span><span class="attribute-value">"UTF-8"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">title</span><span class="tag">&gt;</span><span>Twitter&nbsp;Avatar&nbsp;Effects</span><span class="tag">&lt;/</span><span class="tag-name">title</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">link</span><span>&nbsp;</span><span class="attribute">rel</span><span>=</span><span class="attribute-value">"stylesheet"</span><span>&nbsp;</span><span class="attribute">href</span><span>=</span><span class="attribute-value">"css/style.css"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">head</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">body</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">h1</span><span class="tag">&gt;</span><span>Twitter&nbsp;Avatar&nbsp;Effects</span><span class="tag">&lt;/</span><span class="tag-name">h1</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">body</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="tag">&lt;/</span><span class="tag-name">html</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="html" style="display: none;">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Twitter Avatar Effects&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/style.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;
      &lt;h1&gt;Twitter Avatar Effects&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre><p>Here’s where we display a form with image inputs for each preview:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;</span><span class="keyword">if</span><span>(isset(</span><span class="vars">$previews</span><span>)):&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2&gt;Choose&nbsp;your&nbsp;weapon...&lt;/h2&gt;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;action=<span class="string">"index.php"</span><span>&nbsp;method=</span><span class="string">"post"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;<span class="keyword">foreach</span><span>(</span><span class="vars">$previews</span><span>&nbsp;</span><span class="keyword">as</span><span>&nbsp;</span><span class="vars">$filter</span><span>&nbsp;=&gt;&nbsp;</span><span class="vars">$path</span><span>):&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=<span class="string">"image"</span><span>&nbsp;src=</span><span class="string">"&lt;?php&nbsp;echo&nbsp;$path;&nbsp;?&gt;"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alt=<span class="string">"&lt;?php&nbsp;echo&nbsp;ucfirst($filter);&nbsp;?&gt;"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width=<span class="string">"73"</span><span>&nbsp;height=</span><span class="string">"73"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="string">"filter"</span><span>&nbsp;value=</span><span class="string">"&lt;?php&nbsp;echo&nbsp;$filter;&nbsp;?&gt;"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;<span class="keyword">endforeach</span><span>;&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Select&nbsp;one&nbsp;of&nbsp;the&nbsp;images&nbsp;above&nbsp;to&nbsp;change&nbsp;your&nbsp;Twitter&nbsp;avatar.&lt;/p&gt;&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">  &lt;?php if(isset($previews)): ?&gt;
      &lt;h2&gt;Choose your weapon...&lt;/h2&gt;
      &lt;form action="index.php" method="post"&gt;
      &lt;?php foreach($previews as $filter =&gt; $path): ?&gt;
          &lt;input type="image" src="&lt;?php echo $path; ?&gt;"
                 alt="&lt;?php echo ucfirst($filter); ?&gt;"
                  width="73" height="73"
                 name="filter" value="&lt;?php echo $filter; ?&gt;"&gt;
      &lt;?php endforeach; ?&gt;
      &lt;/form&gt;
      &lt;p&gt;Select one of the images above to change your Twitter avatar.&lt;/p&gt;</pre><p>Here is the success page:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;</span><span class="keyword">elseif</span><span>(isset(</span><span class="vars">$success</span><span>)):&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2&gt;Success!&nbsp;Your&nbsp;Twitter&nbsp;avatar&nbsp;is&nbsp;now:&lt;/h2&gt;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;img&nbsp;src=<span class="string">"&lt;?php&nbsp;echo&nbsp;$newimage;&nbsp;?&gt;"</span><span>&nbsp;alt=</span><span class="string">"Your&nbsp;Avatar"</span><span>&nbsp;width=</span><span class="string">"73"</span><span>&nbsp;height=</span><span class="string">"73"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;a&nbsp;href=<span class="string">"http://twitter.com/&lt;?php&nbsp;echo&nbsp;$ta-&gt;userdata-&gt;screen_name;&nbsp;?&gt;"</span><span>&gt;Go&nbsp;see&nbsp;it&lt;/a&gt;&lt;/p&gt;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">  &lt;?php elseif(isset($success)): ?&gt;
      &lt;h2&gt;Success! Your Twitter avatar is now:&lt;/h2&gt;
      &lt;img src="&lt;?php echo $newimage; ?&gt;" alt="Your Avatar" width="73" height="73"&gt;
      &lt;p&gt;&lt;a href="http://twitter.com/&lt;?php echo $ta-&gt;userdata-&gt;screen_name; ?&gt;"&gt;Go see it&lt;/a&gt;&lt;/p&gt;</pre><p>Here is the confirmation page, where we show the comparison and offer the chance to cancel:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;</span><span class="keyword">elseif</span><span>(isset(</span><span class="vars">$newimage</span><span>)):&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2&gt;Are&nbsp;you&nbsp;sure?&lt;/h2&gt;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;img&nbsp;src=<span class="string">"&lt;?php&nbsp;echo&nbsp;$original;&nbsp;?&gt;"</span><span>&nbsp;alt=</span><span class="string">"Original"</span><span>&nbsp;width=</span><span class="string">"73"</span><span>&nbsp;height=</span><span class="string">"73"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;<span class="keyword">class</span><span>=</span><span class="string">"arrow"</span><span>&gt;&amp;rArr;&lt;/span&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;img&nbsp;src=<span class="string">"&lt;?php&nbsp;echo&nbsp;$newimage;&nbsp;?&gt;"</span><span>&nbsp;alt=</span><span class="string">"&lt;?php&nbsp;echo&nbsp;ucfirst($_POST["</span><span>filter</span><span class="string">"]);&nbsp;?&gt;"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;action=<span class="string">"index.php"</span><span>&nbsp;method=</span><span class="string">"post"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=<span class="string">"hidden"</span><span>&nbsp;name=</span><span class="string">"filter"</span><span>&nbsp;value=</span><span class="string">"&lt;?php&nbsp;echo&nbsp;$_POST["</span><span>filter</span><span class="string">"];&nbsp;?&gt;"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=<span class="string">"submit"</span><span>&nbsp;name=</span><span class="string">"confirm"</span><span>&nbsp;value=</span><span class="string">"Confirm"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href=<span class="string">"index.php"</span><span>&gt;Cancel&lt;/a&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;label&gt;Tweet&nbsp;about&nbsp;your&nbsp;<span class="keyword">new</span><span>&nbsp;avatar?&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=<span class="string">"checkbox"</span><span>&nbsp;name=</span><span class="string">"tweet"</span><span>&nbsp;value=</span><span class="string">"true"</span><span>&gt;&lt;/label&gt;&lt;/p&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="php" style="display: none;">  &lt;?php elseif(isset($newimage)): ?&gt;
      &lt;h2&gt;Are you sure?&lt;/h2&gt;
      &lt;img src="&lt;?php echo $original; ?&gt;" alt="Original" width="73" height="73"&gt;
      &lt;span class="arrow"&gt;&amp;rArr;&lt;/span&gt;
      &lt;img src="&lt;?php echo $newimage; ?&gt;" alt="&lt;?php echo ucfirst($_POST["filter"]); ?&gt;"&gt;
      &lt;form action="index.php" method="post"&gt;
          &lt;input type="hidden" name="filter" value="&lt;?php echo $_POST["filter"]; ?&gt;"&gt;
          &lt;input type="submit" name="confirm" value="Confirm"&gt;
          &lt;a href="index.php"&gt;Cancel&lt;/a&gt;
          &lt;p&gt;&lt;label&gt;Tweet about your new avatar?
                  &lt;input type="checkbox" name="tweet" value="true"&gt;&lt;/label&gt;&lt;/p&gt;
      &lt;/form&gt;</pre><p>Note that the confirmation form includes the selected filter in a hidden field.</p><p>If there is an error, we show this:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;</span><span class="keyword">elseif</span><span>(isset(</span><span class="vars">$error</span><span>)):&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Error.&nbsp;&lt;a&nbsp;href=<span class="string">"index.php"</span><span>&gt;Try&nbsp;again?&lt;/a&gt;&lt;/p&gt;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">  &lt;?php elseif(isset($error)): ?&gt;
      &lt;p&gt;Error. &lt;a href="index.php"&gt;Try again?&lt;/a&gt;&lt;/p&gt;</pre><p>The default display is the “Connect to Twitter” button as an image input (download one of the images from the bottom of <a href="http://dev.twitter.com/pages/sign_in_with_twitter" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;dev.twitter.com&#39;]);" target="_blank">this page</a> to the img directory):</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-c"><li class="alt"><span><span>&lt;?php&nbsp;</span><span class="keyword">else</span><span>:&nbsp;?&gt;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;action=<span class="string">"index.php"</span><span>&nbsp;method=</span><span class="string">"post"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=<span class="string">"image"</span><span>&nbsp;src=</span><span class="string">"img/sign-in-with-twitter-l.png"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alt=<span class="string">"Connect&nbsp;to&nbsp;Twitter"</span><span>&nbsp;name=</span><span class="string">"auth"</span><span>&nbsp;value=</span><span class="string">"1"</span><span>&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Connect&nbsp;to&nbsp;Twitter&nbsp;to&nbsp;<span class="keyword">use</span><span>&nbsp;this&nbsp;app.&lt;/p&gt;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&lt;?php&nbsp;<span class="keyword">endif</span><span>;&nbsp;?&gt;&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="php" style="display: none;">  &lt;?php else: ?&gt;
      &lt;form action="index.php" method="post"&gt;
          &lt;input type="image" src="img/sign-in-with-twitter-l.png"
                 alt="Connect to Twitter" name="auth" value="1"&gt;
      &lt;/form&gt;
      &lt;p&gt;Connect to Twitter to use this app.&lt;/p&gt;
  &lt;?php endif; ?&gt;</pre><p>Here’s the complete HTML section:</p><div class="dp-highlighter collapsed"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ExpandSource&#39;,this);return false;">+ expand source</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-xml"><li class="alt"><span><span>&lt;!DOCTYPE&nbsp;html</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="tag">&lt;</span><span class="tag-name">html</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">head</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">meta</span><span>&nbsp;</span><span class="attribute">charset</span><span>=</span><span class="attribute-value">"UTF-8"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">title</span><span class="tag">&gt;</span><span>Twitter&nbsp;Avatar&nbsp;Effects</span><span class="tag">&lt;/</span><span class="tag-name">title</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">link</span><span>&nbsp;</span><span class="attribute">rel</span><span>=</span><span class="attribute-value">"stylesheet"</span><span>&nbsp;</span><span class="attribute">href</span><span>=</span><span class="attribute-value">"css/style.css"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">head</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">body</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">h1</span><span class="tag">&gt;</span><span>Twitter&nbsp;Avatar&nbsp;Effects</span><span class="tag">&lt;/</span><span class="tag-name">h1</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;if(isset($previews)):&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">h2</span><span class="tag">&gt;</span><span>Choose&nbsp;your&nbsp;weapon...</span><span class="tag">&lt;/</span><span class="tag-name">h2</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">form</span><span>&nbsp;</span><span class="attribute">action</span><span>=</span><span class="attribute-value">"index.php"</span><span>&nbsp;</span><span class="attribute">method</span><span>=</span><span class="attribute-value">"post"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;foreach($previews&nbsp;as&nbsp;$</span><span class="attribute">filter</span><span>&nbsp;=</span><span class="tag">&gt;</span><span>&nbsp;$path):&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">input</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">"image"</span><span>&nbsp;</span><span class="attribute">src</span><span>=</span><span class="attribute-value">"&lt;?php&nbsp;echo&nbsp;$path;&nbsp;?&gt;"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="attribute">alt</span><span>=</span><span class="attribute-value">"&lt;?php&nbsp;echo&nbsp;ucfirst($filter);&nbsp;?&gt;"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="attribute">width</span><span>=</span><span class="attribute-value">"73"</span><span>&nbsp;</span><span class="attribute">height</span><span>=</span><span class="attribute-value">"73"</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="attribute">name</span><span>=</span><span class="attribute-value">"filter"</span><span>&nbsp;</span><span class="attribute">value</span><span>=</span><span class="attribute-value">"&lt;?php&nbsp;echo&nbsp;$filter;&nbsp;?&gt;"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;endforeach;&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">form</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>Select&nbsp;one&nbsp;of&nbsp;the&nbsp;images&nbsp;above&nbsp;to&nbsp;change&nbsp;your&nbsp;Twitter&nbsp;avatar.</span><span class="tag">&lt;/</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;elseif(isset($success)):&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">h2</span><span class="tag">&gt;</span><span>Success!&nbsp;Your&nbsp;Twitter&nbsp;avatar&nbsp;is&nbsp;now:</span><span class="tag">&lt;/</span><span class="tag-name">h2</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">img</span><span>&nbsp;</span><span class="attribute">src</span><span>=</span><span class="attribute-value">"&lt;?php&nbsp;echo&nbsp;$newimage;&nbsp;?&gt;"</span><span>&nbsp;</span><span class="attribute">alt</span><span>=</span><span class="attribute-value">"Your&nbsp;Avatar"</span><span>&nbsp;</span><span class="attribute">width</span><span>=</span><span class="attribute-value">"73"</span><span>&nbsp;</span><span class="attribute">height</span><span>=</span><span class="attribute-value">"73"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">p</span><span class="tag">&gt;</span><span class="tag">&lt;</span><span class="tag-name">a</span><span>&nbsp;</span><span class="attribute">href</span><span>=</span><span class="attribute-value">"http://twitter.com/&lt;?php&nbsp;echo&nbsp;$ta-&gt;userdata-&gt;screen_name;&nbsp;?&gt;"</span><span class="tag">&gt;</span><span>Go&nbsp;see&nbsp;it</span><span class="tag">&lt;/</span><span class="tag-name">a</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;elseif(isset($newimage)):&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">h2</span><span class="tag">&gt;</span><span>Are&nbsp;you&nbsp;sure?</span><span class="tag">&lt;/</span><span class="tag-name">h2</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">img</span><span>&nbsp;</span><span class="attribute">src</span><span>=</span><span class="attribute-value">"&lt;?php&nbsp;echo&nbsp;$original;&nbsp;?&gt;"</span><span>&nbsp;</span><span class="attribute">alt</span><span>=</span><span class="attribute-value">"Original"</span><span>&nbsp;</span><span class="attribute">width</span><span>=</span><span class="attribute-value">"73"</span><span>&nbsp;</span><span class="attribute">height</span><span>=</span><span class="attribute-value">"73"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">span</span><span>&nbsp;</span><span class="attribute">class</span><span>=</span><span class="attribute-value">"arrow"</span><span class="tag">&gt;</span><span>&amp;rArr;</span><span class="tag">&lt;/</span><span class="tag-name">span</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">img</span><span>&nbsp;</span><span class="attribute">src</span><span>=</span><span class="attribute-value">"&lt;?php&nbsp;echo&nbsp;$newimage;&nbsp;?&gt;"</span><span>&nbsp;</span><span class="attribute">alt</span><span>="</span><span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;echo&nbsp;ucfirst($_POST["filter</span><span class="attribute-value">"]);&nbsp;?&gt;"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">form</span><span>&nbsp;</span><span class="attribute">action</span><span>=</span><span class="attribute-value">"index.php"</span><span>&nbsp;</span><span class="attribute">method</span><span>=</span><span class="attribute-value">"post"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">input</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">"hidden"</span><span>&nbsp;</span><span class="attribute">name</span><span>=</span><span class="attribute-value">"filter"</span><span>&nbsp;</span><span class="attribute">value</span><span>="</span><span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;echo&nbsp;$_POST["filter</span><span class="attribute-value">"];&nbsp;?&gt;"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">input</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">"submit"</span><span>&nbsp;</span><span class="attribute">name</span><span>=</span><span class="attribute-value">"confirm"</span><span>&nbsp;</span><span class="attribute">value</span><span>=</span><span class="attribute-value">"Confirm"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">a</span><span>&nbsp;</span><span class="attribute">href</span><span>=</span><span class="attribute-value">"index.php"</span><span class="tag">&gt;</span><span>Cancel</span><span class="tag">&lt;/</span><span class="tag-name">a</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">p</span><span class="tag">&gt;</span><span class="tag">&lt;</span><span class="tag-name">label</span><span class="tag">&gt;</span><span>Tweet&nbsp;about&nbsp;your&nbsp;new&nbsp;avatar?&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">input</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">"checkbox"</span><span>&nbsp;</span><span class="attribute">name</span><span>=</span><span class="attribute-value">"tweet"</span><span>&nbsp;</span><span class="attribute">value</span><span>=</span><span class="attribute-value">"true"</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">label</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">form</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;elseif(isset($error)):&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>Error.&nbsp;</span><span class="tag">&lt;</span><span class="tag-name">a</span><span>&nbsp;</span><span class="attribute">href</span><span>=</span><span class="attribute-value">"index.php"</span><span class="tag">&gt;</span><span>Try&nbsp;again?</span><span class="tag">&lt;/</span><span class="tag-name">a</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;else:&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">form</span><span>&nbsp;</span><span class="attribute">action</span><span>=</span><span class="attribute-value">"index.php"</span><span>&nbsp;</span><span class="attribute">method</span><span>=</span><span class="attribute-value">"post"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">input</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">"image"</span><span>&nbsp;</span><span class="attribute">src</span><span>=</span><span class="attribute-value">"img/sign-in-with-twitter-l.png"</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="attribute">alt</span><span>=</span><span class="attribute-value">"Connect&nbsp;to&nbsp;Twitter"</span><span>&nbsp;</span><span class="attribute">name</span><span>=</span><span class="attribute-value">"auth"</span><span>&nbsp;</span><span class="attribute">value</span><span>=</span><span class="attribute-value">"1"</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">form</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>Connect&nbsp;to&nbsp;Twitter&nbsp;to&nbsp;use&nbsp;this&nbsp;app.</span><span class="tag">&lt;/</span><span class="tag-name">p</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;<span class="tag">&lt;?</span><span class="tag-name">php</span><span>&nbsp;endif;&nbsp;</span><span class="tag">?&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;<span class="tag">&lt;/</span><span class="tag-name">body</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="tag">&lt;/</span><span class="tag-name">html</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;</span></span></li></ol></div><pre name="code" class="html:collapse" style="display: none;">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Twitter Avatar Effects&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/style.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;
      &lt;h1&gt;Twitter Avatar Effects&lt;/h1&gt;
  &lt;?php if(isset($previews)): ?&gt;
      &lt;h2&gt;Choose your weapon...&lt;/h2&gt;
      &lt;form action="index.php" method="post"&gt;
      &lt;?php foreach($previews as $filter =&gt; $path): ?&gt;
          &lt;input type="image" src="&lt;?php echo $path; ?&gt;"
                 alt="&lt;?php echo ucfirst($filter); ?&gt;"
                  width="73" height="73"
                 name="filter" value="&lt;?php echo $filter; ?&gt;"&gt;
      &lt;?php endforeach; ?&gt;
      &lt;/form&gt;
      &lt;p&gt;Select one of the images above to change your Twitter avatar.&lt;/p&gt;
  &lt;?php elseif(isset($success)): ?&gt;
      &lt;h2&gt;Success! Your Twitter avatar is now:&lt;/h2&gt;
      &lt;img src="&lt;?php echo $newimage; ?&gt;" alt="Your Avatar" width="73" height="73"&gt;
      &lt;p&gt;&lt;a href="http://twitter.com/&lt;?php echo $ta-&gt;userdata-&gt;screen_name; ?&gt;"&gt;Go see it&lt;/a&gt;&lt;/p&gt;
  &lt;?php elseif(isset($newimage)): ?&gt;
      &lt;h2&gt;Are you sure?&lt;/h2&gt;
      &lt;img src="&lt;?php echo $original; ?&gt;" alt="Original" width="73" height="73"&gt;
      &lt;span class="arrow"&gt;&amp;rArr;&lt;/span&gt;
      &lt;img src="&lt;?php echo $newimage; ?&gt;" alt="&lt;?php echo ucfirst($_POST["filter"]); ?&gt;"&gt;
      &lt;form action="index.php" method="post"&gt;
          &lt;input type="hidden" name="filter" value="&lt;?php echo $_POST["filter"]; ?&gt;"&gt;
          &lt;input type="submit" name="confirm" value="Confirm"&gt;
          &lt;a href="index.php"&gt;Cancel&lt;/a&gt;
          &lt;p&gt;&lt;label&gt;Tweet about your new avatar?
                  &lt;input type="checkbox" name="tweet" value="true"&gt;&lt;/label&gt;&lt;/p&gt;
      &lt;/form&gt;
  &lt;?php elseif(isset($error)): ?&gt;
      &lt;p&gt;Error. &lt;a href="index.php"&gt;Try again?&lt;/a&gt;&lt;/p&gt;
  &lt;?php else: ?&gt;
      &lt;form action="index.php" method="post"&gt;
          &lt;input type="image" src="img/sign-in-with-twitter-l.png"
                 alt="Connect to Twitter" name="auth" value="1"&gt;
      &lt;/form&gt;
      &lt;p&gt;Connect to Twitter to use this app.&lt;/p&gt;
  &lt;?php endif; ?&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre><hr><h2>The CSS</h2><p>Here is some basic CSS to make the interface look nice, saved in <strong>css/style.css</strong>:</p><div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy to clipboard</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-css"><li class="alt"><span><span>html&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">background-color</span><span>:&nbsp;</span><span class="colors">#eee</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">text-align</span><span>:&nbsp;</span><span class="string">center</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-family</span><span>:&nbsp;</span><span class="string">"Lucida&nbsp;Grande"</span><span>,</span><span class="string">Verdana</span><span>,&nbsp;</span><span class="string">sans-serif</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-size</span><span>:&nbsp;</span><span class="string">16px</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">color</span><span>:&nbsp;</span><span class="colors">#224</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li><li class=""><span>body&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">width</span><span>:&nbsp;</span><span class="string">700px</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">margin</span><span>:&nbsp;</span><span class="string">30px</span><span>&nbsp;</span><span class="string">auto</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">background-color</span><span>:&nbsp;</span><span class="colors">#acf</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">padding</span><span>:&nbsp;</span><span class="string">10px</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">border</span><span>-radius:&nbsp;</span><span class="string">10px</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;-moz-<span class="keyword">border</span><span>-radius:&nbsp;</span><span class="string">10px</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;-webkit-<span class="keyword">border</span><span>-radius:&nbsp;</span><span class="string">10px</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li><li class="alt"><span>p&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-size</span><span>:&nbsp;1em;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li><li class=""><span>h1&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-size</span><span>:&nbsp;2em;&nbsp;&nbsp;</span></span></li><li class=""><span>}&nbsp;&nbsp;</span></li><li class="alt"><span>h2&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-size</span><span>:&nbsp;1.6em;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li><li class=""><span>.arrow&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-size</span><span>:&nbsp;4em;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">font-weight</span><span>:&nbsp;</span><span class="string">bold</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><pre name="code" class="css" style="display: none;">html {
    background-color: #eee;
    text-align: center;
    font-family: "Lucida Grande",Verdana, sans-serif;
    font-size: 16px;
    color: #224;
}
body {
    width: 700px;
    margin: 30px auto;
    background-color: #acf;
    padding: 10px;
    border-radius: 10px;
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
}
p {
    font-size: 1em;
}
h1 {
    font-size: 2em;
}
h2 {
    font-size: 1.6em;
}
.arrow {
    font-size: 4em;
    font-weight: bold;
}</pre><hr><h2>Results</h2><p>Here is a video which details how our completed application should look:</p><div class="tutorial_image"><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,115,0" width="560" height="345"><param name="movie" value="http://screenr.com/Content/assets/screenr_1116090935.swf"><param name="flashvars" value="i=126277"><param name="allowFullScreen" value="true"><embed src="http://screenr.com/Content/assets/screenr_1116090935.swf" flashvars="i=126277" allowfullscreen="true" width="560" height="345" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="opaque"></object></div><hr><h2>Conclusion</h2><p>If you’ve followed this tutorial all the way through, you should have a pretty good understanding of OAuth and what it takes to create a simple Twitter web application. Using the Twitter API is easy once you understand the basic concepts – especially if you use a library like tmhOAuth to handle the minor details.</p><p>The simple example we created in this tutorial can easily be modified or extended to do anything. So if you have a great idea for a cool new Twitter app, feel free to use this as the foundation.</p><p>Thanks for reading. If you have any questions or comments about this tutorial, please post!</p><div style="clear:both;padding-bottom:20px;"><fb:like layout="standard" width="450" height="30" fb-xfbml-state="rendered" class="fb_edge_widget_with_comment fb_iframe_widget"><span style="height: 29px; width: 450px;"><iframe id="f50bb335c" name="f1eb91824" scrolling="no" style="border: none; overflow: hidden; height: 29px; width: 450px;" title="Like this content on Facebook." class="fb_ltr" src="./Creating a Twitter OAuth Application   Nettuts+_files/like(1).htm"></iframe></span></fb:like></div><p style="text-align: center;"></p><div id="bsap_1260864" class="bsap_1260864 bsap"><a href="http://stats.buysellads.com/click.go?z=1260864&b=2765792&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.9708762997761369&link=http://newrelic.com/?utm_source=BSAD&utm_medium=banner_ad&utm_content=devbest300x250&utm_campaign=RPM&utm_term=devbest&mpc=BA-BSAD-RPM-EN-100-buysellads-devbest" onmouseover="window.status = &#39;http://newrelic.com/?utm_source=BSAD&amp;utm_medium=banner_ad&amp;utm_content=devbest300x250&amp;utm_campaign=RPM&amp;utm_term=devbest&amp;mpc=BA-BSAD-RPM-EN-100-buysellads-devbest&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad1 odd" title="Developer&#39;s Best Friend" id="bsa_2765792" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/131547-1349288042.jpg" width="300" height="250" alt="Developer&#39;s Best Friend" replaced="true"></a></div><p></p></div><div id="marketplace-author"><div><img alt="" src="./Creating a Twitter OAuth Application   Nettuts+_files/157eefe08edf3bfc76f3b4916e2ca72b" class="avatar avatar-40 photo" height="40" width="40"> <span>Steve Guidetti is <a href="http://codecanyon.net/user/UltraMega?ref=NetPremium" rel="external nofollow" class="m-username" target="_blank">UltraMega</a> on </span><a href="http://codecanyon.net/?ref=NetPremium" class="author-icon site-codecanyon" rel="external nofollow" target="_blank">Codecanyon</a></div><ul><li><a href="http://codecanyon.net/item/noty/122210?ref=NetPremium" rel="external nofollow" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/thumb.jpg" alt="" title="Noty only $6.00" width="80" height="80"></a></li><li><img src="./Creating a Twitter OAuth Application   Nettuts+_files/no-item-thumb.png" alt="" width="80" height="80"></li><li><img src="./Creating a Twitter OAuth Application   Nettuts+_files/no-item-thumb.png" alt="" width="80" height="80"></li><li><img src="./Creating a Twitter OAuth Application   Nettuts+_files/no-item-thumb.png" alt="" width="80" height="80"></li><li><img src="./Creating a Twitter OAuth Application   Nettuts+_files/no-item-thumb.png" alt="" width="80" height="80"></li><li><img src="./Creating a Twitter OAuth Application   Nettuts+_files/no-item-thumb.png" alt="" width="80" height="80"></li><li class="last-item"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/no-item-thumb.png" alt="" width="80" height="80"></li></ul></div><div id="tag-list"><span>Tags:</span> <a href="http://net.tutsplus.com/tag/twitter/">Twitter</a></div><div class="post_footer" style="padding-bottom: 170px;"><div class="enjoyed_post"> <span class="thumb_icon">&nbsp;</span><h5>Enjoyed this Post?</h5><p>Subscribe to our <a href="http://feeds.feedburner.com/nettuts">RSS Feed</a>, <a href="http://twitter.com/nettuts">Follow us on Twitter</a> or simply recommend us to friends and colleagues!</p><div class="article_social_media"><div class="tweetmeme_btn"> <iframe allowtransparency="true" frameborder="0" scrolling="no" src="./Creating a Twitter OAuth Application   Nettuts+_files/tweet_button.1359159993(1).htm" class="twitter-share-button twitter-count-none" style="width: 59px; height: 20px;" title="Twitter Tweet Button" data-twttr-rendered="true"></iframe><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/widgets.js"></script> </div><div class="facebook_send_btn left"> <div style="height: 20px; width: 32px; display: inline-block; text-indent: 0px; margin: 0px; padding: 0px; background-color: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; background-position: initial initial; background-repeat: initial initial;" id="___plusone_1"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I1_1360275387948" name="I1_1360275387948" src="./Creating a Twitter OAuth Application   Nettuts+_files/fastbutton(1).htm" allowtransparency="true" data-gapiattached="true" title="+1"></iframe></div></div><div class="facebook_btn"> <fb:like layout="button_count" width="100" height="21" fb-xfbml-state="rendered" class="fb_edge_widget_with_comment fb_iframe_widget"><span style="height: 20px; width: 71px;"><iframe id="f23ef553e" name="f26691a5ec" scrolling="no" style="border: none; overflow: hidden; height: 20px; width: 71px;" title="Like this content on Facebook." class="fb_ltr" src="./Creating a Twitter OAuth Application   Nettuts+_files/like(2).htm"></iframe></span></fb:like></div></div></div><div class="the_author"> <img alt="" src="./Creating a Twitter OAuth Application   Nettuts+_files/157eefe08edf3bfc76f3b4916e2ca72b" class="avatar avatar-40 photo" height="40" width="40"><h5>By <a href="http://net.tutsplus.com/author/steveguidetti/" title="Posts by Steve Guidetti" rel="author">Steve Guidetti</a></h5><p class="the_author_p">Rollover to read this author's bio or click through to see a full list of posts by this author.</p><div class="autor_div"> Steve is a freelance Web developer specializing in PHP programming. He is mostly self-taught in PHP, JavaScript, and a handful of other languages. You can see what he's up to via his site at <a href="http://ultramegatech.com/">ultramegatech.com</a>. <span class="arrow">&nbsp;</span></div></div> <br class="clear"><div class="plus_membership"><div class="plus_membership_text"> <a href="" class="plus_icon">Plus Premium</a><div id="logged-in-plus-footer" style="display: none;"><div class="plus_content wide"><h3>Hello!</h3><p>You can grab source files and bonus tutorials from the <a href="http://tutsplus.com/">members area</a>.</p></div><div class="plus_form"></div></div><div id="logged-out-plus-footer" style=""><div class="plus_content"><h3>Premium Members</h3><p>Source Files, Bonus Tutorials &amp; More for all relevant Tuts+ sites in one subscription. <a href="http://tutsplus.com/amember/signup.php">Join Now</a></p></div><div class="plus_form"><form name="login" method="post" action="http://tutsplus.com/amember/login.php?amember_redirect_url=http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/" id="signIn"><fieldset> <input type="text" name="amember_login" id="username" class="input"> <input type="password" name="amember_pass" id="password" class="input"> <input type="submit" id="submit_plus" class="submit_plus" value="Sign In"></fieldset></form></div></div></div><div class="left_corner">&nbsp;</div><div class="right_corner">&nbsp;</div></div> <script type="text/javascript">if (plus_member_logged_in()) {
                  $('#logged-in-plus-footer').show()
                } else {
                  $('#logged-out-plus-footer').show()
                }</script> </div><div class="post extra_posts single"></div><div class="discus-note"><strong>Note:</strong> Want to add some source code? Type &lt;pre&gt;&lt;code&gt; before it and &lt;/code&gt;&lt;/pre&gt; after it. <a href="http://help.disqus.com/customer/portal/articles/665057" target="_blank">Find out more</a></div><div class="comments"><div id="disqus_thread"><iframe id="dsq1" data-disqus-uid="1" allowtransparency="true" frameborder="0" role="application" style="width: 100%; border: none; overflow: hidden; height: 4917px;" width="100%" src="./Creating a Twitter OAuth Application   Nettuts+_files/saved_resource.htm" scrolling="no" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="dsq3" data-disqus-uid="3" allowtransparency="true" frameborder="0" role="application" style="width: 100%; border: none; overflow: hidden; display: none;" width="100%" src="./Creating a Twitter OAuth Application   Nettuts+_files/client.htm"></iframe><iframe id="dsq-indicator-north" data-disqus-uid="-indicator-north" allowtransparency="true" frameborder="0" role="application" style="width: 752px; border: none; overflow: hidden; top: 0px; min-width: 752px; max-width: 752px; position: fixed; max-height: 29px; min-height: 29px; height: 29px; display: none;" scrolling="no"></iframe><iframe id="dsq-indicator-south" data-disqus-uid="-indicator-south" allowtransparency="true" frameborder="0" role="application" style="width: 752px; border: none; overflow: hidden; bottom: 0px; min-width: 752px; max-width: 752px; position: fixed; max-height: 29px; min-height: 29px; height: 29px; display: none;" scrolling="no"></iframe></div> <script type="text/javascript">/*<![CDATA[*//*  */
    var disqus_url = 'http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/';
    var disqus_identifier = '16614 http://net.tutsplus.com/?p=16614';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'nettuts';
    var disqus_title = "Creating a Twitter OAuth Application";
        var disqus_config = function () {
        var config = this; // Access to the config object
        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */
        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = '?cf_action=sync_comments&post_id=16614';
            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
    var facebookXdReceiverPath = 'http://net.tutsplus.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/*  *//*]]>*/</script> <script type="text/javascript">/*  */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/net.tutsplus.com\/tutorials\/php\/creating-a-twitter-oauth-application\/trackback\/"    };
/*  */</script> <script type="text/javascript">/*<![CDATA[*//*  */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
        dsq.src = 'http' + '://' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.73';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/*  *//*]]>*/</script> </div></div></div></div><div id="sidebar"><div id="social-stats"><ul><li class="ss-twitter"> <a href="http://twitter.com/nettuts" rel="nofollow external" target="_blank"> <span>Twitter</span> <large>62,870</large> <small>Twitter Followers</small> </a></li><li class="ss-facebook"> <a href="http://facebook.com/nettutsplus" rel="nofollow external" target="_blank"> <span>Facebook</span> <large>54,088</large> <small>Facebook Fans</small> </a></li><li class="ss-google-plus"> <a href="https://plus.google.com/100395074731712398322" rel="nofollow external" target="_blank"> <span>Google+</span> <large>13,566</large> <small>Google+ Followers</small> </a></li></ul></div><div id="site-updates" class="ui-tabs ui-widget ui-widget-content ui-corner-all"><ul class="navfor-sections ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"><li class="mail-chimp-nav ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#mail-chimp-section"><span>&nbsp;</span>Get Email Updates</a></li><li class="rss-nav ui-state-default ui-corner-top"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#rss-section"><span>&nbsp;</span>Subscribe via RSS</a></li></ul><div id="mail-chimp-section" class="section-fornav ui-tabs-panel ui-widget-content ui-corner-bottom"><div id="mail-chimp-response"></div><form id="mail-chimp-form" action="" method="get"> <input type="text" name="mail-chimp-email" class="mail-chimp-email" value="" placeholder="me@email.com"> <input type="submit" name="mail-chimp-subscribe" value="Subscribe" id="mail-chimp-subscribe"></form></div><div id="rss-section" class="section-fornav ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"><ul><li><a href="javascript:void(0);">Select a subscription type...</a><ul><li><a href="http://feeds.feedburner.com/nettuts">Full Post RSS</a></li><li><a href="http://feedproxy.google.com/nettuts-summary">Summary RSS</a></li></ul></li></ul></div></div><div id="ad-block" style="display: block;"><div id="bsap_1616" class="bsap_1616 bsap"><a href="http://stats.buysellads.com/click.go?z=1616&b=505771&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.2042543098796159&link=http://www.xhtmlchop.com/?utm_source=BSA&utm_medium=Banner&utm_term=Psd%2Bto%2BHtml&utm_campaign=Nettuts%2B" onmouseover="window.status = &#39;http://www.xhtmlchop.com/?utm_source=BSA&amp;utm_medium=Banner&amp;utm_term=Psd%2Bto%2BHtml&amp;utm_campaign=Nettuts%2B&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad1 odd" title="PSD to Html" id="bsa_505771" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/31840-1279649837.gif" width="200" height="125" alt="PSD to Html"></a><a href="http://stats.buysellads.com/click.go?z=1616&b=2972501&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.2861579267773777&link=http://www.codeguard.com?utm_source=net.tutsplus.com&utm_medium=display&utm_content=VC&utm_campaign=VC_nettuts" onmouseover="window.status = &#39;http://www.codeguard.com?utm_source=net.tutsplus.com&amp;utm_medium=display&amp;utm_content=VC&amp;utm_campaign=VC_nettuts&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad2 even" title="Version Control in the cloud from CodeGuard" id="bsa_2972501" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/144313-1354292145.png" width="200" height="125" alt="Version Control in the cloud from CodeGuard"></a><a href="http://stats.buysellads.com/click.go?z=1616&b=180337&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.3392073973082006&link=https://www.psd2html.com/order-now.html?r" onmouseover="window.status = &#39;https://www.psd2html.com/order-now.html?r&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad3 odd" title="PSD2HTML.com" id="bsa_180337" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/146508-1355157567.png" width="200" height="125" alt="PSD2HTML.com"></a><a href="http://stats.buysellads.com/click.go?z=1616&b=1273278&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.9755527726374567&link=http://pages.sencha.com/web-apps-come-of-age.html?ls=Advertisement&ss=Nettuts" onmouseover="window.status = &#39;http://pages.sencha.com/web-apps-come-of-age.html?ls=Advertisement&amp;ss=Nettuts&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad4 even" title="Free White Paper - Web Apps Come of Age" id="bsa_1273278" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/68365-1310429808.png" width="200" height="125" alt="Free White Paper - Web Apps Come of Age"></a><a href="http://stats.buysellads.com/click.go?z=1616&b=2875306&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.3174760153051466&link=http://www.freshbooks.com/?ref=7486" onmouseover="window.status = &#39;http://www.freshbooks.com/?ref=7486&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad5 odd" title="FreshBooks Cloud Accounting - Sign Up Today For Your Free Trial!" id="bsa_2875306" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/139149-1352336829.png" width="200" height="125" alt="FreshBooks Cloud Accounting - Sign Up Today For Your Free Trial!"></a><a href="http://stats.buysellads.com/click.go?z=1616&b=2320244&g=&s=&sw=1366&sh=768&br=chrome,24,win&r=0.4366364402230829&link=http://www.typekit.com/?utm_source=nettuts&utm_medium=display&utm_content=ntth120420&utm_campaign=thousands" onmouseover="window.status = &#39;http://www.typekit.com/?utm_source=nettuts&amp;utm_medium=display&amp;utm_content=ntth120420&amp;utm_campaign=thousands&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad6 even" title="Typekit: Thousands of the best web fonts." id="bsa_2320244" target="_blank"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/103123-1334962160.png" width="200" height="125" alt="Typekit: Thousands of the best web fonts."></a><a href="http://buysellads.com/buy/detail/197/zone/1616?utm_source=site_197&utm_medium=website&utm_campaign=adhere&utm_content=zone_1616" title="Advertise Here" class="adhere ad7 odd" target="_blank">Advertise Here</a></div> <a href="http://net.tutsplus.com/advertise/" class="end-ad-here">advertise here</a></div><div id="ad-tuts-premium" style="display: block;"> <a href="http://tutsplus.com/">Become a Tuts+ Premium member to support this site and get access to more than <span>750</span> extra tutorials.</a></div>  <script type="text/javascript">if ( ! plus_member_logged_in()) {
    $('#ad-block').show();
    $('#ad-deck-large').show();
    $('#temp-ads').show();
    $('#ad-tuts-premium').show();
  }</script> <div id="tutsjobs" class="jobs"><h3 class="jobs_header"> Full-time, Part-time and Contract Jobs</h3><div class="jobs_body"><ul class="jobs_list"><li id="tutsjobs_id_579" class="fsjobs_job">             <a href="https://jobs.tutsplus.com/jobs/38-booking-com-ux-designer"><span class="title">UX Designer</span> <mark>at</mark> Booking.com</a>            </li><li id="tutsjobs_id_592" class="fsjobs_job">             <a href="https://jobs.tutsplus.com/jobs/37-booking-com-web-designer"><span class="title">Web Designer</span> <mark>at</mark> Booking.com</a>            </li><li id="tutsjobs_id_7589" class="fsjobs_job">             <a href="https://jobs.tutsplus.com/jobs/39-fiplab-ltd-mac-os-x-developer"><span class="title">Mac OS X Developer</span> <mark>at</mark> FIPLAB Ltd</a>            </li><li id="tutsjobs_id_3617" class="fsjobs_job">             <a href="https://jobs.tutsplus.com/jobs/40-fiplab-ltd-icon-ui-designer"><span class="title">Icon &amp; UI Designer</span> <mark>at</mark> FIPLAB Ltd</a>            </li><li id="tutsjobs_id_2719" class="fsjobs_job">             <a href="https://jobs.tutsplus.com/jobs/36-marketing-clique-kick-ass-senior-php-developer"><span class="title">Kick Ass Senior PHP Developer</span> <mark>at</mark> Marketing Clique</a>            </li></ul> <a class="more_jobs" href="http://jobs.tutsplus.com/" title="Tuts+ Job Board"> More on Tuts+ Jobs... </a></div></div><div id="fsjobs" class="jobs"><h3 class="jobs_header"> Freelance Jobs</h3><div class="jobs_body"><ul class="jobs_list"><li id="fsjobs_id_6954" class="fsjobs_job">             <a href="http://jobs.freelanceswitch.com/jobs/21809"><span class="title">PhotoShop Mockup of Basic Website</span> <mark>in</mark> USA</a>            </li><li id="fsjobs_id_3575" class="fsjobs_job">             <a href="http://jobs.freelanceswitch.com/jobs/21808"><span class="title">Freelance Vector Artist To Turn Simple Sketch Into Vector</span> <mark>in</mark> Anywhere</a>            </li><li id="fsjobs_id_1353" class="fsjobs_job">             <a href="http://jobs.freelanceswitch.com/jobs/21807"><span class="title">Freelance Application Developer</span> <mark>in</mark> Chicago, IL - ONSITE</a>            </li><li id="fsjobs_id_8035" class="fsjobs_job">             <a href="http://jobs.freelanceswitch.com/jobs/21804"><span class="title">Seasonal Typesetter</span> <mark>in</mark> Plymouth, MI</a>            </li><li id="fsjobs_id_4789" class="fsjobs_job">             <a href="http://jobs.freelanceswitch.com/jobs/21802"><span class="title">Co-founding &amp; leading role for a new customer service product startup</span> <mark>in</mark> Anywhere</a>            </li></ul> <a class="more_jobs" href="http://jobs.freelanceswitch.com/" title="Freelance Job Board"> More Freelance Jobs... </a></div></div><div id="social-networking" class="ui-tabs ui-widget ui-widget-content ui-corner-all"><ul class="navfor-sections ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"><li class="facebook-nav ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#facebook-section"><span>&nbsp;</span>Facebook</a></li><li class="twitter-nav ui-state-default ui-corner-top"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#twitter-section"><span>&nbsp;</span>Twitter</a></li><li class="google-plus-nav ui-state-default ui-corner-top"><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#google-plus-section"><span>&nbsp;</span>Google+</a></li></ul><div id="facebook-section" class="section-fornav ui-tabs-panel ui-widget-content ui-corner-bottom"><fb:like-box href="http://facebook.com/nettutsplus" width="388" height="290" stream="false" fb-xfbml-state="rendered" class="fb_iframe_widget"><span style="height: 290px; width: 388px;"><iframe id="f87947a38" name="f24573ac5c" scrolling="no" style="border: none; overflow: hidden; height: 290px; width: 388px;" class="fb_ltr" src="./Creating a Twitter OAuth Application   Nettuts+_files/likebox.htm"></iframe></span></fb:like-box></div><div id="twitter-section" class="section-fornav ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"><div><h3>Follow <a href="http://twitter.com/nettuts"><span>Nettuts+</span></a> and <span><a href="http://twitter.com/tutsplus">Tuts+</a></span> on Twitter</h3><ul><li>RT <a href="http://www.twitter.com/jeffrey_way">@jeffrey_way</a>: I'm compiling a list of resources related to testing in Laravel 4. If you've written an article, can you shoot me a link?</li><li>Git Tips From the Pros! <a href="http://t.co/n6JD9anQ">http://t.co/n6JD9anQ</a></li><li><a href="http://www.twitter.com/fabian_2025">@fabian_2025</a> Thanks!</li><li>Laravel 4: A Start at a RESTful API - <a href="http://t.co/qnnh9qiD">http://t.co/qnnh9qiD</a> <a href="http://twitter.com/#search?q=%23newOnNettuts" rel="external" target="_blank">#newOnNettuts</a></li></ul></div></div><div id="google-plus-section" class="section-fornav ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"><div style="height: 131px; width: 388px; display: inline-block; text-indent: 0px; margin: 0px; padding: 0px; background-color: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; background-position: initial initial; background-repeat: initial initial;" id="___plus_0"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 388px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 131px;" tabindex="0" vspace="0" width="100%" id="I2_1360275387951" name="I2_1360275387951" src="./Creating a Twitter OAuth Application   Nettuts+_files/badge.htm" allowtransparency="true" data-gapiattached="true" title="Google+ Badge"></iframe></div></div></div></div></div></div><div id="footer_wrap"><div id="footer"><p class="footer_text"><strong>Nettuts+</strong> is part of the <a href="http://tutsplus.com/">Tuts+ Network</a>, teaching creative skills to millions worldwide.</p><ul><li><a href="http://net.tutsplus.com/advertise/">Advertise</a><span>·</span></li><li><a href="http://www.formstack.com/forms/envato-tuts__contact_form">Suggestions</a><span>·</span></li><li><a href="http://net.tutsplus.com/about/">About Us</a><span>·</span></li><li><a href="http://net.tutsplus.com/about/tuts-terms-user-agreement/">Terms and Conditions</a><span>·</span></li><li><a href="http://net.tutsplus.com/about/privacy-policy/">Privacy Policy</a><span>·</span></li><li><a href="http://net.tutsplus.com/about/write-a-tutorial/">Write for Us</a></li></ul> <a href="http://net.tutsplus.com/" class="footer_logo">Nettuts+</a><div class="lower_footer"><p class="footer_copy">Copyright © 2013 Envato</p> <a href="http://envato.com/" class="envato_logo">Envato</a></div></div></div>
 <script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/widget.js"></script> <script type="text/javascript">var seriesdropdown = document.getElementById("orgseries_dropdown");
			if (seriesdropdown) {
			 function onSeriesChange() {
					if ( seriesdropdown.options[seriesdropdown.selectedIndex].value != ( 0 || -1 ) ) {
						location.href = "http://net.tutsplus.com/series/"+seriesdropdown.options[seriesdropdown.selectedIndex].value;
					}
				}
				seriesdropdown.onchange = onSeriesChange;
			}</script> <script type="text/javascript">/*<![CDATA[*/// 
        var disqus_shortname = 'nettuts';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('rel'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) url = url[0];
                    else url = url[1]
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
                        s.src = 'http' + '://' + 'disqus.com/forums/' + disqus_shortname + '/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    ///*]]>*/</script> <script class="javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/shCore.js"></script> <script class="javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/shBrushAll.js"></script> <script class="javascript">dp.SyntaxHighlighter.ClipboardSwf = 'http://net.tutsplus.com/wp-content/plugins/google-syntax-highlighter/Scripts/clipboard.swf';
dp.SyntaxHighlighter.HighlightAll('code');</script><style>.dp-xml .cdata { color: #ff1493; }.dp-xml .tag, .dp-xml .tag-name { color: #069; font-weight: bold; }.dp-xml .attribute { color: red; }.dp-xml .attribute-value { color: blue; }</style><style>.dp-xml .cdata { color: #ff1493; }.dp-xml .tag, .dp-xml .tag-name { color: #069; font-weight: bold; }.dp-xml .attribute { color: red; }.dp-xml .attribute-value { color: blue; }</style><style>.dp-css .colors { color: darkred; }.dp-css .vars { color: #d00; }</style><script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/footer.js"></script>
<script type="text/javascript" src="./Creating a Twitter OAuth Application   Nettuts+_files/1342X589339.skimlinks.js"></script>  

<!-- Dynamic Page Served (once) in 1.380 seconds -->
<div id="envato-widget" class="widget-reset" style="display: none;"><div id="envato-widget-switcher-wrap" style="display: none;"><div id="envato-widget-switcher"><ul class="switcher-list-left"><li><a href="http://envato.com/" rel="nofollow"><span class="widget-icon icon-envato">&nbsp;</span>Envato</a></li><li><a href="http://themeforest.net/" rel="nofollow"><span class="widget-icon icon-themeforest">&nbsp;</span>ThemeForest</a></li><li><a href="http://graphicriver.net/" rel="nofollow"><span class="widget-icon icon-graphicriver">&nbsp;</span>GraphicRiver</a></li><li><a href="http://videohive.net/" rel="nofollow"><span class="widget-icon icon-videohive">&nbsp;</span>VideoHive</a></li><li><a href="http://audiojungle.net/" rel="nofollow"><span class="widget-icon icon-audiojungle">&nbsp;</span>AudioJungle</a></li><li><a href="http://codecanyon.net/" rel="nofollow"><span class="widget-icon icon-codecanyon">&nbsp;</span>CodeCanyon</a></li><li><a href="http://activeden.net/" rel="nofollow"><span class="widget-icon icon-activeden">&nbsp;</span>ActiveDen</a></li><li><a href="http://3docean.net/" rel="nofollow"><span class="widget-icon icon-3docean">&nbsp;</span>3DOcean</a></li><li><a href="http://marketplace.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-tutsmarketplace">&nbsp;</span>Tuts+ Marketplace</a></li><li><a href="http://photodune.net/" rel="nofollow"><span class="widget-icon icon-photodune">&nbsp;</span>PhotoDune</a></li><li><a href="http://mac.appstorm.net/" rel="nofollow"><span class="widget-icon icon-mac">&nbsp;</span>Mac.Appstorm</a></li><li><a href="http://web.appstorm.net/" rel="nofollow"><span class="widget-icon icon-web">&nbsp;</span>Web.Appstorm</a></li><li><a href="http://iphone.appstorm.net/" rel="nofollow"><span class="widget-icon icon-iphone">&nbsp;</span>iPhone.Appstorm</a></li><li><a href="http://android.appstorm.net/" rel="nofollow"><span class="widget-icon icon-android">&nbsp;</span>Android.Appstorm</a></li><li><a href="http://ipad.appstorm.net/" rel="nofollow"><span class="widget-icon icon-ipad">&nbsp;</span>iPad.Appstorm</a></li><li><a href="http://windows.appstorm.net/" rel="nofollow"><span class="widget-icon icon-windows">&nbsp;</span>Windows.Appstorm</a></li><li><a href="http://creattica.com/" rel="nofollow"><span class="widget-icon icon-creattica">&nbsp;</span>Creattica</a></li></ul><ul class="switcher-list-right"><li><a href="http://freelanceswitch.com/" rel="nofollow"><span class="widget-icon icon-freelanceswitch">&nbsp;</span>FreelanceSwitch</a></li><li><a href="http://jobs.freelanceswitch.com/" rel="nofollow"><span class="widget-icon icon-freelanceswitch-jobs">&nbsp;</span>Freelance Jobs</a></li><li><a href="http://rockablepress.com/" rel="nofollow"><span class="widget-icon icon-rockablepress">&nbsp;</span>Rockable Press</a></li><li><a href="http://tutsplus.com/" rel="nofollow"><span class="widget-icon icon-tutsplus">&nbsp;</span>Tuts+ Premium</a></li><li><a href="http://hub.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-tutsplus">&nbsp;</span>Tuts+ Hub</a></li><li><a href="http://psd.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-psdtuts">&nbsp;</span>Psdtuts+</a></li><li><a href="http://net.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-nettuts">&nbsp;</span>Nettuts+</a></li><li><a href="http://vector.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-vectortuts">&nbsp;</span>Vectortuts+</a></li><li><a href="http://audio.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-audiotuts">&nbsp;</span>Audiotuts+</a></li><li><a href="http://ae.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-aetuts">&nbsp;</span>Aetuts+</a></li><li><a href="http://cg.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-cgtuts">&nbsp;</span>Cgtuts+</a></li><li><a href="http://photo.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-phototuts">&nbsp;</span>Phototuts+</a></li><li><a href="http://mobile.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-mobiletuts">&nbsp;</span>Mobiletuts+</a></li><li><a href="http://webdesign.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-webdesigntuts">&nbsp;</span>Webdesigntuts+</a></li><li><a href="http://wp.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-wptuts">&nbsp;</span>Wptuts+</a></li><li><a href="http://mac.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-mactuts">&nbsp;</span>Mactuts+</a></li><li><a href="http://gamedev.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-gamedevtuts">&nbsp;</span>Gamedevtuts+</a></li><li><a href="http://craft.tutsplus.com/" rel="nofollow"><span class="widget-icon icon-crafttuts">&nbsp;</span>Crafttuts+</a></li></ul></div><span class="switcher-arrow"></span></div><div id="envato-support-wrap" style="display: none;"><div id="envato-support"><span class="envato-widget-title">Envato Support</span><ul class="support-list"><li><a href="http://support.envato.com/index.php" rel="nofollow"><span class="widget-icon icon-envato-support-center">&nbsp;</span>Envato Support Center</a></li><li><a href="http://twitter.com/envato_support" rel="nofollow"><span class="widget-icon icon-envato-support-twitter">&nbsp;</span>Envato Support Twitter</a></li></ul></div><span class="switcher-arrow"></span></div><div id="envato-community-wrap" style="display: none;"><div id="envato-community"><span class="envato-widget-title">Envato Community</span><ul class="community-list"><li><a href="http://notes.envato.com/" rel="nofollow"><span class="widget-icon icon-envato-notes">&nbsp;</span>Envato Notes</a></li><li><a href="http://extras.envato.com/" rel="nofollow"><span class="widget-icon icon-envato-extras">&nbsp;</span>Envato Extras</a></li><li><a href="http://notes.envato.com/newsletter/" rel="nofollow"><span class="widget-icon icon-envato-newsletter">&nbsp;</span>Envato Newsletter</a></li><li><a href="http://notes.envato.com/category/podcasts/" rel="nofollow"><span class="widget-icon icon-envato-podcast">&nbsp;</span>Envato Podcast</a></li><li><a href="http://wp.envato.com/" rel="nofollow"><span class="widget-icon icon-wp-envato">&nbsp;</span>WP.Envato</a></li><li><a href="http://elite.envato.com/" rel="nofollow"><span class="widget-icon icon-envato-elite">&nbsp;</span>Envato Elite</a></li><li><a href="http://zoo.envato.com/" rel="nofollow"><span class="widget-icon icon-envato-zoo">&nbsp;</span>Envato Zoo</a></li><li><a href="http://www.flickr.com/photos/we-are-envato" rel="nofollow"><span class="widget-icon icon-envato-flickr">&nbsp;</span>Envato Flickr</a></li><li><a href="http://twitter.com/envato" rel="nofollow"><span class="widget-icon icon-envato-twitter">&nbsp;</span>Envato Twitter</a></li><li><a href="http://www.facebook.com/envato" rel="nofollow"><span class="widget-icon icon-envato-facebook">&nbsp;</span>Envato Facebook</a></li><li><a href="http://www.slideshare.net/envato" rel="nofollow"><span class="widget-icon icon-envato-slideshare">&nbsp;</span>Envato Slideshare</a></li><li><a href="http://dribbble.com/envato" rel="nofollow"><span class="widget-icon icon-envato-dribbble">&nbsp;</span>Envato Dribbble</a></li><li><a href="https://github.com/envato" rel="nofollow"><span class="widget-icon icon-envato-github">&nbsp;</span>Envato Github</a></li></ul></div><span class="switcher-arrow"></span></div><a href="javascript:void(0);" class="widget-button envato" rel="nofollow">envato</a><a href="javascript:void(0);" class="widget-button support" rel="nofollow">support</a><a href="javascript:void(0);" class="widget-button community" rel="nofollow">community</a></div><div id="YontooInstallID" style="display: none;">b42ebe9c-061c-4f1e-adf4-c381dbc5b7fa</div><div id="Y2PluginIds" style="display: none;">Y2:b42ebe9c-061c-4f1e-adf4-c381dbc5b7fa</div><div id="YontooLocationStore2" style="display: none;">http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/</div><div id="BottomBarBrain2" class="yontoolayerwidget" style="left: 0px; top: 0px; text-align: left; vertical-align: top; width: 1px; height: 1px; position: absolute;"></div><div id="dropdowndeals" class="yontoolayerwidget" style="left: 1023px; top: 0px; text-align: left; vertical-align: top; width: 155px; height: 1px; line-height: 0px; z-index: 2147483647; position: fixed;"><div id="dddContainer" style="position:relative;width:155px; height: 100%">               <object type="application/x-shockwave-flash" style="outline: none; visibility: visible;" data="http://s.nsdsvc.com/App/DddWrapper.swf?c=4" width="100%" height="100%" id="dddContent"><param name="menu" value="false"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"><param name="flashvars" value="domain=net.tutsplus.com&amp;protocol=http:&amp;clientId=b42ebe9c-061c-4f1e-adf4-c381dbc5b7fa"></object>            </div></div><div id="TopRelatedTopics" class="yontoolayerwidget" style="left: 0px; top: 0px; text-align: left; vertical-align: top; width: 0px; height: 0px; position: absolute;"></div><div id="EasyInlineApp" class="yontoolayerwidget" style="left: 0px; top: 0px; text-align: left; vertical-align: top; width: 0px; height: 0px; position: absolute;"></div><div style="position: absolute; z-index: 2147483647; width: 133px; height: 41.65px; left: -1000px; top: -1000px;"><object type="application/x-shockwave-flash" style="outline: none; visibility: visible;" data="http://edge.easyinline.com/app/easyInline.swf" width="100%" height="100%" id="easyInlineSwf"><param name="menu" value="false"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"><param name="flashvars" value="supportUrl=http://www.easyinline.com/support&amp;baseUrl=http://edge.easyinline.com&amp;productName=EasyInline"></object></div><div style="text-align: left; position: fixed; right: 0px; left: auto; top: 0px; bottom: auto; width: 160px; height: 100%; margin: 0px auto; border: 0px; padding: 0px; background-color: rgb(238, 238, 238); z-index: 2147483646;"><div id="otcbanner" style="position: absolute; top: 0px; bottom: 0px; margin: auto; border: 0px; padding: 0px; width: 160px; height: 600px;"><iframe src="./Creating a Twitter OAuth Application   Nettuts+_files/ancbanner_general_160x600_265.htm" width="160" height="600" frameborder="0" scrolling="no" allowtransparency="allowTransparency" style="position: static; display: block; margin: 0px; border: 0px; padding: 0px; width: 160px; height: 600px;"></iframe></div><img src="./Creating a Twitter OAuth Application   Nettuts+_files/close_btn.jpg" alt="Close" style="display: block; width: 16px; height: 16px; position: absolute; left: auto; bottom: auto; right: 0px; top: 0px; margin: 0px; border: 0px; padding: 0px; cursor: pointer;"><img src="./Creating a Twitter OAuth Application   Nettuts+_files/settings_btn.jpg" alt="Close" style="display: block; width: 16px; height: 16px; position: absolute; left: auto; bottom: auto; right: 18px; top: 0px; margin: 0px; border: 0px; padding: 0px; cursor: pointer;"></div><div id="TT_Frame"><div id="TT_Bg"></div><div id="TT_Close_Btn"></div><div id="TT_Search_Bg"><input id="TT_Search_Txt" type="input" placeholder="Search"><div id="TT_Search_Btn"></div></div><div id="TT_Branding"></div><div id="TT_Related" style="width: 1009px;"><ul><li>Related:</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">Java Framework</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">Ruby On Rails Web</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">Html 5</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">PHP Tutorials</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">MySQL Tutorial</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">PHP 5</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">HTML And CSS Tutorials</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">J2EE Development</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">Learn PHP</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">User Acceptance Testing</a></li><li>|</li><li><a href="http://net.tutsplus.com/tutorials/php/creating-a-twitter-oauth-application/#">Learn CSS</a></li><li>|</li></ul></div></div></body></html>